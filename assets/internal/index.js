System.register("bundle://internal/_virtual/builtin-pipeline-settings.ts",["./rollupPluginModLoBabelHelpers.js","cc","./builtin-pipeline-types.ts"],(function(t){var e,o,i,n,r,s,a,p,l,g,c,y,u,d,b,m,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.createClass,n=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){s=t.cclegacy,a=t._decorator,p=t.Camera,l=t.CCBoolean,g=t.CCInteger,c=t.CCFloat,y=t.Material,u=t.Texture2D,d=t.rendering,b=t.Component},function(t){m=t.fillRequiredPipelineSettings,h=t.makePipelineSettings}],execute:function(){var f,_,P,M,S,O,w,E,G,D,k,C,A,j,v,x,F,B,R,I,T,L,X,z,H,q,Y,N;s._RF.push({},"de1c2EHcMhAIYRZY5nyTQHG","builtin-pipeline-settings",void 0);var Q=a.ccclass,Z=a.disallowMultiple,J=a.executeInEditMode,K=a.menu,U=a.property,V=a.requireComponent;a.type,t("BuiltinPipelineSettings",(f=Q("BuiltinPipelineSettings"),_=K("Rendering/BuiltinPipelineSettings"),P=V(p),M=U(l),S=U({displayName:"Editor Preview (Experimental)",type:l}),O=U({group:{id:"MSAA",name:"Multisample Anti-Aliasing"},type:l}),w=U({group:{id:"MSAA",name:"Multisample Anti-Aliasing",style:"section"},type:g,range:[2,4,2]}),E=U({group:{id:"ShadingScale",name:"ShadingScale",style:"section"},type:l}),G=U({tooltip:"i18n:postprocess.shadingScale",group:{id:"ShadingScale",name:"ShadingScale"},type:c,range:[.01,4,.01],slide:!0}),D=U({group:{id:"Bloom",name:"Bloom (PostProcessing)",style:"section"},type:l}),k=U({group:{id:"Bloom",name:"Bloom (PostProcessing)",style:"section"},type:y}),C=U({tooltip:"i18n:bloom.enableAlphaMask",group:{id:"Bloom",name:"Bloom (PostProcessing)",style:"section"},type:l}),A=U({tooltip:"i18n:bloom.iterations",group:{id:"Bloom",name:"Bloom (PostProcessing)",style:"section"},type:g,range:[1,6,1],slide:!0}),j=U({tooltip:"i18n:bloom.threshold",group:{id:"Bloom",name:"Bloom (PostProcessing)",style:"section"},type:c,min:0}),v=U({group:{id:"Color Grading",name:"ColorGrading (LDR) (PostProcessing)",style:"section"},type:l}),x=U({group:{id:"Color Grading",name:"ColorGrading (LDR) (PostProcessing)",style:"section"},type:y}),F=U({tooltip:"i18n:color_grading.contribute",group:{id:"Color Grading",name:"ColorGrading (LDR) (PostProcessing)",style:"section"},type:c,range:[0,1,.01],slide:!0}),B=U({tooltip:"i18n:color_grading.originalMap",group:{id:"Color Grading",name:"ColorGrading (LDR) (PostProcessing)",style:"section"},type:u}),R=U({group:{id:"FXAA",name:"Fast Approximate Anti-Aliasing (PostProcessing)",style:"section"},type:l}),I=U({group:{id:"FXAA",name:"Fast Approximate Anti-Aliasing (PostProcessing)",style:"section"},type:y}),T=U({group:{id:"FSR",name:"FidelityFX Super Resolution",style:"section"},type:l}),L=U({group:{id:"FSR",name:"FidelityFX Super Resolution",style:"section"},type:y}),X=U({group:{id:"FSR",name:"FidelityFX Super Resolution",style:"section"},type:c,range:[0,1,.01],slide:!0}),z=U({group:{id:"ToneMapping",name:"ToneMapping",style:"section"},type:y}),f(H=_(H=P(H=Z(H=J((Y=e((q=function(t){function e(){for(var e,o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return e=t.call.apply(t,[this].concat(i))||this,n(e,"_settings",Y,r(e)),n(e,"_editorPreview",N,r(e)),e}o(e,t);var s=e.prototype;return s.getPipelineSettings=function(){return this._settings},s.onEnable=function(){m(this._settings),this.getComponent(p).camera.pipelineSettings=this._settings},s.onDisable=function(){this.getComponent(p).camera.pipelineSettings=null},s._tryEnableEditorPreview=function(){void 0!==d&&(this._editorPreview?d.setEditorPipelineSettings(this._settings):this._disableEditorPreview())},s._disableEditorPreview=function(){void 0!==d&&(d.getEditorPipelineSettings()===this._settings&&d.setEditorPipelineSettings(null))},i(e,[{key:"editorPreview",get:function(){return this._editorPreview},set:function(t){this._editorPreview=t}},{key:"MsaaEnable",get:function(){return this._settings.msaa.enabled},set:function(t){this._settings.msaa.enabled=t}},{key:"msaaSampleCount",get:function(){return this._settings.msaa.sampleCount},set:function(t){t=Math.pow(2,Math.ceil(Math.log2(Math.max(t,2)))),t=Math.min(t,4),this._settings.msaa.sampleCount=t}},{key:"shadingScaleEnable",get:function(){return this._settings.enableShadingScale},set:function(t){this._settings.enableShadingScale=t}},{key:"shadingScale",get:function(){return this._settings.shadingScale},set:function(t){this._settings.shadingScale=t}},{key:"bloomEnable",get:function(){return this._settings.bloom.enabled},set:function(t){this._settings.bloom.enabled=t}},{key:"bloomMaterial",get:function(){return this._settings.bloom.material},set:function(t){this._settings.bloom.material!==t&&(this._settings.bloom.material=t)}},{key:"bloomEnableAlphaMask",get:function(){return this._settings.bloom.enableAlphaMask},set:function(t){this._settings.bloom.enableAlphaMask=t}},{key:"bloomIterations",get:function(){return this._settings.bloom.iterations},set:function(t){this._settings.bloom.iterations=t}},{key:"bloomThreshold",get:function(){return this._settings.bloom.threshold},set:function(t){this._settings.bloom.threshold=t}},{key:"bloomIntensity",get:function(){return this._settings.bloom.intensity},set:function(t){this._settings.bloom.intensity=t}},{key:"colorGradingEnable",get:function(){return this._settings.colorGrading.enabled},set:function(t){this._settings.colorGrading.enabled=t}},{key:"colorGradingMaterial",get:function(){return this._settings.colorGrading.material},set:function(t){this._settings.colorGrading.material!==t&&(this._settings.colorGrading.material=t)}},{key:"colorGradingContribute",get:function(){return this._settings.colorGrading.contribute},set:function(t){this._settings.colorGrading.contribute=t}},{key:"colorGradingMap",get:function(){return this._settings.colorGrading.colorGradingMap},set:function(t){this._settings.colorGrading.colorGradingMap=t}},{key:"fxaaEnable",get:function(){return this._settings.fxaa.enabled},set:function(t){this._settings.fxaa.enabled=t}},{key:"fxaaMaterial",get:function(){return this._settings.fxaa.material},set:function(t){this._settings.fxaa.material!==t&&(this._settings.fxaa.material=t)}},{key:"fsrEnable",get:function(){return this._settings.fsr.enabled},set:function(t){this._settings.fsr.enabled=t}},{key:"fsrMaterial",get:function(){return this._settings.fsr.material},set:function(t){this._settings.fsr.material!==t&&(this._settings.fsr.material=t)}},{key:"fsrSharpness",get:function(){return this._settings.fsr.sharpness},set:function(t){this._settings.fsr.sharpness=t}},{key:"toneMappingMaterial",get:function(){return this._settings.toneMapping.material},set:function(t){this._settings.toneMapping.material!==t&&(this._settings.toneMapping.material=t)}}]),e}(b)).prototype,"_settings",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return h()}}),N=e(q.prototype,"_editorPreview",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(q.prototype,"editorPreview",[S],Object.getOwnPropertyDescriptor(q.prototype,"editorPreview"),q.prototype),e(q.prototype,"MsaaEnable",[O],Object.getOwnPropertyDescriptor(q.prototype,"MsaaEnable"),q.prototype),e(q.prototype,"msaaSampleCount",[w],Object.getOwnPropertyDescriptor(q.prototype,"msaaSampleCount"),q.prototype),e(q.prototype,"shadingScaleEnable",[E],Object.getOwnPropertyDescriptor(q.prototype,"shadingScaleEnable"),q.prototype),e(q.prototype,"shadingScale",[G],Object.getOwnPropertyDescriptor(q.prototype,"shadingScale"),q.prototype),e(q.prototype,"bloomEnable",[D],Object.getOwnPropertyDescriptor(q.prototype,"bloomEnable"),q.prototype),e(q.prototype,"bloomMaterial",[k],Object.getOwnPropertyDescriptor(q.prototype,"bloomMaterial"),q.prototype),e(q.prototype,"bloomEnableAlphaMask",[C],Object.getOwnPropertyDescriptor(q.prototype,"bloomEnableAlphaMask"),q.prototype),e(q.prototype,"bloomIterations",[A],Object.getOwnPropertyDescriptor(q.prototype,"bloomIterations"),q.prototype),e(q.prototype,"bloomThreshold",[j],Object.getOwnPropertyDescriptor(q.prototype,"bloomThreshold"),q.prototype),e(q.prototype,"colorGradingEnable",[v],Object.getOwnPropertyDescriptor(q.prototype,"colorGradingEnable"),q.prototype),e(q.prototype,"colorGradingMaterial",[x],Object.getOwnPropertyDescriptor(q.prototype,"colorGradingMaterial"),q.prototype),e(q.prototype,"colorGradingContribute",[F],Object.getOwnPropertyDescriptor(q.prototype,"colorGradingContribute"),q.prototype),e(q.prototype,"colorGradingMap",[B],Object.getOwnPropertyDescriptor(q.prototype,"colorGradingMap"),q.prototype),e(q.prototype,"fxaaEnable",[R],Object.getOwnPropertyDescriptor(q.prototype,"fxaaEnable"),q.prototype),e(q.prototype,"fxaaMaterial",[I],Object.getOwnPropertyDescriptor(q.prototype,"fxaaMaterial"),q.prototype),e(q.prototype,"fsrEnable",[T],Object.getOwnPropertyDescriptor(q.prototype,"fsrEnable"),q.prototype),e(q.prototype,"fsrMaterial",[L],Object.getOwnPropertyDescriptor(q.prototype,"fsrMaterial"),q.prototype),e(q.prototype,"fsrSharpness",[X],Object.getOwnPropertyDescriptor(q.prototype,"fsrSharpness"),q.prototype),e(q.prototype,"toneMappingMaterial",[z],Object.getOwnPropertyDescriptor(q.prototype,"toneMappingMaterial"),q.prototype),H=q))||H)||H)||H)||H)||H));s._RF.pop()}}}));

System.register("bundle://internal/_virtual/builtin-pipeline-types.ts",["cc"],(function(e){var a,n;return{setters:[function(e){a=e.cclegacy,n=e.gfx}],execute:function(){e({fillRequiredBloom:o,fillRequiredColorGrading:u,fillRequiredFSR:b,fillRequiredFXAA:m,fillRequiredHBAO:function(e){void 0===e.enabled&&(e.enabled=!1);void 0===e.radiusScale&&(e.radiusScale=1);void 0===e.angleBiasDegree&&(e.angleBiasDegree=10);void 0===e.blurSharpness&&(e.blurSharpness=3);void 0===e.aoSaturation&&(e.aoSaturation=1);void 0===e.needBlur&&(e.needBlur=!1)},fillRequiredMSAA:r,fillRequiredPipelineSettings:function(e){e.msaa?r(e.msaa):e.msaa=i();void 0===e.enableShadingScale&&(e.enableShadingScale=!1);void 0===e.shadingScale&&(e.shadingScale=.5);e.bloom?o(e.bloom):e.bloom={enabled:!1,material:null,enableAlphaMask:!1,iterations:3,threshold:.8,intensity:2.3};e.toneMapping?f(e.toneMapping):e.toneMapping={material:null};e.colorGrading?u(e.colorGrading):e.colorGrading={enabled:!1,material:null,contribute:1,colorGradingMap:null};e.fsr?b(e.fsr):e.fsr={enabled:!1,material:null,sharpness:.8};e.fxaa?m(e.fxaa):e.fxaa={enabled:!1,material:null}},fillRequiredToneMapping:f,makeBloom:t,makeColorGrading:d,makeFSR:s,makeFXAA:c,makeHBAO:function(){return{enabled:!1,radiusScale:1,angleBiasDegree:10,blurSharpness:3,aoSaturation:1,needBlur:!1}},makeMSAA:i,makePipelineSettings:function(){return{msaa:i(),enableShadingScale:!1,shadingScale:.5,bloom:{enabled:!1,material:null,enableAlphaMask:!1,iterations:3,threshold:.8,intensity:2.3},toneMapping:{material:null},colorGrading:{enabled:!1,material:null,contribute:1,colorGradingMap:null},fsr:{enabled:!1,material:null,sharpness:.8},fxaa:{enabled:!1,material:null}}},makeToneMapping:p}),a._RF.push({},"cbf30kCUX9A3K+QpVC6wnzx","builtin-pipeline-types",void 0);var l=n.SampleCount;function i(){return{enabled:!1,sampleCount:l.X4}}function r(e){void 0===e.enabled&&(e.enabled=!1),void 0===e.sampleCount&&(e.sampleCount=l.X4)}function t(){return{enabled:!1,material:null,enableAlphaMask:!1,iterations:3,threshold:.8,intensity:2.3}}function o(e){void 0===e.enabled&&(e.enabled=!1),void 0===e.material&&(e.material=null),void 0===e.enableAlphaMask&&(e.enableAlphaMask=!1),void 0===e.iterations&&(e.iterations=3),void 0===e.threshold&&(e.threshold=.8),void 0===e.intensity&&(e.intensity=2.3)}function d(){return{enabled:!1,material:null,contribute:1,colorGradingMap:null}}function u(e){void 0===e.enabled&&(e.enabled=!1),void 0===e.material&&(e.material=null),void 0===e.contribute&&(e.contribute=1),void 0===e.colorGradingMap&&(e.colorGradingMap=null)}function s(){return{enabled:!1,material:null,sharpness:.8}}function b(e){void 0===e.enabled&&(e.enabled=!1),void 0===e.material&&(e.material=null),void 0===e.sharpness&&(e.sharpness=.8)}function c(){return{enabled:!1,material:null}}function m(e){void 0===e.enabled&&(e.enabled=!1),void 0===e.material&&(e.material=null)}function p(){return{material:null}}function f(e){void 0===e.material&&(e.material=null)}a._RF.pop()}}}));

System.register("bundle://internal/_virtual/builtin-pipeline.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env","./builtin-pipeline-types.ts"],(function(e){var a,t,i,n,r,s,o,d,l,h,c,u,p,g,m,S,f,_;return{setters:[function(e){a=e.createForOfIteratorHelperLoose},function(e){t=e.cclegacy,i=e.geometry,n=e.gfx,r=e.renderer,s=e.Vec2,o=e.Vec4,d=e.rendering,l=e.assert,h=e.clamp,c=e.Vec3,u=e.Material,p=e.Layers,g=e.PipelineEventType,m=e.sys,S=e.pipeline},function(e){f=e.DEBUG},function(e){_=e.makePipelineSettings}],execute:function(){e("getPingPongRenderTarget",G),t._RF.push({},"ff9b0GZzgRM/obMbHGfCNbk","builtin-pipeline",void 0);var w=i.AABB,b=i.Sphere,P=i.intersect,R=n.ClearFlagBit,T=n.Color,M=n.Format,E=n.FormatFeatureBit,v=n.LoadOp,C=n.StoreOp,A=n.TextureType,L=n.Viewport,x=r.scene,D=x.CameraUsage,F=x.CSMLevel,N=x.LightType;function O(e){return!!(e.clearFlag&(R.COLOR|R.STENCIL<<1))}function B(e,a,t,i,n,r){e.shadowFixedArea||e.csmLevel===F.LEVEL_1?(n.left=0,n.top=0,n.width=Math.trunc(a),n.height=Math.trunc(t)):(n.left=Math.trunc(i%2*.5*a),n.top=r>0?Math.trunc(.5*(1-Math.floor(i/2))*t):Math.trunc(.5*Math.floor(i/2)*t),n.width=Math.trunc(.5*a),n.height=Math.trunc(.5*t)),n.left=Math.max(0,n.left),n.top=Math.max(0,n.top),n.width=Math.max(1,n.width),n.height=Math.max(1,n.height)}var Q=e("PipelineConfigs",(function(){this.isWeb=!1,this.isWebGL1=!1,this.isWebGPU=!1,this.isMobile=!1,this.isHDR=!1,this.useFloatOutput=!1,this.toneMappingType=0,this.shadowEnabled=!1,this.shadowMapFormat=M.R32F,this.shadowMapSize=new s(1,1),this.usePlanarShadow=!1,this.screenSpaceSignY=1,this.supportDepthSample=!1,this.mobileMaxSpotLightShadowMaps=1,this.platform=new o(0,0,0,0)}));function y(e,a){var t=E.SAMPLED_TEXTURE|E.LINEAR_FILTER,i=e.device;a.isWeb=!m.isNative,a.isWebGL1=i.gfxAPI===n.API.WEBGL,a.isWebGPU=i.gfxAPI===n.API.WEBGPU,a.isMobile=m.isMobile,a.isHDR=e.pipelineSceneData.isHDR,a.useFloatOutput=e.getMacroBool("CC_USE_FLOAT_OUTPUT"),a.toneMappingType=e.pipelineSceneData.postSettings.toneMappingType;var s=e.pipelineSceneData.shadows;a.shadowEnabled=s.enabled,a.shadowMapFormat=S.supportsR32FloatTexture(e.device)?M.R32F:M.RGBA8,a.shadowMapSize.set(s.size),a.usePlanarShadow=s.enabled&&s.type===r.scene.ShadowType.Planar,a.screenSpaceSignY=e.device.capabilities.screenSpaceSignY,a.supportDepthSample=(e.device.getFormatFeatures(M.DEPTH_STENCIL)&t)===t;var o=i.capabilities.screenSpaceSignY;a.platform.x=a.isMobile?1:0,a.platform.w=.5*o+.5<<1|.5*i.capabilities.clipSpaceSignY+.5}var H=_(),z=e("CameraConfigs",(function(){this.settings=H,this.isMainGameWindow=!1,this.renderWindowId=0,this.colorName="",this.depthStencilName="",this.enableFullPipeline=!1,this.enableProfiler=!1,this.remainingPasses=0,this.enableShadingScale=!1,this.shadingScale=1,this.nativeWidth=1,this.nativeHeight=1,this.width=1,this.height=1,this.enableHDR=!1,this.radianceFormat=n.Format.RGBA8,this.copyAndTonemapMaterial=null,this.enableStoreSceneDepth=!1})),I=new T(0,0,0,0);function W(e,a,t,i){l(!!t.copyAndTonemapMaterial);var n=e.addRenderPass(t.nativeWidth,t.nativeHeight,"cc-tone-mapping");return n.addRenderTarget(t.colorName,v.CLEAR,C.STORE,I),n.addTexture(i,"inputTexture"),n.setVec4("g_platform",a.platform),n.addQueue(d.QueueHint.OPAQUE).addFullscreenQuad(t.copyAndTonemapMaterial,1),n}function G(e,a,t){return e.startsWith(a)?""+a+(1-Number(e.charAt(a.length)))+"_"+t:a+"0_"+t}var U=function(){function e(){this.lights=[],this.shadowEnabledSpotLights=[],this._sphere=b.create(0,0,0,1),this._boundingBox=new w,this._rangedDirLightBoundingBox=new w(0,0,0,.5,.5,.5)}var t=e.prototype;return t.cullLights=function(e,t,i){this.lights.length=0,this.shadowEnabledSpotLights.length=0;for(var n,r=a(e.spotLights);!(n=r()).done;){var s=n.value;s.baked||(b.set(this._sphere,s.position.x,s.position.y,s.position.z,s.range),P.sphereFrustum(this._sphere,t)&&(s.shadowEnabled?this.shadowEnabledSpotLights.push(s):this.lights.push(s)))}for(var o,d=a(e.sphereLights);!(o=d()).done;){var l=o.value;l.baked||(b.set(this._sphere,l.position.x,l.position.y,l.position.z,l.range),P.sphereFrustum(this._sphere,t)&&this.lights.push(l))}for(var h,u=a(e.pointLights);!(h=u()).done;){var p=h.value;p.baked||(b.set(this._sphere,p.position.x,p.position.y,p.position.z,p.range),P.sphereFrustum(this._sphere,t)&&this.lights.push(p))}for(var g,m=a(e.rangedDirLights);!(g=m()).done;){var S=g.value;w.transform(this._boundingBox,this._rangedDirLightBoundingBox,S.node.getWorldMatrix()),P.aabbFrustum(this._boundingBox,t)&&this.lights.push(S)}i&&this.shadowEnabledSpotLights.sort((function(e,a){return c.squaredDistance(i,e.position)-c.squaredDistance(i,a.position)}))},t._addLightQueues=function(e,t){for(var i,n=a(this.lights);!(i=n()).done;){var r=i.value,s=t.addQueue(d.QueueHint.BLEND,"forward-add");switch(r.type){case N.SPHERE:s.name="sphere-light";break;case N.SPOT:s.name="spot-light";break;case N.POINT:s.name="point-light";break;case N.RANGED_DIRECTIONAL:s.name="ranged-directional-light";break;default:s.name="unknown-light"}s.addScene(e,d.SceneFlags.BLEND,r)}},t.addSpotlightShadowPasses=function(e,t,i){for(var n,r=0,s=a(this.shadowEnabledSpotLights);!(n=s()).done;){var o=n.value,l=e.pipelineSceneData.shadows.size,h=e.addRenderPass(l.x,l.y,"default");if(h.name="SpotLightShadowPass"+r,h.addRenderTarget("SpotShadowMap"+r,v.CLEAR,C.STORE,new T(1,1,1,1)),h.addDepthStencil("SpotShadowDepth"+r,v.CLEAR,C.DISCARD),h.addQueue(d.QueueHint.NONE,"shadow-caster").addScene(t,d.SceneFlags.OPAQUE|d.SceneFlags.MASK|d.SceneFlags.SHADOW_CASTER).useLightFrustum(o),++r>=i)break}},t.addLightQueues=function(e,t,i){this._addLightQueues(t,e);for(var n,r=0,s=a(this.shadowEnabledSpotLights);!(n=s()).done;){var o=n.value;if(e.addTexture("SpotShadowMap"+r,"cc_spotShadowMap"),e.addQueue(d.QueueHint.BLEND,"forward-add").addScene(t,d.SceneFlags.BLEND,o),++r>=i)break}},t.addLightPasses=function(e,t,i,n,r,s,o,l,h,c){this._addLightQueues(o,c);for(var u,p=0,g=h.pipelineSceneData.shadows.size,m=a(this.shadowEnabledSpotLights);!(u=m()).done;){var S=u.value,f=h.addRenderPass(g.x,g.y,"default");f.name="SpotlightShadowPass",f.addRenderTarget("ShadowMap"+n,v.CLEAR,C.STORE,new T(1,1,1,1)),f.addDepthStencil("ShadowDepth"+n,v.CLEAR,C.DISCARD),f.addQueue(d.QueueHint.NONE,"shadow-caster").addScene(o,d.SceneFlags.OPAQUE|d.SceneFlags.MASK|d.SceneFlags.SHADOW_CASTER).useLightFrustum(S);var _=++p===this.shadowEnabledSpotLights.length?i:C.STORE;(c=h.addRenderPass(r,s,"default")).name="SpotlightWithShadowMap",c.setViewport(l),c.addRenderTarget(e,v.LOAD),c.addDepthStencil(t,v.LOAD,_),c.addTexture("ShadowMap"+n,"cc_spotShadowMap"),c.addQueue(d.QueueHint.BLEND,"forward-add").addScene(o,d.SceneFlags.BLEND,S)}return c},t.isMultipleLightPassesNeeded=function(){return this.shadowEnabledSpotLights.length>0},e}(),V=e("BuiltinForwardPassBuilder",function(){function e(){this.forwardLighting=new U,this._viewport=new L,this._clearColor=new T(0,0,0,1),this._reflectionProbeClearColor=new c(0,0,0)}var i=e.prototype;return i.getConfigOrder=function(){return e.ConfigOrder},i.getRenderOrder=function(){return e.RenderOrder},i.configCamera=function(e,a,t){t.enableMainLightShadowMap=a.shadowEnabled&&!a.usePlanarShadow&&!!e.scene&&!!e.scene.mainLight&&e.scene.mainLight.shadowEnabled,t.enableMainLightPlanarShadowMap=a.shadowEnabled&&a.usePlanarShadow&&!!e.scene&&!!e.scene.mainLight&&e.scene.mainLight.shadowEnabled,t.enablePlanarReflectionProbe=t.isMainGameWindow||e.cameraUsage===D.SCENE_VIEW||e.cameraUsage===D.GAME_VIEW,t.enableMSAA=t.settings.msaa.enabled&&!t.enableStoreSceneDepth&&!a.isWeb&&!a.isWebGL1,t.enableSingleForwardPass=a.isMobile||t.enableMSAA,++t.remainingPasses},i.windowResize=function(e,a,t,i,n,r,s){var o=d.ResourceFlags,l=d.ResourceResidency,h=i.renderWindowId,c=t.settings,u=t.enableShadingScale?Math.max(Math.floor(r*t.shadingScale),1):r,p=t.enableShadingScale?Math.max(Math.floor(s*t.shadingScale),1):s;if(t.enableMSAA&&(t.enableHDR?e.addTexture("MsaaRadiance"+h,A.TEX2D,t.radianceFormat,u,p,1,1,1,c.msaa.sampleCount,o.COLOR_ATTACHMENT,l.MEMORYLESS):e.addTexture("MsaaRadiance"+h,A.TEX2D,M.RGBA8,u,p,1,1,1,c.msaa.sampleCount,o.COLOR_ATTACHMENT,l.MEMORYLESS),e.addTexture("MsaaDepthStencil"+h,A.TEX2D,M.DEPTH_STENCIL,u,p,1,1,1,c.msaa.sampleCount,o.DEPTH_STENCIL_ATTACHMENT,l.MEMORYLESS)),e.addRenderTarget("ShadowMap"+h,a.shadowMapFormat,a.shadowMapSize.x,a.shadowMapSize.y),e.addDepthStencil("ShadowDepth"+h,M.DEPTH_STENCIL,a.shadowMapSize.x,a.shadowMapSize.y),t.enableSingleForwardPass)for(var g=a.mobileMaxSpotLightShadowMaps,m=0;m!==g;++m)e.addRenderTarget("SpotShadowMap"+m,a.shadowMapFormat,a.shadowMapSize.x,a.shadowMapSize.y),e.addDepthStencil("SpotShadowDepth"+m,M.DEPTH_STENCIL,a.shadowMapSize.x,a.shadowMapSize.y)},i.setup=function(e,a,t,i,n){var r=i.window.renderWindowId,s=i.scene,o=s.mainLight;--t.remainingPasses,l(t.remainingPasses>=0),this.forwardLighting.cullLights(s,i.frustum),t.enableMainLightShadowMap&&(l(!!o),this._addCascadedShadowMapPass(e,a,r,o,i)),t.enableSingleForwardPass&&this.forwardLighting.addSpotlightShadowPasses(e,i,a.mobileMaxSpotLightShadowMaps),this._tryAddReflectionProbePasses(e,t,r,o,i.scene),t.remainingPasses>0||t.enableShadingScale?(n.colorName=t.enableShadingScale?"ScaledRadiance0_"+r:"Radiance0_"+r,n.depthStencilName=t.enableShadingScale?"ScaledSceneDepth_"+r:"SceneDepth_"+r):(n.colorName=t.colorName,n.depthStencilName=t.depthStencilName);var d=this._addForwardRadiancePasses(e,a,t,r,i,t.width,t.height,o,n.colorName,n.depthStencilName,!t.enableMSAA,t.enableStoreSceneDepth?C.STORE:C.DISCARD);return t.enableStoreSceneDepth||(n.depthStencilName=""),0===t.remainingPasses&&t.enableShadingScale?W(e,a,t,n.colorName):d},i._addCascadedShadowMapPass=function(e,a,t,i,n){var r=d.QueueHint,s=d.SceneFlags,o=e.pipelineSceneData.shadows.size,l=o.x,h=o.y,c=this._viewport;c.left=c.top=0,c.width=l,c.height=h;var u=e.addRenderPass(l,h,"default");u.name="CascadedShadowMap",u.addRenderTarget("ShadowMap"+t,v.CLEAR,C.STORE,new T(1,1,1,1)),u.addDepthStencil("ShadowDepth"+t,v.CLEAR,C.DISCARD);for(var p=e.pipelineSceneData.csmSupported?i.csmLevel:1,g=0;g!==p;++g){B(i,l,h,g,this._viewport,a.screenSpaceSignY);var m=u.addQueue(r.NONE,"shadow-caster");a.isWebGPU||m.setViewport(this._viewport),m.addScene(n,s.OPAQUE|s.MASK|s.SHADOW_CASTER).useLightFrustum(i,g)}},i._tryAddReflectionProbePasses=function(e,i,s,o,l){var h=t.internal.reflectionProbeManager;if(h)for(var c,u=d.ResourceResidency,p=h.getProbes(),g=0,m=a(p);!(c=m()).done;){var S=c.value;if(S.needRender){var f=S.renderArea(),_=Math.max(Math.floor(f.x),1),w=Math.max(Math.floor(f.y),1);if(S.probeType===r.scene.ProbeType.PLANAR){if(!i.enablePlanarReflectionProbe)continue;var b=S.realtimePlanarTexture.window,P="PlanarProbeRT"+g,R="PlanarProbeDS"+g;e.addRenderWindow(P,i.radianceFormat,_,w,b),e.addDepthStencil(R,n.Format.DEPTH_STENCIL,_,w,u.MEMORYLESS);var T=e.addRenderPass(_,w,"default");T.name="PlanarReflectionProbe"+g,this._buildReflectionProbePass(T,i,s,S.camera,P,R,o,l)}if(4===++g)break}}},i._buildReflectionProbePass=function(e,a,t,i,n,r,s,o){void 0===o&&(o=null);var l=d.QueueHint,h=d.SceneFlags,c=a.enableMSAA?C.DISCARD:C.STORE;if(O(i)){this._reflectionProbeClearColor.x=i.clearColor.x,this._reflectionProbeClearColor.y=i.clearColor.y,this._reflectionProbeClearColor.z=i.clearColor.z;var u=d.packRGBE(this._reflectionProbeClearColor);this._clearColor.x=u.x,this._clearColor.y=u.y,this._clearColor.z=u.z,this._clearColor.w=u.w,e.addRenderTarget(n,v.CLEAR,c,this._clearColor)}else e.addRenderTarget(n,v.LOAD,c);i.clearFlag&R.DEPTH_STENCIL?e.addDepthStencil(r,v.CLEAR,C.DISCARD,i.clearDepth,i.clearStencil,i.clearFlag&R.DEPTH_STENCIL):e.addDepthStencil(r,v.LOAD,C.DISCARD),a.enableMainLightShadowMap&&e.addTexture("ShadowMap"+t,"cc_shadowMap"),e.addQueue(l.NONE,"reflect-map").addScene(i,h.OPAQUE|h.MASK|h.REFLECTION_PROBE,s||void 0,o||void 0)},i._addForwardRadiancePasses=function(e,a,t,i,n,r,s,o,h,c,u,p){void 0===u&&(u=!1),void 0===p&&(p=C.DISCARD);var g=d.QueueHint,m=d.SceneFlags,S=n.clearColor;this._clearColor.x=S.x,this._clearColor.y=S.y,this._clearColor.z=S.z,this._clearColor.w=S.w;var f=n.viewport;this._viewport.left=Math.round(f.x*r),this._viewport.top=Math.round(f.y*s),this._viewport.width=Math.max(Math.round(f.width*r),1),this._viewport.height=Math.max(Math.round(f.height*s),1);var _=!u&&t.enableMSAA;l(!_||t.enableSingleForwardPass);var w=t.enableSingleForwardPass?this._addForwardSingleRadiancePass(e,a,t,i,n,_,r,s,o,h,c,p):this._addForwardMultipleRadiancePasses(e,t,i,n,r,s,o,h,c,p);t.enableMainLightPlanarShadowMap&&this._addPlanarShadowQueue(n,o,w);var b=m.BLEND|(n.geometryRenderer?m.GEOMETRY:m.NONE);return w.addQueue(g.BLEND).addScene(n,b,o||void 0),w},i._addForwardSingleRadiancePass=function(e,a,t,i,n,r,s,o,d,h,c,u){var p;if(l(t.enableSingleForwardPass),r){var g="MsaaRadiance"+i,m="MsaaDepthStencil"+i,S=t.settings.msaa.sampleCount,f=e.addMultisampleRenderPass(s,o,S,0,"default");f.name="MsaaForwardPass",this._buildForwardMainLightPass(f,t,i,n,g,m,C.DISCARD,d),f.resolveRenderTarget(g,h),p=f}else(p=e.addRenderPass(s,o,"default")).name="ForwardPass",this._buildForwardMainLightPass(p,t,i,n,h,c,u,d);return l(void 0!==p),this.forwardLighting.addLightQueues(p,n,a.mobileMaxSpotLightShadowMaps),p},i._addForwardMultipleRadiancePasses=function(e,a,t,i,n,r,s,o,d,h){l(!a.enableSingleForwardPass);var c=e.addRenderPass(n,r,"default");c.name="ForwardPass";var u=this.forwardLighting.isMultipleLightPassesNeeded()?C.STORE:h;return this._buildForwardMainLightPass(c,a,t,i,o,d,u,s),c=this.forwardLighting.addLightPasses(o,d,h,t,n,r,i,this._viewport,e,c)},i._buildForwardMainLightPass=function(e,a,t,i,n,r,s,o,l){void 0===l&&(l=null);var h=d.QueueHint,c=d.SceneFlags;e.setViewport(this._viewport);var u=a.enableMSAA?C.DISCARD:C.STORE;O(i)?e.addRenderTarget(n,v.CLEAR,u,this._clearColor):e.addRenderTarget(n,v.LOAD,u),i.clearFlag&R.DEPTH_STENCIL?e.addDepthStencil(r,v.CLEAR,s,i.clearDepth,i.clearStencil,i.clearFlag&R.DEPTH_STENCIL):e.addDepthStencil(r,v.LOAD,s),a.enableMainLightShadowMap&&e.addTexture("ShadowMap"+t,"cc_shadowMap"),e.addQueue(h.NONE).addScene(i,c.OPAQUE|c.MASK,o||void 0,l||void 0)},i._addPlanarShadowQueue=function(e,a,t){var i=d.QueueHint,n=d.SceneFlags;t.addQueue(i.BLEND,"planar-shadow").addScene(e,n.SHADOW_CASTER|n.PLANAR_SHADOW|n.BLEND,a||void 0)},e}());V.ConfigOrder=100,V.RenderOrder=100;var k=e("BuiltinBloomPassBuilder",function(){function e(){this._clearColorTransparentBlack=new T(0,0,0,0),this._bloomParams=new o(0,0,0,0),this._bloomTexSize=new o(0,0,0,0),this._bloomWidths=[],this._bloomHeights=[],this._bloomTexNames=[]}var a=e.prototype;return a.getConfigOrder=function(){return 0},a.getRenderOrder=function(){return 200},a.configCamera=function(e,a,t){t.enableBloom=t.settings.bloom.enabled&&!!t.settings.bloom.material,t.enableBloom&&++t.remainingPasses},a.windowResize=function(e,a,t,i){if(t.enableBloom)for(var n=i.renderWindowId,r=t.width,s=t.height,o=0;o!==t.settings.bloom.iterations+1;++o)r=Math.max(Math.floor(r/2),1),s=Math.max(Math.floor(s/2),1),e.addRenderTarget("BloomTex"+n+"_"+o,t.radianceFormat,r,s)},a.setup=function(e,a,t,i,n,r){if(!t.enableBloom)return r;--t.remainingPasses,l(t.remainingPasses>=0);var s=i.window.renderWindowId;return l(!!t.settings.bloom.material),this._addKawaseDualFilterBloomPasses(e,a,t,t.settings,t.settings.bloom.material,s,t.width,t.height,n.colorName)},a._addKawaseDualFilterBloomPasses=function(e,a,t,i,n,r,s,o,l){var h=d.QueueHint,c=i.bloom.iterations,u=c+1;this._bloomWidths.length=u,this._bloomHeights.length=u,this._bloomWidths[0]=Math.max(Math.floor(s/2),1),this._bloomHeights[0]=Math.max(Math.floor(o/2),1);for(var p=1;p!==u;++p)this._bloomWidths[p]=Math.max(Math.floor(this._bloomWidths[p-1]/2),1),this._bloomHeights[p]=Math.max(Math.floor(this._bloomHeights[p-1]/2),1);this._bloomTexNames.length=u;for(var g=0;g!==u;++g)this._bloomTexNames[g]="BloomTex"+r+"_"+g;this._bloomParams.x=a.useFloatOutput?1:0,this._bloomParams.x=0,this._bloomParams.z=i.bloom.threshold,this._bloomParams.w=i.bloom.enableAlphaMask?1:0;var m=e.addRenderPass(this._bloomWidths[0],this._bloomHeights[0],"cc-bloom-prefilter");m.addRenderTarget(this._bloomTexNames[0],v.CLEAR,C.STORE,this._clearColorTransparentBlack),m.addTexture(l,"inputTexture"),m.setVec4("g_platform",a.platform),m.setVec4("bloomParams",this._bloomParams),m.addQueue(h.OPAQUE).addFullscreenQuad(n,0);for(var S=1;S!==u;++S){var f=e.addRenderPass(this._bloomWidths[S],this._bloomHeights[S],"cc-bloom-downsample");f.addRenderTarget(this._bloomTexNames[S],v.CLEAR,C.STORE,this._clearColorTransparentBlack),f.addTexture(this._bloomTexNames[S-1],"bloomTexture"),this._bloomTexSize.x=this._bloomWidths[S-1],this._bloomTexSize.y=this._bloomHeights[S-1],f.setVec4("g_platform",a.platform),f.setVec4("bloomTexSize",this._bloomTexSize),f.addQueue(h.OPAQUE).addFullscreenQuad(n,1)}for(var _=c;_-- >0;){var w=e.addRenderPass(this._bloomWidths[_],this._bloomHeights[_],"cc-bloom-upsample");w.addRenderTarget(this._bloomTexNames[_],v.CLEAR,C.STORE,this._clearColorTransparentBlack),w.addTexture(this._bloomTexNames[_+1],"bloomTexture"),this._bloomTexSize.x=this._bloomWidths[_+1],this._bloomTexSize.y=this._bloomHeights[_+1],w.setVec4("g_platform",a.platform),w.setVec4("bloomTexSize",this._bloomTexSize),w.addQueue(h.OPAQUE).addFullscreenQuad(n,2)}var b=e.addRenderPass(s,o,"cc-bloom-combine");return b.addRenderTarget(l,v.LOAD,C.STORE),b.addTexture(this._bloomTexNames[0],"bloomTexture"),b.setVec4("g_platform",a.platform),b.setVec4("bloomParams",this._bloomParams),b.addQueue(h.BLEND).addFullscreenQuad(n,3),0===t.remainingPasses?W(e,a,t,l):b},e}()),Y=e("BuiltinToneMappingPassBuilder",function(){function e(){this._colorGradingTexSize=new s(0,0)}var a=e.prototype;return a.getConfigOrder=function(){return 0},a.getRenderOrder=function(){return 300},a.configCamera=function(e,a,t){var i=t.settings;t.enableColorGrading=i.colorGrading.enabled&&!!i.colorGrading.material&&!!i.colorGrading.colorGradingMap,t.enableToneMapping=t.enableHDR||t.enableColorGrading,t.enableToneMapping&&++t.remainingPasses},a.windowResize=function(e,a,t){t.enableColorGrading&&(l(!!t.settings.colorGrading.material),t.settings.colorGrading.material.setProperty("colorGradingMap",t.settings.colorGrading.colorGradingMap))},a.setup=function(e,a,t,i,n,r){if(!t.enableToneMapping)return r;if(--t.remainingPasses,l(t.remainingPasses>=0),0===t.remainingPasses)return this._addCopyAndTonemapPass(e,a,t,t.width,t.height,n.colorName,t.colorName);var s=t.renderWindowId,o=t.enableShadingScale?"ScaledLdrColor":"LdrColor",d=G(n.colorName,o,s),h=n.colorName;return n.colorName=d,this._addCopyAndTonemapPass(e,a,t,t.width,t.height,h,d)},a._addCopyAndTonemapPass=function(e,a,t,i,n,r,s){var o,h=t.settings;if(t.enableColorGrading){l(!!h.colorGrading.material),l(!!h.colorGrading.colorGradingMap);var c=h.colorGrading.colorGradingMap;this._colorGradingTexSize.x=c.width,this._colorGradingTexSize.y=c.height;var u=c.width===c.height;(o=u?e.addRenderPass(i,n,"cc-color-grading-8x8"):e.addRenderPass(i,n,"cc-color-grading-nx1")).addRenderTarget(s,v.CLEAR,C.STORE,I),o.addTexture(r,"sceneColorMap"),o.setVec4("g_platform",a.platform),o.setVec2("lutTextureSize",this._colorGradingTexSize),o.setFloat("contribute",h.colorGrading.contribute),o.addQueue(d.QueueHint.OPAQUE).addFullscreenQuad(h.colorGrading.material,u?1:0)}else(o=e.addRenderPass(i,n,"cc-tone-mapping")).addRenderTarget(s,v.CLEAR,C.STORE,I),o.addTexture(r,"inputTexture"),o.setVec4("g_platform",a.platform),h.toneMapping.material?o.addQueue(d.QueueHint.OPAQUE).addFullscreenQuad(h.toneMapping.material,0):(l(!!t.copyAndTonemapMaterial),o.addQueue(d.QueueHint.OPAQUE).addFullscreenQuad(t.copyAndTonemapMaterial,0));return o},e}()),X=e("BuiltinFXAAPassBuilder",function(){function e(){this._fxaaParams=new o(0,0,0,0)}var a=e.prototype;return a.getConfigOrder=function(){return 0},a.getRenderOrder=function(){return 400},a.configCamera=function(e,a,t){t.enableFXAA=t.settings.fxaa.enabled&&!!t.settings.fxaa.material,t.enableFXAA&&++t.remainingPasses},a.setup=function(e,a,t,i,n,r){if(!t.enableFXAA)return r;--t.remainingPasses,l(t.remainingPasses>=0);var s=t.renderWindowId,o=t.enableShadingScale?"ScaledLdrColor":"LdrColor",d=G(n.colorName,o,s);if(l(!!t.settings.fxaa.material),0===t.remainingPasses)return t.enableShadingScale?(this._addFxaaPass(e,a,t.settings.fxaa.material,t.width,t.height,n.colorName,d),W(e,a,t,d)):(l(t.width===t.nativeWidth),l(t.height===t.nativeHeight),this._addFxaaPass(e,a,t.settings.fxaa.material,t.width,t.height,n.colorName,t.colorName));var h=n.colorName;return n.colorName=d,this._addFxaaPass(e,a,t.settings.fxaa.material,t.width,t.height,h,d)},a._addFxaaPass=function(e,a,t,i,n,r,s){this._fxaaParams.x=i,this._fxaaParams.y=n,this._fxaaParams.z=1/i,this._fxaaParams.w=1/n;var o=e.addRenderPass(i,n,"cc-fxaa");return o.addRenderTarget(s,v.CLEAR,C.STORE,I),o.addTexture(r,"sceneColorMap"),o.setVec4("g_platform",a.platform),o.setVec4("texSize",this._fxaaParams),o.addQueue(d.QueueHint.OPAQUE).addFullscreenQuad(t,0),o},e}()),K=e("BuiltinFsrPassBuilder",function(){function e(){this._fsrParams=new o(0,0,0,0),this._fsrTexSize=new o(0,0,0,0)}var a=e.prototype;return a.getConfigOrder=function(){return 0},a.getRenderOrder=function(){return 500},a.configCamera=function(e,a,t){t.enableFSR=t.settings.fsr.enabled&&!!t.settings.fsr.material&&t.enableShadingScale&&t.shadingScale<1,t.enableFSR&&++t.remainingPasses},a.setup=function(e,a,t,i,n,r){if(!t.enableFSR)return r;--t.remainingPasses;var s=n.colorName,o=0===t.remainingPasses?t.colorName:G(n.colorName,"UiColor",t.renderWindowId);return n.colorName=o,l(!!t.settings.fsr.material),this._addFsrPass(e,a,t,t.settings,t.settings.fsr.material,t.renderWindowId,t.width,t.height,s,t.nativeWidth,t.nativeHeight,o)},a._addFsrPass=function(e,a,t,i,n,r,s,o,l,c,u,p){this._fsrTexSize.x=s,this._fsrTexSize.y=o,this._fsrTexSize.z=c,this._fsrTexSize.w=u,this._fsrParams.x=h(1-i.fsr.sharpness,.02,.98);var g=G(p,"UiColor",r),m=e.addRenderPass(c,u,"cc-fsr-easu");m.addRenderTarget(g,v.CLEAR,C.STORE,I),m.addTexture(l,"outputResultMap"),m.setVec4("g_platform",a.platform),m.setVec4("fsrTexSize",this._fsrTexSize),m.addQueue(d.QueueHint.OPAQUE).addFullscreenQuad(n,0);var S=e.addRenderPass(c,u,"cc-fsr-rcas");return S.addRenderTarget(p,v.CLEAR,C.STORE,I),S.addTexture(g,"outputResultMap"),S.setVec4("g_platform",a.platform),S.setVec4("fsrTexSize",this._fsrTexSize),S.setVec4("fsrParams",this._fsrParams),S.addQueue(d.QueueHint.OPAQUE).addFullscreenQuad(n,1),S},e}()),q=e("BuiltinUiPassBuilder",function(){function e(){}var a=e.prototype;return a.getConfigOrder=function(){return 0},a.getRenderOrder=function(){return 1e3},a.setup=function(e,a,t,i,n,r){l(!!r);var s=d.SceneFlags.UI;return t.enableProfiler&&(s|=d.SceneFlags.PROFILER,r.showStatistics=!0),r.addQueue(d.QueueHint.BLEND,"default","default").addScene(i,s),r},e}());if(d){var j=d.QueueHint,Z=d.SceneFlags,J=function(){function e(){this._pipelineEvent=t.director.root.pipelineEvent,this._forwardPass=new V,this._bloomPass=new k,this._toneMappingPass=new Y,this._fxaaPass=new X,this._fsrPass=new K,this._uiPass=new q,this._clearColor=new T(0,0,0,1),this._viewport=new L,this._configs=new Q,this._cameraConfigs=new z,this._copyAndTonemapMaterial=new u,this._initialized=!1,this._passBuilders=[]}var i=e.prototype;return i._setupPipelinePreview=function(e,a){if(e.cameraUsage===D.SCENE_VIEW||e.cameraUsage===D.PREVIEW){var t=d.getEditorPipelineSettings();a.settings=t||H}else e.pipelineSettings?a.settings=e.pipelineSettings:a.settings=H},i._preparePipelinePasses=function(e){var t=this._passBuilders;t.length=0;var i=e.settings;if(i._passes){for(var n,r=a(i._passes);!(n=r()).done;){var s=n.value;t.push(s)}l(t.length===i._passes.length)}t.push(this._forwardPass),i.bloom.enabled&&t.push(this._bloomPass),t.push(this._toneMappingPass),i.fxaa.enabled&&t.push(this._fxaaPass),i.fsr.enabled&&t.push(this._fsrPass),t.push(this._uiPass)},i._setupBuiltinCameraConfigs=function(e,a,t){var i=e.window,r=e.cameraUsage===D.GAME&&!!i.swapchain;t.isMainGameWindow=r,t.renderWindowId=i.renderWindowId,t.colorName=i.colorName,t.depthStencilName=i.depthStencilName,t.enableFullPipeline=0!=(e.visibility&p.Enum.DEFAULT),t.enableProfiler=f,t.remainingPasses=0,t.shadingScale=t.settings.shadingScale,t.enableShadingScale=t.settings.enableShadingScale&&1!==t.shadingScale,t.nativeWidth=Math.max(Math.floor(i.width),1),t.nativeHeight=Math.max(Math.floor(i.height),1),t.width=t.enableShadingScale?Math.max(Math.floor(t.nativeWidth*t.shadingScale),1):t.nativeWidth,t.height=t.enableShadingScale?Math.max(Math.floor(t.nativeHeight*t.shadingScale),1):t.nativeHeight,t.enableHDR=t.enableFullPipeline&&a.useFloatOutput,t.radianceFormat=t.enableHDR?n.Format.RGBA16F:n.Format.RGBA8,t.copyAndTonemapMaterial=this._copyAndTonemapMaterial,t.enableStoreSceneDepth=!1},i._setupCameraConfigs=function(e,t,i){this._setupPipelinePreview(e,i),this._preparePipelinePasses(i),this._passBuilders.sort((function(e,a){return e.getConfigOrder()-a.getConfigOrder()})),this._setupBuiltinCameraConfigs(e,t,i);for(var n,r=a(this._passBuilders);!(n=r()).done;){var s=n.value;s.configCamera&&s.configCamera(e,t,i)}},i.windowResize=function(e,t,i,n,r){y(e,this._configs),this._setupCameraConfigs(i,this._configs,this._cameraConfigs);var s=t.renderWindowId;e.addRenderWindow(this._cameraConfigs.colorName,M.RGBA8,n,r,t,this._cameraConfigs.depthStencilName);var o=this._cameraConfigs.width,d=this._cameraConfigs.height;this._cameraConfigs.enableShadingScale?(e.addDepthStencil("ScaledSceneDepth_"+s,M.DEPTH_STENCIL,o,d),e.addRenderTarget("ScaledRadiance0_"+s,this._cameraConfigs.radianceFormat,o,d),e.addRenderTarget("ScaledRadiance1_"+s,this._cameraConfigs.radianceFormat,o,d),e.addRenderTarget("ScaledLdrColor0_"+s,M.RGBA8,o,d),e.addRenderTarget("ScaledLdrColor1_"+s,M.RGBA8,o,d)):(e.addDepthStencil("SceneDepth_"+s,M.DEPTH_STENCIL,o,d),e.addRenderTarget("Radiance0_"+s,this._cameraConfigs.radianceFormat,o,d),e.addRenderTarget("Radiance1_"+s,this._cameraConfigs.radianceFormat,o,d),e.addRenderTarget("LdrColor0_"+s,M.RGBA8,o,d),e.addRenderTarget("LdrColor1_"+s,M.RGBA8,o,d)),e.addRenderTarget("UiColor0_"+s,M.RGBA8,n,r),e.addRenderTarget("UiColor1_"+s,M.RGBA8,n,r);for(var l,h=a(this._passBuilders);!(l=h()).done;){var c=l.value;c.windowResize&&c.windowResize(e,this._configs,this._cameraConfigs,t,i,n,r)}},i.setup=function(e,t){if(!this._initMaterials(t))for(var i,n=a(e);!(i=n()).done;){var r=i.value;r.scene&&r.window&&(this._setupCameraConfigs(r,this._configs,this._cameraConfigs),this._pipelineEvent.emit(g.RENDER_CAMERA_BEGIN,r),this._cameraConfigs.enableFullPipeline?this._buildForwardPipeline(t,r,r.scene,this._passBuilders):this._buildSimplePipeline(t,r),this._pipelineEvent.emit(g.RENDER_CAMERA_END,r))}},i._buildSimplePipeline=function(e,a){var t=Math.max(Math.floor(a.window.width),1),i=Math.max(Math.floor(a.window.height),1),n=this._cameraConfigs.colorName,r=this._cameraConfigs.depthStencilName,s=a.viewport;this._viewport.left=Math.round(s.x*t),this._viewport.top=Math.round(s.y*i),this._viewport.width=Math.max(Math.round(s.width*t),1),this._viewport.height=Math.max(Math.round(s.height*i),1);var o=a.clearColor;this._clearColor.x=o.x,this._clearColor.y=o.y,this._clearColor.z=o.z,this._clearColor.w=o.w;var d=e.addRenderPass(t,i,"default");O(a)?d.addRenderTarget(n,v.CLEAR,C.STORE,this._clearColor):d.addRenderTarget(n,v.LOAD,C.STORE),a.clearFlag&R.DEPTH_STENCIL?d.addDepthStencil(r,v.CLEAR,C.DISCARD,a.clearDepth,a.clearStencil,a.clearFlag&R.DEPTH_STENCIL):d.addDepthStencil(r,v.LOAD,C.DISCARD),d.setViewport(this._viewport),d.addQueue(j.OPAQUE).addScene(a,Z.OPAQUE);var l=Z.BLEND|Z.UI;this._cameraConfigs.enableProfiler&&(l|=Z.PROFILER,d.showStatistics=!0),d.addQueue(j.BLEND).addScene(a,l)},i._buildForwardPipeline=function(e,t,i,n){!function(e){e.sort((function(e,a){return e.getRenderOrder()-a.getRenderOrder()}))}(n);for(var r,s={colorName:"",depthStencilName:""},o=void 0,d=a(n);!(r=d()).done;){var h=r.value;h.setup&&(o=h.setup(e,this._configs,this._cameraConfigs,t,s,o))}l(0===this._cameraConfigs.remainingPasses)},i._initMaterials=function(e){return this._initialized?0:(y(e,this._configs),this._copyAndTonemapMaterial._uuid="builtin-pipeline-tone-mapping-material",this._copyAndTonemapMaterial.initialize({effectName:"pipeline/post-process/tone-mapping"}),this._copyAndTonemapMaterial.effectAsset&&(this._initialized=!0),this._initialized?0:1)},e}();d.setCustomPipeline("Builtin",new J)}t._RF.pop()}}}));

System.register("bundle://internal/_virtual/env",[],(function(e){return{execute:function(){e("DEBUG",!1)}}}));

System.register("bundle://internal/_virtual/internal",["./builtin-pipeline-settings.ts","./builtin-pipeline-types.ts","./builtin-pipeline.ts"],(function(){return{setters:[null,null,null],execute:function(){}}}));

System.register("bundle://internal/_virtual/rollupPluginModLoBabelHelpers.js",[],(function(e){return{execute:function(){function r(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,a(i.key),i)}}function t(r,i){return(t=e("setPrototypeOf",Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e}))(r,i)}function i(e,r){if(e){if("string"==typeof e)return n(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?n(e,r):void 0}}function n(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,i=new Array(r);t<r;t++)i[t]=e[t];return i}function o(e,r){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}function a(e){var r=o(e,"string");return"symbol"==typeof r?r:String(r)}e({applyDecoratedDescriptor:function(e,r,t,i,n){var o={};Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0);o=t.slice().reverse().reduce((function(t,i){return i(e,r,t)||t}),o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0);void 0===o.initializer&&(Object.defineProperty(e,r,o),o=null);return o},arrayLikeToArray:n,assertThisInitialized:function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},createClass:function(e,t,i){t&&r(e.prototype,t);i&&r(e,i);return Object.defineProperty(e,"prototype",{writable:!1}),e},createForOfIteratorHelperLoose:function(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=i(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},inheritsLoose:function(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,t(e,r)},initializerDefineProperty:function(e,r,t,i){if(!t)return;Object.defineProperty(e,r,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(i):void 0})},setPrototypeOf:t,toPrimitive:o,toPropertyKey:a,unsupportedIterableToArray:i})}}}));

(function(r) {
  r('virtual:///prerequisite-imports/internal', 'bundle://internal/_virtual/internal'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2ZpbGU6L0M6L1Byb2dyYW1EYXRhL2NvY29zL2VkaXRvcnMvQ3JlYXRvci8zLjguNi9yZXNvdXJjZXMvcmVzb3VyY2VzLzNkL2VuZ2luZS9lZGl0b3IvYXNzZXRzL2RlZmF1bHRfcmVuZGVycGlwZWxpbmUvZmlsZTovQzovUHJvZ3JhbURhdGEvY29jb3MvZWRpdG9ycy9DcmVhdG9yLzMuOC42L3Jlc291cmNlcy9yZXNvdXJjZXMvM2QvZW5naW5lL2VkaXRvci9hc3NldHMvZGVmYXVsdF9yZW5kZXJwaXBlbGluZS9idWlsdGluLXBpcGVsaW5lLXNldHRpbmdzLnRzIiwiLi4vZmlsZTovQzovUHJvZ3JhbURhdGEvY29jb3MvZWRpdG9ycy9DcmVhdG9yLzMuOC42L3Jlc291cmNlcy9yZXNvdXJjZXMvM2QvZW5naW5lL2VkaXRvci9hc3NldHMvZGVmYXVsdF9yZW5kZXJwaXBlbGluZS9maWxlOi9DOi9Qcm9ncmFtRGF0YS9jb2Nvcy9lZGl0b3JzL0NyZWF0b3IvMy44LjYvcmVzb3VyY2VzL3Jlc291cmNlcy8zZC9lbmdpbmUvZWRpdG9yL2Fzc2V0cy9kZWZhdWx0X3JlbmRlcnBpcGVsaW5lL2J1aWx0aW4tcGlwZWxpbmUtdHlwZXMudHMiLCIuLi9maWxlOi9DOi9Qcm9ncmFtRGF0YS9jb2Nvcy9lZGl0b3JzL0NyZWF0b3IvMy44LjYvcmVzb3VyY2VzL3Jlc291cmNlcy8zZC9lbmdpbmUvZWRpdG9yL2Fzc2V0cy9kZWZhdWx0X3JlbmRlcnBpcGVsaW5lL2ZpbGU6L0M6L1Byb2dyYW1EYXRhL2NvY29zL2VkaXRvcnMvQ3JlYXRvci8zLjguNi9yZXNvdXJjZXMvcmVzb3VyY2VzLzNkL2VuZ2luZS9lZGl0b3IvYXNzZXRzL2RlZmF1bHRfcmVuZGVycGlwZWxpbmUvYnVpbHRpbi1waXBlbGluZS50cyIsIi4uL3ZpcnR1YWw6L2NjL3ZpcnR1YWw6L2NjL2VudiIsIi4uL2NjZTovaW50ZXJuYWwvY2NlOi9pbnRlcm5hbC9yb2xsdXBQbHVnaW5Nb2RMb0JhYmVsSGVscGVycy5qcyJdLCJuYW1lcyI6WyJjY2NsYXNzIiwiX2RlY29yYXRvciIsImRpc2FsbG93TXVsdGlwbGUiLCJleGVjdXRlSW5FZGl0TW9kZSIsIm1lbnUiLCJwcm9wZXJ0eSIsInJlcXVpcmVDb21wb25lbnQiLCJ0eXBlIiwiX2RlYyIsIl9kZWMyIiwiX2RlYzMiLCJDYW1lcmEiLCJfZGVjNCIsIkNDQm9vbGVhbiIsIl9kZWM1IiwiZGlzcGxheU5hbWUiLCJfZGVjNiIsImdyb3VwIiwiaWQiLCJuYW1lIiwiX2RlYzciLCJzdHlsZSIsIkNDSW50ZWdlciIsInJhbmdlIiwiX2RlYzgiLCJfZGVjOSIsInRvb2x0aXAiLCJDQ0Zsb2F0Iiwic2xpZGUiLCJfZGVjMTAiLCJfZGVjMTEiLCJNYXRlcmlhbCIsIl9kZWMxMiIsIl9kZWMxMyIsIl9kZWMxNCIsIm1pbiIsIl9kZWMxNSIsIl9kZWMxNiIsIl9kZWMxNyIsIl9kZWMxOCIsIlRleHR1cmUyRCIsIl9kZWMxOSIsIl9kZWMyMCIsIl9kZWMyMSIsIl9kZWMyMiIsIl9kZWMyMyIsIl9kZWMyNCIsIl9jbGFzcyIsIl9kZXNjcmlwdG9yIiwiX2FwcGx5RGVjb3JhdGVkRGVzY3JpcHRvciIsIl9jbGFzczIiLCJfQ29tcG9uZW50IiwiQnVpbHRpblBpcGVsaW5lU2V0dGluZ3MiLCJfdGhpcyIsIl9sZW4iLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJhcmdzIiwiQXJyYXkiLCJfa2V5IiwiY2FsbCIsImFwcGx5IiwiY29uY2F0IiwiX2luaXRpYWxpemVyRGVmaW5lUHJvcGVydHkiLCJfYXNzZXJ0VGhpc0luaXRpYWxpemVkIiwiX2Rlc2NyaXB0b3IyIiwiX2luaGVyaXRzTG9vc2UiLCJfcHJvdG8iLCJwcm90b3R5cGUiLCJnZXRQaXBlbGluZVNldHRpbmdzIiwidGhpcyIsIl9zZXR0aW5ncyIsIm9uRW5hYmxlIiwiZmlsbFJlcXVpcmVkUGlwZWxpbmVTZXR0aW5ncyIsImdldENvbXBvbmVudCIsImNhbWVyYSIsInBpcGVsaW5lU2V0dGluZ3MiLCJvbkRpc2FibGUiLCJfdHJ5RW5hYmxlRWRpdG9yUHJldmlldyIsInVuZGVmaW5lZCIsInJlbmRlcmluZyIsIl9lZGl0b3JQcmV2aWV3Iiwic2V0RWRpdG9yUGlwZWxpbmVTZXR0aW5ncyIsIl9kaXNhYmxlRWRpdG9yUHJldmlldyIsImdldEVkaXRvclBpcGVsaW5lU2V0dGluZ3MiLCJfY3JlYXRlQ2xhc3MiLCJrZXkiLCJnZXQiLCJzZXQiLCJ2IiwibXNhYSIsImVuYWJsZWQiLCJ2YWx1ZSIsInNhbXBsZUNvdW50IiwiTWF0aCIsInBvdyIsImNlaWwiLCJsb2cyIiwibWF4IiwiZW5hYmxlU2hhZGluZ1NjYWxlIiwic2hhZGluZ1NjYWxlIiwiYmxvb20iLCJtYXRlcmlhbCIsImVuYWJsZUFscGhhTWFzayIsIml0ZXJhdGlvbnMiLCJ0aHJlc2hvbGQiLCJpbnRlbnNpdHkiLCJjb2xvckdyYWRpbmciLCJjb250cmlidXRlIiwiY29sb3JHcmFkaW5nTWFwIiwidmFsIiwiZnhhYSIsImZzciIsInNoYXJwbmVzcyIsInRvbmVNYXBwaW5nIiwiQ29tcG9uZW50IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsIndyaXRhYmxlIiwiaW5pdGlhbGl6ZXIiLCJtYWtlUGlwZWxpbmVTZXR0aW5ncyIsIk9iamVjdCIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsIl9SRiIsInBvcCIsInJhZGl1c1NjYWxlIiwiYW5nbGVCaWFzRGVncmVlIiwiYmx1clNoYXJwbmVzcyIsImFvU2F0dXJhdGlvbiIsIm5lZWRCbHVyIiwiZmlsbFJlcXVpcmVkTVNBQSIsIm1ha2VNU0FBIiwiZmlsbFJlcXVpcmVkQmxvb20iLCJmaWxsUmVxdWlyZWRUb25lTWFwcGluZyIsImZpbGxSZXF1aXJlZENvbG9yR3JhZGluZyIsImZpbGxSZXF1aXJlZEZTUiIsImZpbGxSZXF1aXJlZEZYQUEiLCJTYW1wbGVDb3VudCIsImdmeCIsIlg0IiwibWFrZUJsb29tIiwibWFrZUNvbG9yR3JhZGluZyIsIm1ha2VGU1IiLCJtYWtlRlhBQSIsIm1ha2VUb25lTWFwcGluZyIsIkFBQkIiLCJnZW9tZXRyeSIsIlNwaGVyZSIsImludGVyc2VjdCIsIkNsZWFyRmxhZ0JpdCIsIkNvbG9yIiwiRm9ybWF0IiwiRm9ybWF0RmVhdHVyZUJpdCIsIkxvYWRPcCIsIlN0b3JlT3AiLCJUZXh0dXJlVHlwZSIsIlZpZXdwb3J0Iiwic2NlbmUiLCJyZW5kZXJlciIsIkNhbWVyYVVzYWdlIiwiQ1NNTGV2ZWwiLCJMaWdodFR5cGUiLCJmb3J3YXJkTmVlZENsZWFyQ29sb3IiLCJjbGVhckZsYWciLCJDT0xPUiIsIlNURU5DSUwiLCJnZXRDc21NYWluTGlnaHRWaWV3cG9ydCIsImxpZ2h0IiwidyIsImgiLCJsZXZlbCIsInZwIiwic2NyZWVuU3BhY2VTaWduWSIsInNoYWRvd0ZpeGVkQXJlYSIsImNzbUxldmVsIiwiTEVWRUxfMSIsImxlZnQiLCJ0b3AiLCJ3aWR0aCIsInRydW5jIiwiaGVpZ2h0IiwiZmxvb3IiLCJQaXBlbGluZUNvbmZpZ3MiLCJpc1dlYiIsImlzV2ViR0wxIiwiaXNXZWJHUFUiLCJpc01vYmlsZSIsImlzSERSIiwidXNlRmxvYXRPdXRwdXQiLCJ0b25lTWFwcGluZ1R5cGUiLCJzaGFkb3dFbmFibGVkIiwic2hhZG93TWFwRm9ybWF0IiwiUjMyRiIsInNoYWRvd01hcFNpemUiLCJWZWMyIiwidXNlUGxhbmFyU2hhZG93Iiwic3VwcG9ydERlcHRoU2FtcGxlIiwibW9iaWxlTWF4U3BvdExpZ2h0U2hhZG93TWFwcyIsInBsYXRmb3JtIiwiVmVjNCIsInNldHVwUGlwZWxpbmVDb25maWdzIiwicHBsIiwiY29uZmlncyIsInNhbXBsZUZlYXR1cmUiLCJTQU1QTEVEX1RFWFRVUkUiLCJMSU5FQVJfRklMVEVSIiwiZGV2aWNlIiwic3lzIiwiaXNOYXRpdmUiLCJnZnhBUEkiLCJBUEkiLCJXRUJHTCIsIldFQkdQVSIsInBpcGVsaW5lU2NlbmVEYXRhIiwiZ2V0TWFjcm9Cb29sIiwicG9zdFNldHRpbmdzIiwic2hhZG93SW5mbyIsInNoYWRvd3MiLCJwaXBlbGluZSIsInN1cHBvcnRzUjMyRmxvYXRUZXh0dXJlIiwiUkdCQTgiLCJzaXplIiwiU2hhZG93VHlwZSIsIlBsYW5hciIsImNhcGFiaWxpdGllcyIsImdldEZvcm1hdEZlYXR1cmVzIiwiREVQVEhfU1RFTkNJTCIsIngiLCJjbGlwU3BhY2VTaWduWSIsImRlZmF1bHRTZXR0aW5ncyIsIkNhbWVyYUNvbmZpZ3MiLCJzZXR0aW5ncyIsImlzTWFpbkdhbWVXaW5kb3ciLCJyZW5kZXJXaW5kb3dJZCIsImNvbG9yTmFtZSIsImRlcHRoU3RlbmNpbE5hbWUiLCJlbmFibGVGdWxsUGlwZWxpbmUiLCJlbmFibGVQcm9maWxlciIsInJlbWFpbmluZ1Bhc3NlcyIsIm5hdGl2ZVdpZHRoIiwibmF0aXZlSGVpZ2h0IiwiZW5hYmxlSERSIiwicmFkaWFuY2VGb3JtYXQiLCJjb3B5QW5kVG9uZW1hcE1hdGVyaWFsIiwiZW5hYmxlU3RvcmVTY2VuZURlcHRoIiwic0NsZWFyQ29sb3JUcmFuc3BhcmVudEJsYWNrIiwiYWRkQ29weVRvU2NyZWVuUGFzcyIsInBwbENvbmZpZ3MiLCJjYW1lcmFDb25maWdzIiwiaW5wdXQiLCJhc3NlcnQiLCJwYXNzIiwiYWRkUmVuZGVyUGFzcyIsImFkZFJlbmRlclRhcmdldCIsIkNMRUFSIiwiU1RPUkUiLCJhZGRUZXh0dXJlIiwic2V0VmVjNCIsImFkZFF1ZXVlIiwiUXVldWVIaW50IiwiT1BBUVVFIiwiYWRkRnVsbHNjcmVlblF1YWQiLCJnZXRQaW5nUG9uZ1JlbmRlclRhcmdldCIsInByZXZOYW1lIiwicHJlZml4Iiwic3RhcnRzV2l0aCIsIk51bWJlciIsImNoYXJBdCIsIkZvcndhcmRMaWdodGluZyIsImxpZ2h0cyIsInNoYWRvd0VuYWJsZWRTcG90TGlnaHRzIiwiX3NwaGVyZSIsImNyZWF0ZSIsIl9ib3VuZGluZ0JveCIsIl9yYW5nZWREaXJMaWdodEJvdW5kaW5nQm94IiwiY3VsbExpZ2h0cyIsImZydXN0dW0iLCJjYW1lcmFQb3MiLCJfc3RlcCIsIl9pdGVyYXRvciIsIl9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyTG9vc2UiLCJzcG90TGlnaHRzIiwiZG9uZSIsImJha2VkIiwicG9zaXRpb24iLCJ5IiwieiIsInNwaGVyZUZydXN0dW0iLCJwdXNoIiwiX3N0ZXAyIiwiX2l0ZXJhdG9yMiIsInNwaGVyZUxpZ2h0cyIsIl9zdGVwMyIsIl9pdGVyYXRvcjMiLCJwb2ludExpZ2h0cyIsIl9zdGVwNCIsIl9pdGVyYXRvcjQiLCJyYW5nZWREaXJMaWdodHMiLCJ0cmFuc2Zvcm0iLCJub2RlIiwiZ2V0V29ybGRNYXRyaXgiLCJhYWJiRnJ1c3R1bSIsInNvcnQiLCJsaHMiLCJyaHMiLCJWZWMzIiwic3F1YXJlZERpc3RhbmNlIiwiX2FkZExpZ2h0UXVldWVzIiwiX3N0ZXA1IiwiX2l0ZXJhdG9yNSIsInF1ZXVlIiwiQkxFTkQiLCJTUEhFUkUiLCJTUE9UIiwiUE9JTlQiLCJSQU5HRURfRElSRUNUSU9OQUwiLCJhZGRTY2VuZSIsIlNjZW5lRmxhZ3MiLCJhZGRTcG90bGlnaHRTaGFkb3dQYXNzZXMiLCJtYXhOdW1TaGFkb3dNYXBzIiwiX3N0ZXA2IiwiaSIsIl9pdGVyYXRvcjYiLCJzaGFkb3dQYXNzIiwiYWRkRGVwdGhTdGVuY2lsIiwiRElTQ0FSRCIsIk5PTkUiLCJNQVNLIiwiU0hBRE9XX0NBU1RFUiIsInVzZUxpZ2h0RnJ1c3R1bSIsImFkZExpZ2h0UXVldWVzIiwiX3N0ZXA3IiwiX2l0ZXJhdG9yNyIsImFkZExpZ2h0UGFzc2VzIiwiZGVwdGhTdGVuY2lsU3RvcmVPcCIsInZpZXdwb3J0IiwiX3N0ZXA4IiwiY291bnQiLCJfaXRlcmF0b3I4Iiwic3RvcmVPcCIsInNldFZpZXdwb3J0IiwiTE9BRCIsImlzTXVsdGlwbGVMaWdodFBhc3Nlc05lZWRlZCIsIkJ1aWx0aW5Gb3J3YXJkUGFzc0J1aWxkZXIiLCJmb3J3YXJkTGlnaHRpbmciLCJfdmlld3BvcnQiLCJfY2xlYXJDb2xvciIsIl9yZWZsZWN0aW9uUHJvYmVDbGVhckNvbG9yIiwiX3Byb3RvMiIsImdldENvbmZpZ09yZGVyIiwiQ29uZmlnT3JkZXIiLCJnZXRSZW5kZXJPcmRlciIsIlJlbmRlck9yZGVyIiwiY29uZmlnQ2FtZXJhIiwicGlwZWxpbmVDb25maWdzIiwiZW5hYmxlTWFpbkxpZ2h0U2hhZG93TWFwIiwibWFpbkxpZ2h0IiwiZW5hYmxlTWFpbkxpZ2h0UGxhbmFyU2hhZG93TWFwIiwiZW5hYmxlUGxhbmFyUmVmbGVjdGlvblByb2JlIiwiY2FtZXJhVXNhZ2UiLCJTQ0VORV9WSUVXIiwiR0FNRV9WSUVXIiwiZW5hYmxlTVNBQSIsImVuYWJsZVNpbmdsZUZvcndhcmRQYXNzIiwid2luZG93UmVzaXplIiwid2luZG93IiwiUmVzb3VyY2VGbGFncyIsIlJlc291cmNlUmVzaWRlbmN5IiwiVEVYMkQiLCJDT0xPUl9BVFRBQ0hNRU5UIiwiTUVNT1JZTEVTUyIsIkRFUFRIX1NURU5DSUxfQVRUQUNITUVOVCIsInNldHVwIiwiY29udGV4dCIsIl9hZGRDYXNjYWRlZFNoYWRvd01hcFBhc3MiLCJfdHJ5QWRkUmVmbGVjdGlvblByb2JlUGFzc2VzIiwiX2FkZEZvcndhcmRSYWRpYW5jZVBhc3NlcyIsInNoYWRvd1NpemUiLCJjc21TdXBwb3J0ZWQiLCJyZWZsZWN0aW9uUHJvYmVNYW5hZ2VyIiwiY2NsZWdhY3kiLCJpbnRlcm5hbCIsIl9zdGVwOSIsInByb2JlcyIsImdldFByb2JlcyIsInByb2JlSUQiLCJfaXRlcmF0b3I5IiwicHJvYmUiLCJuZWVkUmVuZGVyIiwiYXJlYSIsInJlbmRlckFyZWEiLCJwcm9iZVR5cGUiLCJQcm9iZVR5cGUiLCJQTEFOQVIiLCJyZWFsdGltZVBsYW5hclRleHR1cmUiLCJhZGRSZW5kZXJXaW5kb3ciLCJwcm9iZVBhc3MiLCJfYnVpbGRSZWZsZWN0aW9uUHJvYmVQYXNzIiwiY29sb3JTdG9yZU9wIiwiY2xlYXJDb2xvciIsInBhY2tSR0JFIiwiY2xlYXJEZXB0aCIsImNsZWFyU3RlbmNpbCIsIlJFRkxFQ1RJT05fUFJPQkUiLCJkaXNhYmxlTVNBQSIsInJvdW5kIiwiX2FkZEZvcndhcmRTaW5nbGVSYWRpYW5jZVBhc3MiLCJfYWRkRm9yd2FyZE11bHRpcGxlUmFkaWFuY2VQYXNzZXMiLCJfYWRkUGxhbmFyU2hhZG93UXVldWUiLCJzY2VuZUZsYWdzIiwiZ2VvbWV0cnlSZW5kZXJlciIsIkdFT01FVFJZIiwibXNhYVJhZGlhbmNlTmFtZSIsIm1zYWFEZXB0aFN0ZW5jaWxOYW1lIiwibXNQYXNzIiwiYWRkTXVsdGlzYW1wbGVSZW5kZXJQYXNzIiwiX2J1aWxkRm9yd2FyZE1haW5MaWdodFBhc3MiLCJyZXNvbHZlUmVuZGVyVGFyZ2V0IiwiZmlyc3RTdG9yZU9wIiwiUExBTkFSX1NIQURPVyIsIkJ1aWx0aW5CbG9vbVBhc3NCdWlsZGVyIiwiX2NsZWFyQ29sb3JUcmFuc3BhcmVudEJsYWNrIiwiX2Jsb29tUGFyYW1zIiwiX2Jsb29tVGV4U2l6ZSIsIl9ibG9vbVdpZHRocyIsIl9ibG9vbUhlaWdodHMiLCJfYmxvb21UZXhOYW1lcyIsIl9wcm90bzMiLCJlbmFibGVCbG9vbSIsImJsb29tV2lkdGgiLCJibG9vbUhlaWdodCIsInByZXZSZW5kZXJQYXNzIiwiX2FkZEthd2FzZUR1YWxGaWx0ZXJCbG9vbVBhc3NlcyIsImJsb29tTWF0ZXJpYWwiLCJyYWRpYW5jZU5hbWUiLCJzaXplQ291bnQiLCJwcmVmaWx0ZXJQYXNzIiwiZG93blBhc3MiLCJ1cFBhc3MiLCJjb21iaW5lUGFzcyIsIkJ1aWx0aW5Ub25lTWFwcGluZ1Bhc3NCdWlsZGVyIiwiX2NvbG9yR3JhZGluZ1RleFNpemUiLCJfcHJvdG80IiwiZW5hYmxlQ29sb3JHcmFkaW5nIiwiZW5hYmxlVG9uZU1hcHBpbmciLCJzZXRQcm9wZXJ0eSIsIl9hZGRDb3B5QW5kVG9uZW1hcFBhc3MiLCJsZHJDb2xvclByZWZpeCIsImxkckNvbG9yTmFtZSIsImx1dFRleCIsImlzU3F1YXJlTWFwIiwic2V0VmVjMiIsInNldEZsb2F0IiwiQnVpbHRpbkZYQUFQYXNzQnVpbGRlciIsIl9meGFhUGFyYW1zIiwiX3Byb3RvNSIsImVuYWJsZUZYQUEiLCJfYWRkRnhhYVBhc3MiLCJpbnB1dENvbG9yTmFtZSIsImZ4YWFNYXRlcmlhbCIsIkJ1aWx0aW5Gc3JQYXNzQnVpbGRlciIsIl9mc3JQYXJhbXMiLCJfZnNyVGV4U2l6ZSIsIl9wcm90bzYiLCJlbmFibGVGU1IiLCJvdXRwdXRDb2xvck5hbWUiLCJfYWRkRnNyUGFzcyIsImZzck1hdGVyaWFsIiwiY2xhbXAiLCJmc3JDb2xvck5hbWUiLCJlYXN1UGFzcyIsInJjYXNQYXNzIiwiQnVpbHRpblVpUGFzc0J1aWxkZXIiLCJfcHJvdG83IiwiZmxhZ3MiLCJVSSIsIlBST0ZJTEVSIiwic2hvd1N0YXRpc3RpY3MiLCJCdWlsdGluUGlwZWxpbmVCdWlsZGVyIiwiX3BpcGVsaW5lRXZlbnQiLCJkaXJlY3RvciIsInJvb3QiLCJwaXBlbGluZUV2ZW50IiwiX2ZvcndhcmRQYXNzIiwiX2Jsb29tUGFzcyIsIl90b25lTWFwcGluZ1Bhc3MiLCJfZnhhYVBhc3MiLCJfZnNyUGFzcyIsIl91aVBhc3MiLCJfY29uZmlncyIsIl9jYW1lcmFDb25maWdzIiwiX2NvcHlBbmRUb25lbWFwTWF0ZXJpYWwiLCJfaW5pdGlhbGl6ZWQiLCJfcGFzc0J1aWxkZXJzIiwiX3Byb3RvOCIsIl9zZXR1cFBpcGVsaW5lUHJldmlldyIsIlBSRVZJRVciLCJlZGl0b3JTZXR0aW5ncyIsIl9wcmVwYXJlUGlwZWxpbmVQYXNzZXMiLCJwYXNzQnVpbGRlcnMiLCJfcGFzc2VzIiwiX3N0ZXAxMCIsIl9pdGVyYXRvcjEwIiwiX3NldHVwQnVpbHRpbkNhbWVyYUNvbmZpZ3MiLCJHQU1FIiwic3dhcGNoYWluIiwidmlzaWJpbGl0eSIsIkxheWVycyIsIkVudW0iLCJERUZBVUxUIiwiREVCVUciLCJSR0JBMTZGIiwiX3NldHVwQ2FtZXJhQ29uZmlncyIsImEiLCJiIiwiX3N0ZXAxMSIsIl9pdGVyYXRvcjExIiwiYnVpbGRlciIsIl9zdGVwMTIiLCJfaXRlcmF0b3IxMiIsImNhbWVyYXMiLCJfaW5pdE1hdGVyaWFscyIsIl9zdGVwMTMiLCJfaXRlcmF0b3IxMyIsImVtaXQiLCJQaXBlbGluZUV2ZW50VHlwZSIsIlJFTkRFUl9DQU1FUkFfQkVHSU4iLCJfYnVpbGRGb3J3YXJkUGlwZWxpbmUiLCJfYnVpbGRTaW1wbGVQaXBlbGluZSIsIlJFTkRFUl9DQU1FUkFfRU5EIiwic29ydFBpcGVsaW5lUGFzc0J1aWxkZXJzQnlSZW5kZXJPcmRlciIsIl9zdGVwMTQiLCJsYXN0UGFzcyIsIl9pdGVyYXRvcjE0IiwiX3V1aWQiLCJpbml0aWFsaXplIiwiZWZmZWN0TmFtZSIsImVmZmVjdEFzc2V0Iiwic2V0Q3VzdG9tUGlwZWxpbmUiLCJfZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiZGVzY3JpcHRvciIsImRlZmluZVByb3BlcnR5IiwiX3RvUHJvcGVydHlLZXkiLCJfc2V0UHJvdG90eXBlT2YiLCJvIiwicCIsInNldFByb3RvdHlwZU9mIiwiYmluZCIsIl9fcHJvdG9fXyIsIl91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheSIsIm1pbkxlbiIsIl9hcnJheUxpa2VUb0FycmF5IiwibiIsInRvU3RyaW5nIiwic2xpY2UiLCJjb25zdHJ1Y3RvciIsImZyb20iLCJ0ZXN0IiwiYXJyIiwibGVuIiwiYXJyMiIsIl90b1ByaW1pdGl2ZSIsImhpbnQiLCJwcmltIiwiU3ltYm9sIiwidG9QcmltaXRpdmUiLCJyZXMiLCJUeXBlRXJyb3IiLCJTdHJpbmciLCJhcmciLCJkZWNvcmF0b3JzIiwiZGVzYyIsImtleXMiLCJmb3JFYWNoIiwicmV2ZXJzZSIsInJlZHVjZSIsImRlY29yYXRvciIsInNlbGYiLCJSZWZlcmVuY2VFcnJvciIsIkNvbnN0cnVjdG9yIiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiYWxsb3dBcnJheUxpa2UiLCJpdCIsIml0ZXJhdG9yIiwibmV4dCIsImlzQXJyYXkiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiXSwibWFwcGluZ3MiOiJpdEJBbUNBLElBQVFBLEVBQXlGQyxFQUF6RkQsUUFBU0UsRUFBZ0ZELEVBQWhGQyxpQkFBa0JDLEVBQThERixFQUE5REUsa0JBQW1CQyxFQUEyQ0gs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Q3lnQixFQUFTemdCLFVBQVV5ZSxZQUFjZ0MsRUFDakM1QyxFQUFnQjRDLEVBQVVDLDhCQWthNUIsU0FBb0NsRCxFQUFRdmhCLEVBQVV5aEIsRUFBWXpLLEdBQ2hFLElBQUt5SyxFQUFZLE9BQ2pCcmEsT0FBT3NhLGVBQWVILEVBQVF2aEIsRUFBVSxDQUN0Q2dILFdBQVl5YSxFQUFXemEsV0FDdkJELGFBQWMwYSxFQUFXMWEsYUFDekJFLFNBQVV3YSxFQUFXeGEsU0FDckIxQixNQUFPa2MsRUFBV3ZhLFlBQWN1YSxFQUFXdmEsWUFBWTNELEtBQUt5VCxRQUFXIiwiZmlsZSI6ImFsbC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiBDb3B5cmlnaHQgKGMpIDIwMjEtMjAyNCBYaWFtZW4gWWFqaSBTb2Z0d2FyZSBDby4sIEx0ZC5cclxuXHJcbiBodHRwczovL3d3dy5jb2Nvcy5jb20vXHJcblxyXG4gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxyXG4gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxyXG4gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0b1xyXG4gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbyxcclxuIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG5cclxuIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXHJcbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cclxuIFRIRSBTT0ZUV0FSRS5cclxuKi9cclxuXHJcbmltcG9ydCB7XHJcbiAgICBfZGVjb3JhdG9yLCBDYW1lcmEsIENDQm9vbGVhbiwgQ0NGbG9hdCwgQ0NJbnRlZ2VyLCBDb21wb25lbnQsXHJcbiAgICBNYXRlcmlhbCwgcmVuZGVyaW5nLCBUZXh0dXJlMkQsXHJcbn0gZnJvbSAnY2MnO1xyXG5cclxuaW1wb3J0IHsgRURJVE9SIH0gZnJvbSAnY2MvZW52JztcclxuXHJcbmltcG9ydCB7XHJcbiAgICBmaWxsUmVxdWlyZWRQaXBlbGluZVNldHRpbmdzLCBtYWtlUGlwZWxpbmVTZXR0aW5ncywgUGlwZWxpbmVTZXR0aW5ncyxcclxufSBmcm9tICcuL2J1aWx0aW4tcGlwZWxpbmUtdHlwZXMnO1xyXG5cclxuY29uc3QgeyBjY2NsYXNzLCBkaXNhbGxvd011bHRpcGxlLCBleGVjdXRlSW5FZGl0TW9kZSwgbWVudSwgcHJvcGVydHksIHJlcXVpcmVDb21wb25lbnQsIHR5cGUgfSA9IF9kZWNvcmF0b3I7XHJcblxyXG5AY2NjbGFzcygnQnVpbHRpblBpcGVsaW5lU2V0dGluZ3MnKVxyXG5AbWVudSgnUmVuZGVyaW5nL0J1aWx0aW5QaXBlbGluZVNldHRpbmdzJylcclxuQHJlcXVpcmVDb21wb25lbnQoQ2FtZXJhKVxyXG5AZGlzYWxsb3dNdWx0aXBsZVxyXG5AZXhlY3V0ZUluRWRpdE1vZGVcclxuZXhwb3J0IGNsYXNzIEJ1aWx0aW5QaXBlbGluZVNldHRpbmdzIGV4dGVuZHMgQ29tcG9uZW50IHtcclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBfc2V0dGluZ3M6IFBpcGVsaW5lU2V0dGluZ3MgPSBtYWtlUGlwZWxpbmVTZXR0aW5ncygpO1xyXG5cclxuICAgIGdldFBpcGVsaW5lU2V0dGluZ3MoKTogUGlwZWxpbmVTZXR0aW5ncyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEVuYWJsZS9EaXNhYmxlXHJcbiAgICBvbkVuYWJsZSgpOiB2b2lkIHtcclxuICAgICAgICBmaWxsUmVxdWlyZWRQaXBlbGluZVNldHRpbmdzKHRoaXMuX3NldHRpbmdzKTtcclxuICAgICAgICBjb25zdCBjYW1lcmFDb21wb25lbnQgPSB0aGlzLmdldENvbXBvbmVudChDYW1lcmEpITtcclxuICAgICAgICBjb25zdCBjYW1lcmEgPSBjYW1lcmFDb21wb25lbnQuY2FtZXJhO1xyXG4gICAgICAgIGNhbWVyYS5waXBlbGluZVNldHRpbmdzID0gdGhpcy5fc2V0dGluZ3M7XHJcblxyXG4gICAgICAgIGlmIChFRElUT1IpIHtcclxuICAgICAgICAgICAgdGhpcy5fdHJ5RW5hYmxlRWRpdG9yUHJldmlldygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIG9uRGlzYWJsZSgpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBjYW1lcmFDb21wb25lbnQgPSB0aGlzLmdldENvbXBvbmVudChDYW1lcmEpITtcclxuICAgICAgICBjb25zdCBjYW1lcmEgPSBjYW1lcmFDb21wb25lbnQuY2FtZXJhO1xyXG4gICAgICAgIGNhbWVyYS5waXBlbGluZVNldHRpbmdzID0gbnVsbDtcclxuXHJcbiAgICAgICAgaWYgKEVESVRPUikge1xyXG4gICAgICAgICAgICB0aGlzLl9kaXNhYmxlRWRpdG9yUHJldmlldygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBFZGl0b3IgUHJldmlld1xyXG4gICAgQHByb3BlcnR5KENDQm9vbGVhbilcclxuICAgIHByb3RlY3RlZCBfZWRpdG9yUHJldmlldyA9IGZhbHNlO1xyXG5cclxuICAgIEBwcm9wZXJ0eSh7XHJcbiAgICAgICAgZGlzcGxheU5hbWU6ICdFZGl0b3IgUHJldmlldyAoRXhwZXJpbWVudGFsKScsXHJcbiAgICAgICAgdHlwZTogQ0NCb29sZWFuLFxyXG4gICAgfSlcclxuICAgIGdldCBlZGl0b3JQcmV2aWV3KCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9lZGl0b3JQcmV2aWV3O1xyXG4gICAgfVxyXG4gICAgc2V0IGVkaXRvclByZXZpZXcodjogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMuX2VkaXRvclByZXZpZXcgPSB2O1xyXG4gICAgICAgIGlmIChFRElUT1IpIHtcclxuICAgICAgICAgICAgdGhpcy5fdHJ5RW5hYmxlRWRpdG9yUHJldmlldygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHB1YmxpYyBfdHJ5RW5hYmxlRWRpdG9yUHJldmlldygpOiB2b2lkIHtcclxuICAgICAgICBpZiAocmVuZGVyaW5nID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fZWRpdG9yUHJldmlldykge1xyXG4gICAgICAgICAgICByZW5kZXJpbmcuc2V0RWRpdG9yUGlwZWxpbmVTZXR0aW5ncyh0aGlzLl9zZXR0aW5ncyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fZGlzYWJsZUVkaXRvclByZXZpZXcoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgX2Rpc2FibGVFZGl0b3JQcmV2aWV3KCk6IHZvaWQge1xyXG4gICAgICAgIGlmIChyZW5kZXJpbmcgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSByZW5kZXJpbmcuZ2V0RWRpdG9yUGlwZWxpbmVTZXR0aW5ncygpIGFzIFBpcGVsaW5lU2V0dGluZ3MgfCBudWxsO1xyXG4gICAgICAgIGlmIChjdXJyZW50ID09PSB0aGlzLl9zZXR0aW5ncykge1xyXG4gICAgICAgICAgICByZW5kZXJpbmcuc2V0RWRpdG9yUGlwZWxpbmVTZXR0aW5ncyhudWxsKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTVNBQVxyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICBncm91cDogeyBpZDogJ01TQUEnLCBuYW1lOiAnTXVsdGlzYW1wbGUgQW50aS1BbGlhc2luZycgfSxcclxuICAgICAgICB0eXBlOiBDQ0Jvb2xlYW4sXHJcbiAgICB9KVxyXG4gICAgZ2V0IE1zYWFFbmFibGUoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldHRpbmdzLm1zYWEuZW5hYmxlZDtcclxuICAgIH1cclxuICAgIHNldCBNc2FhRW5hYmxlKHZhbHVlOiBib29sZWFuKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MubXNhYS5lbmFibGVkID0gdmFsdWU7XHJcbiAgICAgICAgaWYgKEVESVRPUikge1xyXG4gICAgICAgICAgICB0aGlzLl90cnlFbmFibGVFZGl0b3JQcmV2aWV3KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIEBwcm9wZXJ0eSh7XHJcbiAgICAgICAgZ3JvdXA6IHsgaWQ6ICdNU0FBJywgbmFtZTogJ011bHRpc2FtcGxlIEFudGktQWxpYXNpbmcnLCBzdHlsZTogJ3NlY3Rpb24nIH0sXHJcbiAgICAgICAgdHlwZTogQ0NJbnRlZ2VyLFxyXG4gICAgICAgIHJhbmdlOiBbMiwgNCwgMl0sXHJcbiAgICB9KVxyXG4gICAgc2V0IG1zYWFTYW1wbGVDb3VudCh2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICAgICAgdmFsdWUgPSAyICoqIE1hdGguY2VpbChNYXRoLmxvZzIoTWF0aC5tYXgodmFsdWUsIDIpKSk7XHJcbiAgICAgICAgdmFsdWUgPSBNYXRoLm1pbih2YWx1ZSwgNCk7XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MubXNhYS5zYW1wbGVDb3VudCA9IHZhbHVlO1xyXG4gICAgICAgIGlmIChFRElUT1IpIHtcclxuICAgICAgICAgICAgdGhpcy5fdHJ5RW5hYmxlRWRpdG9yUHJldmlldygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBtc2FhU2FtcGxlQ291bnQoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3MubXNhYS5zYW1wbGVDb3VudDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTaGFkaW5nIFNjYWxlXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIGdyb3VwOiB7IGlkOiAnU2hhZGluZ1NjYWxlJywgbmFtZTogJ1NoYWRpbmdTY2FsZScsIHN0eWxlOiAnc2VjdGlvbicgfSxcclxuICAgICAgICB0eXBlOiBDQ0Jvb2xlYW4sXHJcbiAgICB9KVxyXG4gICAgc2V0IHNoYWRpbmdTY2FsZUVuYWJsZSh2YWx1ZTogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMuX3NldHRpbmdzLmVuYWJsZVNoYWRpbmdTY2FsZSA9IHZhbHVlO1xyXG4gICAgICAgIGlmIChFRElUT1IpIHtcclxuICAgICAgICAgICAgdGhpcy5fdHJ5RW5hYmxlRWRpdG9yUHJldmlldygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBzaGFkaW5nU2NhbGVFbmFibGUoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldHRpbmdzLmVuYWJsZVNoYWRpbmdTY2FsZTtcclxuICAgIH1cclxuXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHRvb2x0aXA6ICdpMThuOnBvc3Rwcm9jZXNzLnNoYWRpbmdTY2FsZScsXHJcbiAgICAgICAgZ3JvdXA6IHsgaWQ6ICdTaGFkaW5nU2NhbGUnLCBuYW1lOiAnU2hhZGluZ1NjYWxlJyB9LFxyXG4gICAgICAgIHR5cGU6IENDRmxvYXQsXHJcbiAgICAgICAgcmFuZ2U6IFswLjAxLCA0LCAwLjAxXSxcclxuICAgICAgICBzbGlkZTogdHJ1ZSxcclxuICAgIH0pXHJcbiAgICBzZXQgc2hhZGluZ1NjYWxlKHZhbHVlOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLl9zZXR0aW5ncy5zaGFkaW5nU2NhbGUgPSB2YWx1ZTtcclxuICAgICAgICBpZiAoRURJVE9SKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RyeUVuYWJsZUVkaXRvclByZXZpZXcoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgc2hhZGluZ1NjYWxlKCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldHRpbmdzLnNoYWRpbmdTY2FsZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBCbG9vbVxyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICBncm91cDogeyBpZDogJ0Jsb29tJywgbmFtZTogJ0Jsb29tIChQb3N0UHJvY2Vzc2luZyknLCBzdHlsZTogJ3NlY3Rpb24nIH0sXHJcbiAgICAgICAgdHlwZTogQ0NCb29sZWFuLFxyXG4gICAgfSlcclxuICAgIHNldCBibG9vbUVuYWJsZSh2YWx1ZTogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMuX3NldHRpbmdzLmJsb29tLmVuYWJsZWQgPSB2YWx1ZTtcclxuICAgICAgICBpZiAoRURJVE9SKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RyeUVuYWJsZUVkaXRvclByZXZpZXcoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgYmxvb21FbmFibGUoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldHRpbmdzLmJsb29tLmVuYWJsZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICBncm91cDogeyBpZDogJ0Jsb29tJywgbmFtZTogJ0Jsb29tIChQb3N0UHJvY2Vzc2luZyknLCBzdHlsZTogJ3NlY3Rpb24nIH0sXHJcbiAgICAgICAgdHlwZTogTWF0ZXJpYWwsXHJcbiAgICB9KVxyXG4gICAgc2V0IGJsb29tTWF0ZXJpYWwodmFsdWU6IE1hdGVyaWFsKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3NldHRpbmdzLmJsb29tLm1hdGVyaWFsID09PSB2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3NldHRpbmdzLmJsb29tLm1hdGVyaWFsID0gdmFsdWU7XHJcbiAgICAgICAgaWYgKEVESVRPUikge1xyXG4gICAgICAgICAgICB0aGlzLl90cnlFbmFibGVFZGl0b3JQcmV2aWV3KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IGJsb29tTWF0ZXJpYWwoKTogTWF0ZXJpYWwge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5ncy5ibG9vbS5tYXRlcmlhbCE7XHJcbiAgICB9XHJcblxyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICB0b29sdGlwOiAnaTE4bjpibG9vbS5lbmFibGVBbHBoYU1hc2snLFxyXG4gICAgICAgIGdyb3VwOiB7IGlkOiAnQmxvb20nLCBuYW1lOiAnQmxvb20gKFBvc3RQcm9jZXNzaW5nKScsIHN0eWxlOiAnc2VjdGlvbicgfSxcclxuICAgICAgICB0eXBlOiBDQ0Jvb2xlYW4sXHJcbiAgICB9KVxyXG4gICAgc2V0IGJsb29tRW5hYmxlQWxwaGFNYXNrKHZhbHVlOiBib29sZWFuKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MuYmxvb20uZW5hYmxlQWxwaGFNYXNrID0gdmFsdWU7XHJcbiAgICAgICAgaWYgKEVESVRPUikge1xyXG4gICAgICAgICAgICB0aGlzLl90cnlFbmFibGVFZGl0b3JQcmV2aWV3KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IGJsb29tRW5hYmxlQWxwaGFNYXNrKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5ncy5ibG9vbS5lbmFibGVBbHBoYU1hc2s7XHJcbiAgICB9XHJcblxyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICB0b29sdGlwOiAnaTE4bjpibG9vbS5pdGVyYXRpb25zJyxcclxuICAgICAgICBncm91cDogeyBpZDogJ0Jsb29tJywgbmFtZTogJ0Jsb29tIChQb3N0UHJvY2Vzc2luZyknLCBzdHlsZTogJ3NlY3Rpb24nIH0sXHJcbiAgICAgICAgdHlwZTogQ0NJbnRlZ2VyLFxyXG4gICAgICAgIHJhbmdlOiBbMSwgNiwgMV0sXHJcbiAgICAgICAgc2xpZGU6IHRydWUsXHJcbiAgICB9KVxyXG4gICAgc2V0IGJsb29tSXRlcmF0aW9ucyh2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MuYmxvb20uaXRlcmF0aW9ucyA9IHZhbHVlO1xyXG4gICAgICAgIGlmIChFRElUT1IpIHtcclxuICAgICAgICAgICAgdGhpcy5fdHJ5RW5hYmxlRWRpdG9yUHJldmlldygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBibG9vbUl0ZXJhdGlvbnMoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3MuYmxvb20uaXRlcmF0aW9ucztcclxuICAgIH1cclxuXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHRvb2x0aXA6ICdpMThuOmJsb29tLnRocmVzaG9sZCcsXHJcbiAgICAgICAgZ3JvdXA6IHsgaWQ6ICdCbG9vbScsIG5hbWU6ICdCbG9vbSAoUG9zdFByb2Nlc3NpbmcpJywgc3R5bGU6ICdzZWN0aW9uJyB9LFxyXG4gICAgICAgIHR5cGU6IENDRmxvYXQsXHJcbiAgICAgICAgbWluOiAwLFxyXG4gICAgfSlcclxuICAgIHNldCBibG9vbVRocmVzaG9sZCh2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MuYmxvb20udGhyZXNob2xkID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBnZXQgYmxvb21UaHJlc2hvbGQoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3MuYmxvb20udGhyZXNob2xkO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBibG9vbUludGVuc2l0eSh2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MuYmxvb20uaW50ZW5zaXR5ID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBnZXQgYmxvb21JbnRlbnNpdHkoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3MuYmxvb20uaW50ZW5zaXR5O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENvbG9yIEdyYWRpbmcgKExEUilcclxuICAgIEBwcm9wZXJ0eSh7XHJcbiAgICAgICAgZ3JvdXA6IHsgaWQ6ICdDb2xvciBHcmFkaW5nJywgbmFtZTogJ0NvbG9yR3JhZGluZyAoTERSKSAoUG9zdFByb2Nlc3NpbmcpJywgc3R5bGU6ICdzZWN0aW9uJyB9LFxyXG4gICAgICAgIHR5cGU6IENDQm9vbGVhbixcclxuICAgIH0pXHJcbiAgICBzZXQgY29sb3JHcmFkaW5nRW5hYmxlKHZhbHVlOiBib29sZWFuKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MuY29sb3JHcmFkaW5nLmVuYWJsZWQgPSB2YWx1ZTtcclxuICAgICAgICBpZiAoRURJVE9SKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RyeUVuYWJsZUVkaXRvclByZXZpZXcoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgY29sb3JHcmFkaW5nRW5hYmxlKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5ncy5jb2xvckdyYWRpbmcuZW5hYmxlZDtcclxuICAgIH1cclxuXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIGdyb3VwOiB7IGlkOiAnQ29sb3IgR3JhZGluZycsIG5hbWU6ICdDb2xvckdyYWRpbmcgKExEUikgKFBvc3RQcm9jZXNzaW5nKScsIHN0eWxlOiAnc2VjdGlvbicgfSxcclxuICAgICAgICB0eXBlOiBNYXRlcmlhbCxcclxuICAgIH0pXHJcbiAgICBzZXQgY29sb3JHcmFkaW5nTWF0ZXJpYWwodmFsdWU6IE1hdGVyaWFsKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3NldHRpbmdzLmNvbG9yR3JhZGluZy5tYXRlcmlhbCA9PT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zZXR0aW5ncy5jb2xvckdyYWRpbmcubWF0ZXJpYWwgPSB2YWx1ZTtcclxuICAgICAgICBpZiAoRURJVE9SKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RyeUVuYWJsZUVkaXRvclByZXZpZXcoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgY29sb3JHcmFkaW5nTWF0ZXJpYWwoKTogTWF0ZXJpYWwge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5ncy5jb2xvckdyYWRpbmcubWF0ZXJpYWwhO1xyXG4gICAgfVxyXG5cclxuICAgIEBwcm9wZXJ0eSh7XHJcbiAgICAgICAgdG9vbHRpcDogJ2kxOG46Y29sb3JfZ3JhZGluZy5jb250cmlidXRlJyxcclxuICAgICAgICBncm91cDogeyBpZDogJ0NvbG9yIEdyYWRpbmcnLCBuYW1lOiAnQ29sb3JHcmFkaW5nIChMRFIpIChQb3N0UHJvY2Vzc2luZyknLCBzdHlsZTogJ3NlY3Rpb24nIH0sXHJcbiAgICAgICAgdHlwZTogQ0NGbG9hdCxcclxuICAgICAgICByYW5nZTogWzAsIDEsIDAuMDFdLFxyXG4gICAgICAgIHNsaWRlOiB0cnVlLFxyXG4gICAgfSlcclxuICAgIHNldCBjb2xvckdyYWRpbmdDb250cmlidXRlKHZhbHVlOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLl9zZXR0aW5ncy5jb2xvckdyYWRpbmcuY29udHJpYnV0ZSA9IHZhbHVlO1xyXG4gICAgfVxyXG4gICAgZ2V0IGNvbG9yR3JhZGluZ0NvbnRyaWJ1dGUoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3MuY29sb3JHcmFkaW5nLmNvbnRyaWJ1dGU7XHJcbiAgICB9XHJcblxyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICB0b29sdGlwOiAnaTE4bjpjb2xvcl9ncmFkaW5nLm9yaWdpbmFsTWFwJyxcclxuICAgICAgICBncm91cDogeyBpZDogJ0NvbG9yIEdyYWRpbmcnLCBuYW1lOiAnQ29sb3JHcmFkaW5nIChMRFIpIChQb3N0UHJvY2Vzc2luZyknLCBzdHlsZTogJ3NlY3Rpb24nIH0sXHJcbiAgICAgICAgdHlwZTogVGV4dHVyZTJELFxyXG4gICAgfSlcclxuICAgIHNldCBjb2xvckdyYWRpbmdNYXAodmFsOiBUZXh0dXJlMkQpIHtcclxuICAgICAgICB0aGlzLl9zZXR0aW5ncy5jb2xvckdyYWRpbmcuY29sb3JHcmFkaW5nTWFwID0gdmFsO1xyXG4gICAgICAgIGlmIChFRElUT1IpIHtcclxuICAgICAgICAgICAgdGhpcy5fdHJ5RW5hYmxlRWRpdG9yUHJldmlldygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBjb2xvckdyYWRpbmdNYXAoKTogVGV4dHVyZTJEIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3MuY29sb3JHcmFkaW5nLmNvbG9yR3JhZGluZ01hcCE7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRlhBQVxyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICBncm91cDogeyBpZDogJ0ZYQUEnLCBuYW1lOiAnRmFzdCBBcHByb3hpbWF0ZSBBbnRpLUFsaWFzaW5nIChQb3N0UHJvY2Vzc2luZyknLCBzdHlsZTogJ3NlY3Rpb24nIH0sXHJcbiAgICAgICAgdHlwZTogQ0NCb29sZWFuLFxyXG4gICAgfSlcclxuICAgIHNldCBmeGFhRW5hYmxlKHZhbHVlOiBib29sZWFuKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MuZnhhYS5lbmFibGVkID0gdmFsdWU7XHJcbiAgICAgICAgaWYgKEVESVRPUikge1xyXG4gICAgICAgICAgICB0aGlzLl90cnlFbmFibGVFZGl0b3JQcmV2aWV3KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IGZ4YWFFbmFibGUoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldHRpbmdzLmZ4YWEuZW5hYmxlZDtcclxuICAgIH1cclxuXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIGdyb3VwOiB7IGlkOiAnRlhBQScsIG5hbWU6ICdGYXN0IEFwcHJveGltYXRlIEFudGktQWxpYXNpbmcgKFBvc3RQcm9jZXNzaW5nKScsIHN0eWxlOiAnc2VjdGlvbicgfSxcclxuICAgICAgICB0eXBlOiBNYXRlcmlhbCxcclxuICAgIH0pXHJcbiAgICBzZXQgZnhhYU1hdGVyaWFsKHZhbHVlOiBNYXRlcmlhbCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9zZXR0aW5ncy5meGFhLm1hdGVyaWFsID09PSB2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3NldHRpbmdzLmZ4YWEubWF0ZXJpYWwgPSB2YWx1ZTtcclxuICAgICAgICBpZiAoRURJVE9SKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RyeUVuYWJsZUVkaXRvclByZXZpZXcoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgZnhhYU1hdGVyaWFsKCk6IE1hdGVyaWFsIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3MuZnhhYS5tYXRlcmlhbCE7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRlNSXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIGdyb3VwOiB7IGlkOiAnRlNSJywgbmFtZTogJ0ZpZGVsaXR5RlggU3VwZXIgUmVzb2x1dGlvbicsIHN0eWxlOiAnc2VjdGlvbicgfSxcclxuICAgICAgICB0eXBlOiBDQ0Jvb2xlYW4sXHJcbiAgICB9KVxyXG4gICAgc2V0IGZzckVuYWJsZSh2YWx1ZTogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMuX3NldHRpbmdzLmZzci5lbmFibGVkID0gdmFsdWU7XHJcbiAgICAgICAgaWYgKEVESVRPUikge1xyXG4gICAgICAgICAgICB0aGlzLl90cnlFbmFibGVFZGl0b3JQcmV2aWV3KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IGZzckVuYWJsZSgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3MuZnNyLmVuYWJsZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICBncm91cDogeyBpZDogJ0ZTUicsIG5hbWU6ICdGaWRlbGl0eUZYIFN1cGVyIFJlc29sdXRpb24nLCBzdHlsZTogJ3NlY3Rpb24nIH0sXHJcbiAgICAgICAgdHlwZTogTWF0ZXJpYWwsXHJcbiAgICB9KVxyXG4gICAgc2V0IGZzck1hdGVyaWFsKHZhbHVlOiBNYXRlcmlhbCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9zZXR0aW5ncy5mc3IubWF0ZXJpYWwgPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MuZnNyLm1hdGVyaWFsID0gdmFsdWU7XHJcbiAgICAgICAgaWYgKEVESVRPUikge1xyXG4gICAgICAgICAgICB0aGlzLl90cnlFbmFibGVFZGl0b3JQcmV2aWV3KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0IGZzck1hdGVyaWFsKCk6IE1hdGVyaWFsIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3MuZnNyLm1hdGVyaWFsITtcclxuICAgIH1cclxuXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIGdyb3VwOiB7IGlkOiAnRlNSJywgbmFtZTogJ0ZpZGVsaXR5RlggU3VwZXIgUmVzb2x1dGlvbicsIHN0eWxlOiAnc2VjdGlvbicgfSxcclxuICAgICAgICB0eXBlOiBDQ0Zsb2F0LFxyXG4gICAgICAgIHJhbmdlOiBbMCwgMSwgMC4wMV0sXHJcbiAgICAgICAgc2xpZGU6IHRydWUsXHJcbiAgICB9KVxyXG4gICAgc2V0IGZzclNoYXJwbmVzcyh2YWx1ZTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MuZnNyLnNoYXJwbmVzcyA9IHZhbHVlO1xyXG4gICAgfVxyXG4gICAgZ2V0IGZzclNoYXJwbmVzcygpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5ncy5mc3Iuc2hhcnBuZXNzO1xyXG4gICAgfVxyXG5cclxuICAgIEBwcm9wZXJ0eSh7XHJcbiAgICAgICAgZ3JvdXA6IHsgaWQ6ICdUb25lTWFwcGluZycsIG5hbWU6ICdUb25lTWFwcGluZycsIHN0eWxlOiAnc2VjdGlvbicgfSxcclxuICAgICAgICB0eXBlOiBNYXRlcmlhbCxcclxuICAgIH0pXHJcbiAgICBzZXQgdG9uZU1hcHBpbmdNYXRlcmlhbCh2YWx1ZTogTWF0ZXJpYWwpIHtcclxuICAgICAgICBpZiAodGhpcy5fc2V0dGluZ3MudG9uZU1hcHBpbmcubWF0ZXJpYWwgPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MudG9uZU1hcHBpbmcubWF0ZXJpYWwgPSB2YWx1ZTtcclxuICAgICAgICBpZiAoRURJVE9SKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RyeUVuYWJsZUVkaXRvclByZXZpZXcoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXQgdG9uZU1hcHBpbmdNYXRlcmlhbCgpOiBNYXRlcmlhbCB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldHRpbmdzLnRvbmVNYXBwaW5nLm1hdGVyaWFsITtcclxuICAgIH1cclxufVxyXG4iLCIvKlxyXG4gQ29weXJpZ2h0IChjKSAyMDIxLTIwMjQgWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuXHJcblxyXG4gaHR0cHM6Ly93d3cuY29jb3MuY29tXHJcblxyXG4gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxyXG4gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxyXG4gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0b1xyXG4gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXNcclxuIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbyxcclxuIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG5cclxuIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXHJcbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cclxuIFRIRSBTT0ZUV0FSRS5cclxuKi9cclxuXHJcbi8qKlxyXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09ICFETyBOT1QgQ0hBTkdFIFRIRSBGT0xMT1dJTkcgU0VDVElPTiBNQU5VQUxMWSEgPT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gKiBUaGUgZm9sbG93aW5nIHNlY3Rpb24gaXMgYXV0by1nZW5lcmF0ZWQuXHJcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT0gIURPIE5PVCBDSEFOR0UgVEhFIEZPTExPV0lORyBTRUNUSU9OIE1BTlVBTExZISA9PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqL1xyXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtbGVuICovXHJcbmltcG9ydCB7IE1hdGVyaWFsLCBUZXh0dXJlMkQsIGdmeCB9IGZyb20gJ2NjJztcclxuXHJcbmNvbnN0IHsgU2FtcGxlQ291bnQgfSA9IGdmeDtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTVNBQSB7XHJcbiAgICBlbmFibGVkOiBib29sZWFuOyAvKiBmYWxzZSAqL1xyXG4gICAgc2FtcGxlQ291bnQ6IGdmeC5TYW1wbGVDb3VudDsgLyogU2FtcGxlQ291bnQuWDQgKi9cclxuICAgIFtuYW1lOiBzdHJpbmddOiB1bmtub3duO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbWFrZU1TQUEoKTogTVNBQSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgIHNhbXBsZUNvdW50OiBTYW1wbGVDb3VudC5YNCxcclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmaWxsUmVxdWlyZWRNU0FBKHZhbHVlOiBNU0FBKTogdm9pZCB7XHJcbiAgICBpZiAodmFsdWUuZW5hYmxlZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdmFsdWUuZW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgaWYgKHZhbHVlLnNhbXBsZUNvdW50ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZS5zYW1wbGVDb3VudCA9IFNhbXBsZUNvdW50Llg0O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEhCQU8ge1xyXG4gICAgZW5hYmxlZDogYm9vbGVhbjsgLyogZmFsc2UgKi9cclxuICAgIHJhZGl1c1NjYWxlOiBudW1iZXI7IC8qIDEgKi9cclxuICAgIGFuZ2xlQmlhc0RlZ3JlZTogbnVtYmVyOyAvKiAxMCAqL1xyXG4gICAgYmx1clNoYXJwbmVzczogbnVtYmVyOyAvKiAzICovXHJcbiAgICBhb1NhdHVyYXRpb246IG51bWJlcjsgLyogMSAqL1xyXG4gICAgbmVlZEJsdXI6IGJvb2xlYW47IC8qIGZhbHNlICovXHJcbiAgICBbbmFtZTogc3RyaW5nXTogdW5rbm93bjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VIQkFPKCk6IEhCQU8ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBlbmFibGVkOiBmYWxzZSxcclxuICAgICAgICByYWRpdXNTY2FsZTogMSxcclxuICAgICAgICBhbmdsZUJpYXNEZWdyZWU6IDEwLFxyXG4gICAgICAgIGJsdXJTaGFycG5lc3M6IDMsXHJcbiAgICAgICAgYW9TYXR1cmF0aW9uOiAxLFxyXG4gICAgICAgIG5lZWRCbHVyOiBmYWxzZSxcclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmaWxsUmVxdWlyZWRIQkFPKHZhbHVlOiBIQkFPKTogdm9pZCB7XHJcbiAgICBpZiAodmFsdWUuZW5hYmxlZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdmFsdWUuZW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgaWYgKHZhbHVlLnJhZGl1c1NjYWxlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZS5yYWRpdXNTY2FsZSA9IDE7XHJcbiAgICB9XHJcbiAgICBpZiAodmFsdWUuYW5nbGVCaWFzRGVncmVlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZS5hbmdsZUJpYXNEZWdyZWUgPSAxMDtcclxuICAgIH1cclxuICAgIGlmICh2YWx1ZS5ibHVyU2hhcnBuZXNzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZS5ibHVyU2hhcnBuZXNzID0gMztcclxuICAgIH1cclxuICAgIGlmICh2YWx1ZS5hb1NhdHVyYXRpb24gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhbHVlLmFvU2F0dXJhdGlvbiA9IDE7XHJcbiAgICB9XHJcbiAgICBpZiAodmFsdWUubmVlZEJsdXIgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhbHVlLm5lZWRCbHVyID0gZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQmxvb20ge1xyXG4gICAgZW5hYmxlZDogYm9vbGVhbjsgLyogZmFsc2UgKi9cclxuICAgIC8qIHJlZmNvdW50ICovIG1hdGVyaWFsOiBNYXRlcmlhbCB8IG51bGw7XHJcbiAgICBlbmFibGVBbHBoYU1hc2s6IGJvb2xlYW47IC8qIGZhbHNlICovXHJcbiAgICBpdGVyYXRpb25zOiBudW1iZXI7IC8qIDMgKi9cclxuICAgIHRocmVzaG9sZDogbnVtYmVyOyAvKiAwLjggKi9cclxuICAgIGludGVuc2l0eTogbnVtYmVyOyAvKiAyLjMgKi9cclxuICAgIFtuYW1lOiBzdHJpbmddOiB1bmtub3duO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbWFrZUJsb29tKCk6IEJsb29tIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZW5hYmxlZDogZmFsc2UsXHJcbiAgICAgICAgbWF0ZXJpYWw6IG51bGwsXHJcbiAgICAgICAgZW5hYmxlQWxwaGFNYXNrOiBmYWxzZSxcclxuICAgICAgICBpdGVyYXRpb25zOiAzLFxyXG4gICAgICAgIHRocmVzaG9sZDogMC44LFxyXG4gICAgICAgIGludGVuc2l0eTogMi4zLFxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZpbGxSZXF1aXJlZEJsb29tKHZhbHVlOiBCbG9vbSk6IHZvaWQge1xyXG4gICAgaWYgKHZhbHVlLmVuYWJsZWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhbHVlLmVuYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIGlmICh2YWx1ZS5tYXRlcmlhbCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdmFsdWUubWF0ZXJpYWwgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgaWYgKHZhbHVlLmVuYWJsZUFscGhhTWFzayA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdmFsdWUuZW5hYmxlQWxwaGFNYXNrID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBpZiAodmFsdWUuaXRlcmF0aW9ucyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdmFsdWUuaXRlcmF0aW9ucyA9IDM7XHJcbiAgICB9XHJcbiAgICBpZiAodmFsdWUudGhyZXNob2xkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZS50aHJlc2hvbGQgPSAwLjg7XHJcbiAgICB9XHJcbiAgICBpZiAodmFsdWUuaW50ZW5zaXR5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZS5pbnRlbnNpdHkgPSAyLjM7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ29sb3JHcmFkaW5nIHtcclxuICAgIGVuYWJsZWQ6IGJvb2xlYW47IC8qIGZhbHNlICovXHJcbiAgICAvKiByZWZjb3VudCAqLyBtYXRlcmlhbDogTWF0ZXJpYWwgfCBudWxsO1xyXG4gICAgY29udHJpYnV0ZTogbnVtYmVyOyAvKiAxICovXHJcbiAgICAvKiByZWZjb3VudCAqLyBjb2xvckdyYWRpbmdNYXA6IFRleHR1cmUyRCB8IG51bGw7XHJcbiAgICBbbmFtZTogc3RyaW5nXTogdW5rbm93bjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VDb2xvckdyYWRpbmcoKTogQ29sb3JHcmFkaW5nIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZW5hYmxlZDogZmFsc2UsXHJcbiAgICAgICAgbWF0ZXJpYWw6IG51bGwsXHJcbiAgICAgICAgY29udHJpYnV0ZTogMSxcclxuICAgICAgICBjb2xvckdyYWRpbmdNYXA6IG51bGwsXHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZmlsbFJlcXVpcmVkQ29sb3JHcmFkaW5nKHZhbHVlOiBDb2xvckdyYWRpbmcpOiB2b2lkIHtcclxuICAgIGlmICh2YWx1ZS5lbmFibGVkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZS5lbmFibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBpZiAodmFsdWUubWF0ZXJpYWwgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhbHVlLm1hdGVyaWFsID0gbnVsbDtcclxuICAgIH1cclxuICAgIGlmICh2YWx1ZS5jb250cmlidXRlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZS5jb250cmlidXRlID0gMTtcclxuICAgIH1cclxuICAgIGlmICh2YWx1ZS5jb2xvckdyYWRpbmdNYXAgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhbHVlLmNvbG9yR3JhZGluZ01hcCA9IG51bGw7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRlNSIHtcclxuICAgIGVuYWJsZWQ6IGJvb2xlYW47IC8qIGZhbHNlICovXHJcbiAgICAvKiByZWZjb3VudCAqLyBtYXRlcmlhbDogTWF0ZXJpYWwgfCBudWxsO1xyXG4gICAgc2hhcnBuZXNzOiBudW1iZXI7IC8qIDAuOCAqL1xyXG4gICAgW25hbWU6IHN0cmluZ106IHVua25vd247XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtYWtlRlNSKCk6IEZTUiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgIG1hdGVyaWFsOiBudWxsLFxyXG4gICAgICAgIHNoYXJwbmVzczogMC44LFxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZpbGxSZXF1aXJlZEZTUih2YWx1ZTogRlNSKTogdm9pZCB7XHJcbiAgICBpZiAodmFsdWUuZW5hYmxlZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdmFsdWUuZW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgaWYgKHZhbHVlLm1hdGVyaWFsID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZS5tYXRlcmlhbCA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBpZiAodmFsdWUuc2hhcnBuZXNzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZS5zaGFycG5lc3MgPSAwLjg7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRlhBQSB7XHJcbiAgICBlbmFibGVkOiBib29sZWFuOyAvKiBmYWxzZSAqL1xyXG4gICAgLyogcmVmY291bnQgKi8gbWF0ZXJpYWw6IE1hdGVyaWFsIHwgbnVsbDtcclxuICAgIFtuYW1lOiBzdHJpbmddOiB1bmtub3duO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbWFrZUZYQUEoKTogRlhBQSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgIG1hdGVyaWFsOiBudWxsLFxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZpbGxSZXF1aXJlZEZYQUEodmFsdWU6IEZYQUEpOiB2b2lkIHtcclxuICAgIGlmICh2YWx1ZS5lbmFibGVkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZS5lbmFibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBpZiAodmFsdWUubWF0ZXJpYWwgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhbHVlLm1hdGVyaWFsID0gbnVsbDtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBUb25lTWFwcGluZyB7XHJcbiAgICAvKiByZWZjb3VudCAqLyBtYXRlcmlhbDogTWF0ZXJpYWwgfCBudWxsO1xyXG4gICAgW25hbWU6IHN0cmluZ106IHVua25vd247XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtYWtlVG9uZU1hcHBpbmcoKTogVG9uZU1hcHBpbmcge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBtYXRlcmlhbDogbnVsbCxcclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmaWxsUmVxdWlyZWRUb25lTWFwcGluZyh2YWx1ZTogVG9uZU1hcHBpbmcpOiB2b2lkIHtcclxuICAgIGlmICh2YWx1ZS5tYXRlcmlhbCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdmFsdWUubWF0ZXJpYWwgPSBudWxsO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFBpcGVsaW5lU2V0dGluZ3Mge1xyXG4gICAgcmVhZG9ubHkgbXNhYTogTVNBQTtcclxuICAgIGVuYWJsZVNoYWRpbmdTY2FsZTogYm9vbGVhbjsgLyogZmFsc2UgKi9cclxuICAgIHNoYWRpbmdTY2FsZTogbnVtYmVyOyAvKiAwLjUgKi9cclxuICAgIHJlYWRvbmx5IGJsb29tOiBCbG9vbTtcclxuICAgIHJlYWRvbmx5IHRvbmVNYXBwaW5nOiBUb25lTWFwcGluZztcclxuICAgIHJlYWRvbmx5IGNvbG9yR3JhZGluZzogQ29sb3JHcmFkaW5nO1xyXG4gICAgcmVhZG9ubHkgZnNyOiBGU1I7XHJcbiAgICByZWFkb25seSBmeGFhOiBGWEFBO1xyXG4gICAgW25hbWU6IHN0cmluZ106IHVua25vd247XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtYWtlUGlwZWxpbmVTZXR0aW5ncygpOiBQaXBlbGluZVNldHRpbmdzIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbXNhYTogbWFrZU1TQUEoKSxcclxuICAgICAgICBlbmFibGVTaGFkaW5nU2NhbGU6IGZhbHNlLFxyXG4gICAgICAgIHNoYWRpbmdTY2FsZTogMC41LFxyXG4gICAgICAgIGJsb29tOiBtYWtlQmxvb20oKSxcclxuICAgICAgICB0b25lTWFwcGluZzogbWFrZVRvbmVNYXBwaW5nKCksXHJcbiAgICAgICAgY29sb3JHcmFkaW5nOiBtYWtlQ29sb3JHcmFkaW5nKCksXHJcbiAgICAgICAgZnNyOiBtYWtlRlNSKCksXHJcbiAgICAgICAgZnhhYTogbWFrZUZYQUEoKSxcclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmaWxsUmVxdWlyZWRQaXBlbGluZVNldHRpbmdzKHZhbHVlOiBQaXBlbGluZVNldHRpbmdzKTogdm9pZCB7XHJcbiAgICBpZiAoIXZhbHVlLm1zYWEpIHtcclxuICAgICAgICAodmFsdWUubXNhYSBhcyBNU0FBKSA9IG1ha2VNU0FBKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZpbGxSZXF1aXJlZE1TQUEodmFsdWUubXNhYSk7XHJcbiAgICB9XHJcbiAgICBpZiAodmFsdWUuZW5hYmxlU2hhZGluZ1NjYWxlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWx1ZS5lbmFibGVTaGFkaW5nU2NhbGUgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIGlmICh2YWx1ZS5zaGFkaW5nU2NhbGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhbHVlLnNoYWRpbmdTY2FsZSA9IDAuNTtcclxuICAgIH1cclxuICAgIGlmICghdmFsdWUuYmxvb20pIHtcclxuICAgICAgICAodmFsdWUuYmxvb20gYXMgQmxvb20pID0gbWFrZUJsb29tKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZpbGxSZXF1aXJlZEJsb29tKHZhbHVlLmJsb29tKTtcclxuICAgIH1cclxuICAgIGlmICghdmFsdWUudG9uZU1hcHBpbmcpIHtcclxuICAgICAgICAodmFsdWUudG9uZU1hcHBpbmcgYXMgVG9uZU1hcHBpbmcpID0gbWFrZVRvbmVNYXBwaW5nKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZpbGxSZXF1aXJlZFRvbmVNYXBwaW5nKHZhbHVlLnRvbmVNYXBwaW5nKTtcclxuICAgIH1cclxuICAgIGlmICghdmFsdWUuY29sb3JHcmFkaW5nKSB7XHJcbiAgICAgICAgKHZhbHVlLmNvbG9yR3JhZGluZyBhcyBDb2xvckdyYWRpbmcpID0gbWFrZUNvbG9yR3JhZGluZygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBmaWxsUmVxdWlyZWRDb2xvckdyYWRpbmcodmFsdWUuY29sb3JHcmFkaW5nKTtcclxuICAgIH1cclxuICAgIGlmICghdmFsdWUuZnNyKSB7XHJcbiAgICAgICAgKHZhbHVlLmZzciBhcyBGU1IpID0gbWFrZUZTUigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBmaWxsUmVxdWlyZWRGU1IodmFsdWUuZnNyKTtcclxuICAgIH1cclxuICAgIGlmICghdmFsdWUuZnhhYSkge1xyXG4gICAgICAgICh2YWx1ZS5meGFhIGFzIEZYQUEpID0gbWFrZUZYQUEoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZmlsbFJlcXVpcmVkRlhBQSh2YWx1ZS5meGFhKTtcclxuICAgIH1cclxufVxyXG4iLCIvKlxyXG4gQ29weXJpZ2h0IChjKSAyMDIxLTIwMjQgWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuXHJcblxyXG4gaHR0cHM6Ly93d3cuY29jb3MuY29tL1xyXG5cclxuIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcclxuIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcclxuIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG9cclxuIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzXHJcbiBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sXHJcbiBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcclxuXHJcbiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxyXG4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXHJcblxyXG4gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXHJcbiBUSEUgU09GVFdBUkUuXHJcbiovXHJcblxyXG5pbXBvcnQge1xyXG4gICAgYXNzZXJ0LCBjY2xlZ2FjeSwgY2xhbXAsIGdlb21ldHJ5LCBnZngsIExheWVycywgTWF0ZXJpYWwsIHBpcGVsaW5lLFxyXG4gICAgUGlwZWxpbmVFdmVudFByb2Nlc3NvciwgUGlwZWxpbmVFdmVudFR5cGUsIFJlZmxlY3Rpb25Qcm9iZU1hbmFnZXIsIHJlbmRlcmVyLFxyXG4gICAgcmVuZGVyaW5nLCBzeXMsIFZlYzIsIFZlYzMsIFZlYzQsIHdhcm4sXHJcbn0gZnJvbSAnY2MnO1xyXG5cclxuaW1wb3J0IHsgREVCVUcsIEVESVRPUiB9IGZyb20gJ2NjL2Vudic7XHJcblxyXG5pbXBvcnQge1xyXG4gICAgbWFrZVBpcGVsaW5lU2V0dGluZ3MsXHJcbiAgICBQaXBlbGluZVNldHRpbmdzLFxyXG59IGZyb20gJy4vYnVpbHRpbi1waXBlbGluZS10eXBlcyc7XHJcblxyXG5jb25zdCB7IEFBQkIsIFNwaGVyZSwgaW50ZXJzZWN0IH0gPSBnZW9tZXRyeTtcclxuY29uc3QgeyBDbGVhckZsYWdCaXQsIENvbG9yLCBGb3JtYXQsIEZvcm1hdEZlYXR1cmVCaXQsIExvYWRPcCwgU3RvcmVPcCwgVGV4dHVyZVR5cGUsIFZpZXdwb3J0IH0gPSBnZng7XHJcbmNvbnN0IHsgc2NlbmUgfSA9IHJlbmRlcmVyO1xyXG5jb25zdCB7IENhbWVyYVVzYWdlLCBDU01MZXZlbCwgTGlnaHRUeXBlIH0gPSBzY2VuZTtcclxuXHJcbmZ1bmN0aW9uIGZvcndhcmROZWVkQ2xlYXJDb2xvcihjYW1lcmE6IHJlbmRlcmVyLnNjZW5lLkNhbWVyYSk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuICEhKGNhbWVyYS5jbGVhckZsYWcgJiAoQ2xlYXJGbGFnQml0LkNPTE9SIHwgKENsZWFyRmxhZ0JpdC5TVEVOQ0lMIDw8IDEpKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldENzbU1haW5MaWdodFZpZXdwb3J0KFxyXG4gICAgbGlnaHQ6IHJlbmRlcmVyLnNjZW5lLkRpcmVjdGlvbmFsTGlnaHQsXHJcbiAgICB3OiBudW1iZXIsXHJcbiAgICBoOiBudW1iZXIsXHJcbiAgICBsZXZlbDogbnVtYmVyLFxyXG4gICAgdnA6IGdmeC5WaWV3cG9ydCxcclxuICAgIHNjcmVlblNwYWNlU2lnblk6IG51bWJlcixcclxuKTogdm9pZCB7XHJcbiAgICBpZiAobGlnaHQuc2hhZG93Rml4ZWRBcmVhIHx8IGxpZ2h0LmNzbUxldmVsID09PSBDU01MZXZlbC5MRVZFTF8xKSB7XHJcbiAgICAgICAgdnAubGVmdCA9IDA7XHJcbiAgICAgICAgdnAudG9wID0gMDtcclxuICAgICAgICB2cC53aWR0aCA9IE1hdGgudHJ1bmModyk7XHJcbiAgICAgICAgdnAuaGVpZ2h0ID0gTWF0aC50cnVuYyhoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdnAubGVmdCA9IE1hdGgudHJ1bmMobGV2ZWwgJSAyICogMC41ICogdyk7XHJcbiAgICAgICAgaWYgKHNjcmVlblNwYWNlU2lnblkgPiAwKSB7XHJcbiAgICAgICAgICAgIHZwLnRvcCA9IE1hdGgudHJ1bmMoKDEgLSBNYXRoLmZsb29yKGxldmVsIC8gMikpICogMC41ICogaCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdnAudG9wID0gTWF0aC50cnVuYyhNYXRoLmZsb29yKGxldmVsIC8gMikgKiAwLjUgKiBoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdnAud2lkdGggPSBNYXRoLnRydW5jKDAuNSAqIHcpO1xyXG4gICAgICAgIHZwLmhlaWdodCA9IE1hdGgudHJ1bmMoMC41ICogaCk7XHJcbiAgICB9XHJcbiAgICB2cC5sZWZ0ID0gTWF0aC5tYXgoMCwgdnAubGVmdCk7XHJcbiAgICB2cC50b3AgPSBNYXRoLm1heCgwLCB2cC50b3ApO1xyXG4gICAgdnAud2lkdGggPSBNYXRoLm1heCgxLCB2cC53aWR0aCk7XHJcbiAgICB2cC5oZWlnaHQgPSBNYXRoLm1heCgxLCB2cC5oZWlnaHQpO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgUGlwZWxpbmVDb25maWdzIHtcclxuICAgIGlzV2ViID0gZmFsc2U7XHJcbiAgICBpc1dlYkdMMSA9IGZhbHNlO1xyXG4gICAgaXNXZWJHUFUgPSBmYWxzZTtcclxuICAgIGlzTW9iaWxlID0gZmFsc2U7XHJcbiAgICBpc0hEUiA9IGZhbHNlO1xyXG4gICAgdXNlRmxvYXRPdXRwdXQgPSBmYWxzZTtcclxuICAgIHRvbmVNYXBwaW5nVHlwZSA9IDA7IC8vIDA6IEFDRVMsIDE6IE5vbmVcclxuICAgIHNoYWRvd0VuYWJsZWQgPSBmYWxzZTtcclxuICAgIHNoYWRvd01hcEZvcm1hdCA9IEZvcm1hdC5SMzJGO1xyXG4gICAgc2hhZG93TWFwU2l6ZSA9IG5ldyBWZWMyKDEsIDEpO1xyXG4gICAgdXNlUGxhbmFyU2hhZG93ID0gZmFsc2U7XHJcbiAgICBzY3JlZW5TcGFjZVNpZ25ZID0gMTtcclxuICAgIHN1cHBvcnREZXB0aFNhbXBsZSA9IGZhbHNlO1xyXG4gICAgbW9iaWxlTWF4U3BvdExpZ2h0U2hhZG93TWFwcyA9IDE7XHJcblxyXG4gICAgcGxhdGZvcm0gPSBuZXcgVmVjNCgwLCAwLCAwLCAwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0dXBQaXBlbGluZUNvbmZpZ3MoXHJcbiAgICBwcGw6IHJlbmRlcmluZy5CYXNpY1BpcGVsaW5lLFxyXG4gICAgY29uZmlnczogUGlwZWxpbmVDb25maWdzLFxyXG4pOiB2b2lkIHtcclxuICAgIGNvbnN0IHNhbXBsZUZlYXR1cmUgPSBGb3JtYXRGZWF0dXJlQml0LlNBTVBMRURfVEVYVFVSRSB8IEZvcm1hdEZlYXR1cmVCaXQuTElORUFSX0ZJTFRFUjtcclxuICAgIGNvbnN0IGRldmljZSA9IHBwbC5kZXZpY2U7XHJcbiAgICAvLyBQbGF0Zm9ybVxyXG4gICAgY29uZmlncy5pc1dlYiA9ICFzeXMuaXNOYXRpdmU7XHJcbiAgICBjb25maWdzLmlzV2ViR0wxID0gZGV2aWNlLmdmeEFQSSA9PT0gZ2Z4LkFQSS5XRUJHTDtcclxuICAgIGNvbmZpZ3MuaXNXZWJHUFUgPSBkZXZpY2UuZ2Z4QVBJID09PSBnZnguQVBJLldFQkdQVTtcclxuICAgIGNvbmZpZ3MuaXNNb2JpbGUgPSBzeXMuaXNNb2JpbGU7XHJcblxyXG4gICAgLy8gUmVuZGVyaW5nXHJcbiAgICBjb25maWdzLmlzSERSID0gcHBsLnBpcGVsaW5lU2NlbmVEYXRhLmlzSERSOyAvLyBIYXMgdG9uZSBtYXBwaW5nXHJcbiAgICBjb25maWdzLnVzZUZsb2F0T3V0cHV0ID0gcHBsLmdldE1hY3JvQm9vbCgnQ0NfVVNFX0ZMT0FUX09VVFBVVCcpO1xyXG4gICAgY29uZmlncy50b25lTWFwcGluZ1R5cGUgPSBwcGwucGlwZWxpbmVTY2VuZURhdGEucG9zdFNldHRpbmdzLnRvbmVNYXBwaW5nVHlwZTtcclxuICAgIC8vIFNoYWRvd1xyXG4gICAgY29uc3Qgc2hhZG93SW5mbyA9IHBwbC5waXBlbGluZVNjZW5lRGF0YS5zaGFkb3dzO1xyXG4gICAgY29uZmlncy5zaGFkb3dFbmFibGVkID0gc2hhZG93SW5mby5lbmFibGVkO1xyXG4gICAgY29uZmlncy5zaGFkb3dNYXBGb3JtYXQgPSBwaXBlbGluZS5zdXBwb3J0c1IzMkZsb2F0VGV4dHVyZShwcGwuZGV2aWNlKSA/IEZvcm1hdC5SMzJGIDogRm9ybWF0LlJHQkE4O1xyXG4gICAgY29uZmlncy5zaGFkb3dNYXBTaXplLnNldChzaGFkb3dJbmZvLnNpemUpO1xyXG4gICAgY29uZmlncy51c2VQbGFuYXJTaGFkb3cgPSBzaGFkb3dJbmZvLmVuYWJsZWQgJiYgc2hhZG93SW5mby50eXBlID09PSByZW5kZXJlci5zY2VuZS5TaGFkb3dUeXBlLlBsYW5hcjtcclxuICAgIC8vIERldmljZVxyXG4gICAgY29uZmlncy5zY3JlZW5TcGFjZVNpZ25ZID0gcHBsLmRldmljZS5jYXBhYmlsaXRpZXMuc2NyZWVuU3BhY2VTaWduWTtcclxuICAgIGNvbmZpZ3Muc3VwcG9ydERlcHRoU2FtcGxlID0gKHBwbC5kZXZpY2UuZ2V0Rm9ybWF0RmVhdHVyZXMoRm9ybWF0LkRFUFRIX1NURU5DSUwpICYgc2FtcGxlRmVhdHVyZSkgPT09IHNhbXBsZUZlYXR1cmU7XHJcbiAgICAvLyBDb25zdGFudHNcclxuICAgIGNvbnN0IHNjcmVlblNwYWNlU2lnblkgPSBkZXZpY2UuY2FwYWJpbGl0aWVzLnNjcmVlblNwYWNlU2lnblk7XHJcbiAgICBjb25maWdzLnBsYXRmb3JtLnggPSBjb25maWdzLmlzTW9iaWxlID8gMS4wIDogMC4wO1xyXG4gICAgY29uZmlncy5wbGF0Zm9ybS53ID0gKHNjcmVlblNwYWNlU2lnblkgKiAwLjUgKyAwLjUpIDw8IDEgfCAoZGV2aWNlLmNhcGFiaWxpdGllcy5jbGlwU3BhY2VTaWduWSAqIDAuNSArIDAuNSk7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUGlwZWxpbmVTZXR0aW5nczIgZXh0ZW5kcyBQaXBlbGluZVNldHRpbmdzIHtcclxuICAgIF9wYXNzZXM/OiByZW5kZXJpbmcuUGlwZWxpbmVQYXNzQnVpbGRlcltdO1xyXG59XHJcblxyXG5jb25zdCBkZWZhdWx0U2V0dGluZ3MgPSBtYWtlUGlwZWxpbmVTZXR0aW5ncygpO1xyXG5cclxuZXhwb3J0IGNsYXNzIENhbWVyYUNvbmZpZ3Mge1xyXG4gICAgc2V0dGluZ3M6IFBpcGVsaW5lU2V0dGluZ3MgPSBkZWZhdWx0U2V0dGluZ3M7XHJcbiAgICAvLyBXaW5kb3dcclxuICAgIGlzTWFpbkdhbWVXaW5kb3cgPSBmYWxzZTtcclxuICAgIHJlbmRlcldpbmRvd0lkID0gMDtcclxuICAgIC8vIENhbWVyYVxyXG4gICAgY29sb3JOYW1lID0gJyc7XHJcbiAgICBkZXB0aFN0ZW5jaWxOYW1lID0gJyc7XHJcbiAgICAvLyBQaXBlbGluZVxyXG4gICAgZW5hYmxlRnVsbFBpcGVsaW5lID0gZmFsc2U7XHJcbiAgICBlbmFibGVQcm9maWxlciA9IGZhbHNlO1xyXG4gICAgcmVtYWluaW5nUGFzc2VzID0gMDtcclxuICAgIC8vIFNoYWRpbmcgU2NhbGVcclxuICAgIGVuYWJsZVNoYWRpbmdTY2FsZSA9IGZhbHNlO1xyXG4gICAgc2hhZGluZ1NjYWxlID0gMS4wO1xyXG4gICAgbmF0aXZlV2lkdGggPSAxO1xyXG4gICAgbmF0aXZlSGVpZ2h0ID0gMTtcclxuICAgIHdpZHRoID0gMTsgLy8gU2NhbGVkIHdpZHRoXHJcbiAgICBoZWlnaHQgPSAxOyAvLyBTY2FsZWQgaGVpZ2h0XHJcbiAgICAvLyBSYWRpYW5jZVxyXG4gICAgZW5hYmxlSERSID0gZmFsc2U7XHJcbiAgICByYWRpYW5jZUZvcm1hdCA9IGdmeC5Gb3JtYXQuUkdCQTg7XHJcbiAgICAvLyBUb25lIE1hcHBpbmdcclxuICAgIGNvcHlBbmRUb25lbWFwTWF0ZXJpYWw6IE1hdGVyaWFsIHwgbnVsbCA9IG51bGw7XHJcbiAgICAvLyBEZXB0aFxyXG4gICAgLyoqIEBlbiBtdXRhYmxlICovXHJcbiAgICBlbmFibGVTdG9yZVNjZW5lRGVwdGggPSBmYWxzZTtcclxufVxyXG5cclxuY29uc3Qgc0NsZWFyQ29sb3JUcmFuc3BhcmVudEJsYWNrID0gbmV3IENvbG9yKDAsIDAsIDAsIDApO1xyXG5cclxuZnVuY3Rpb24gc29ydFBpcGVsaW5lUGFzc0J1aWxkZXJzQnlDb25maWdPcmRlcihwYXNzQnVpbGRlcnM6IHJlbmRlcmluZy5QaXBlbGluZVBhc3NCdWlsZGVyW10pOiB2b2lkIHtcclxuICAgIHBhc3NCdWlsZGVycy5zb3J0KChhLCBiKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGEuZ2V0Q29uZmlnT3JkZXIoKSAtIGIuZ2V0Q29uZmlnT3JkZXIoKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzb3J0UGlwZWxpbmVQYXNzQnVpbGRlcnNCeVJlbmRlck9yZGVyKHBhc3NCdWlsZGVyczogcmVuZGVyaW5nLlBpcGVsaW5lUGFzc0J1aWxkZXJbXSk6IHZvaWQge1xyXG4gICAgcGFzc0J1aWxkZXJzLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgICByZXR1cm4gYS5nZXRSZW5kZXJPcmRlcigpIC0gYi5nZXRSZW5kZXJPcmRlcigpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZENvcHlUb1NjcmVlblBhc3MoXHJcbiAgICBwcGw6IHJlbmRlcmluZy5CYXNpY1BpcGVsaW5lLFxyXG4gICAgcHBsQ29uZmlnczogUmVhZG9ubHk8UGlwZWxpbmVDb25maWdzPixcclxuICAgIGNhbWVyYUNvbmZpZ3M6IENhbWVyYUNvbmZpZ3MsXHJcbiAgICBpbnB1dDogc3RyaW5nLFxyXG4pOiByZW5kZXJpbmcuQmFzaWNSZW5kZXJQYXNzQnVpbGRlciB7XHJcbiAgICBhc3NlcnQoISFjYW1lcmFDb25maWdzLmNvcHlBbmRUb25lbWFwTWF0ZXJpYWwpO1xyXG4gICAgY29uc3QgcGFzcyA9IHBwbC5hZGRSZW5kZXJQYXNzKFxyXG4gICAgICAgIGNhbWVyYUNvbmZpZ3MubmF0aXZlV2lkdGgsXHJcbiAgICAgICAgY2FtZXJhQ29uZmlncy5uYXRpdmVIZWlnaHQsXHJcbiAgICAgICAgJ2NjLXRvbmUtbWFwcGluZycpO1xyXG4gICAgcGFzcy5hZGRSZW5kZXJUYXJnZXQoXHJcbiAgICAgICAgY2FtZXJhQ29uZmlncy5jb2xvck5hbWUsXHJcbiAgICAgICAgTG9hZE9wLkNMRUFSLCBTdG9yZU9wLlNUT1JFLFxyXG4gICAgICAgIHNDbGVhckNvbG9yVHJhbnNwYXJlbnRCbGFjayk7XHJcbiAgICBwYXNzLmFkZFRleHR1cmUoaW5wdXQsICdpbnB1dFRleHR1cmUnKTtcclxuICAgIHBhc3Muc2V0VmVjNCgnZ19wbGF0Zm9ybScsIHBwbENvbmZpZ3MucGxhdGZvcm0pO1xyXG4gICAgcGFzcy5hZGRRdWV1ZShyZW5kZXJpbmcuUXVldWVIaW50Lk9QQVFVRSlcclxuICAgICAgICAuYWRkRnVsbHNjcmVlblF1YWQoY2FtZXJhQ29uZmlncy5jb3B5QW5kVG9uZW1hcE1hdGVyaWFsLCAxKTtcclxuICAgIHJldHVybiBwYXNzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGluZ1BvbmdSZW5kZXJUYXJnZXQocHJldk5hbWU6IHN0cmluZywgcHJlZml4OiBzdHJpbmcsIGlkOiBudW1iZXIpOiBzdHJpbmcge1xyXG4gICAgaWYgKHByZXZOYW1lLnN0YXJ0c1dpdGgocHJlZml4KSkge1xyXG4gICAgICAgIHJldHVybiBgJHtwcmVmaXh9JHsxIC0gTnVtYmVyKHByZXZOYW1lLmNoYXJBdChwcmVmaXgubGVuZ3RoKSl9XyR7aWR9YDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGAke3ByZWZpeH0wXyR7aWR9YDtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBQaXBlbGluZUNvbnRleHQge1xyXG4gICAgY29sb3JOYW1lOiBzdHJpbmc7XHJcbiAgICBkZXB0aFN0ZW5jaWxOYW1lOiBzdHJpbmc7XHJcbn1cclxuXHJcbmNsYXNzIEZvcndhcmRMaWdodGluZyB7XHJcbiAgICAvLyBBY3RpdmUgbGlnaHRzXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGxpZ2h0czogcmVuZGVyZXIuc2NlbmUuTGlnaHRbXSA9IFtdO1xyXG4gICAgLy8gQWN0aXZlIHNwb3QgbGlnaHRzIHdpdGggc2hhZG93cyAoTXV0dWFsbHkgZXhjbHVzaXZlIHdpdGggYGxpZ2h0c2ApXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IHNoYWRvd0VuYWJsZWRTcG90TGlnaHRzOiByZW5kZXJlci5zY2VuZS5TcG90TGlnaHRbXSA9IFtdO1xyXG5cclxuICAgIC8vIEludGVybmFsIGNhY2hlZCByZXNvdXJjZXNcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX3NwaGVyZSA9IFNwaGVyZS5jcmVhdGUoMCwgMCwgMCwgMSk7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9ib3VuZGluZ0JveCA9IG5ldyBBQUJCKCk7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9yYW5nZWREaXJMaWdodEJvdW5kaW5nQm94ID0gbmV3IEFBQkIoMC4wLCAwLjAsIDAuMCwgMC41LCAwLjUsIDAuNSk7XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gSW50ZXJmYWNlXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICBwdWJsaWMgY3VsbExpZ2h0cyhzY2VuZTogcmVuZGVyZXIuUmVuZGVyU2NlbmUsIGZydXN0dW06IGdlb21ldHJ5LkZydXN0dW0sIGNhbWVyYVBvcz86IFZlYzMpOiB2b2lkIHtcclxuICAgICAgICAvLyBUT0RPKHpob3V6aGVuZ2xvbmcpOiBNYWtlIGxpZ2h0IGN1bGxpbmcgbmF0aXZlXHJcbiAgICAgICAgdGhpcy5saWdodHMubGVuZ3RoID0gMDtcclxuICAgICAgICB0aGlzLnNoYWRvd0VuYWJsZWRTcG90TGlnaHRzLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgLy8gc3BvdCBsaWdodHNcclxuICAgICAgICBmb3IgKGNvbnN0IGxpZ2h0IG9mIHNjZW5lLnNwb3RMaWdodHMpIHtcclxuICAgICAgICAgICAgaWYgKGxpZ2h0LmJha2VkKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBTcGhlcmUuc2V0KHRoaXMuX3NwaGVyZSwgbGlnaHQucG9zaXRpb24ueCwgbGlnaHQucG9zaXRpb24ueSwgbGlnaHQucG9zaXRpb24ueiwgbGlnaHQucmFuZ2UpO1xyXG4gICAgICAgICAgICBpZiAoaW50ZXJzZWN0LnNwaGVyZUZydXN0dW0odGhpcy5fc3BoZXJlLCBmcnVzdHVtKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGxpZ2h0LnNoYWRvd0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYWRvd0VuYWJsZWRTcG90TGlnaHRzLnB1c2gobGlnaHQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpZ2h0cy5wdXNoKGxpZ2h0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBzcGhlcmUgbGlnaHRzXHJcbiAgICAgICAgZm9yIChjb25zdCBsaWdodCBvZiBzY2VuZS5zcGhlcmVMaWdodHMpIHtcclxuICAgICAgICAgICAgaWYgKGxpZ2h0LmJha2VkKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBTcGhlcmUuc2V0KHRoaXMuX3NwaGVyZSwgbGlnaHQucG9zaXRpb24ueCwgbGlnaHQucG9zaXRpb24ueSwgbGlnaHQucG9zaXRpb24ueiwgbGlnaHQucmFuZ2UpO1xyXG4gICAgICAgICAgICBpZiAoaW50ZXJzZWN0LnNwaGVyZUZydXN0dW0odGhpcy5fc3BoZXJlLCBmcnVzdHVtKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saWdodHMucHVzaChsaWdodCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gcG9pbnQgbGlnaHRzXHJcbiAgICAgICAgZm9yIChjb25zdCBsaWdodCBvZiBzY2VuZS5wb2ludExpZ2h0cykge1xyXG4gICAgICAgICAgICBpZiAobGlnaHQuYmFrZWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFNwaGVyZS5zZXQodGhpcy5fc3BoZXJlLCBsaWdodC5wb3NpdGlvbi54LCBsaWdodC5wb3NpdGlvbi55LCBsaWdodC5wb3NpdGlvbi56LCBsaWdodC5yYW5nZSk7XHJcbiAgICAgICAgICAgIGlmIChpbnRlcnNlY3Quc3BoZXJlRnJ1c3R1bSh0aGlzLl9zcGhlcmUsIGZydXN0dW0pKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpZ2h0cy5wdXNoKGxpZ2h0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyByYW5nZWQgZGlyIGxpZ2h0c1xyXG4gICAgICAgIGZvciAoY29uc3QgbGlnaHQgb2Ygc2NlbmUucmFuZ2VkRGlyTGlnaHRzKSB7XHJcbiAgICAgICAgICAgIEFBQkIudHJhbnNmb3JtKHRoaXMuX2JvdW5kaW5nQm94LCB0aGlzLl9yYW5nZWREaXJMaWdodEJvdW5kaW5nQm94LCBsaWdodC5ub2RlIS5nZXRXb3JsZE1hdHJpeCgpKTtcclxuICAgICAgICAgICAgaWYgKGludGVyc2VjdC5hYWJiRnJ1c3R1bSh0aGlzLl9ib3VuZGluZ0JveCwgZnJ1c3R1bSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlnaHRzLnB1c2gobGlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2FtZXJhUG9zKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hhZG93RW5hYmxlZFNwb3RMaWdodHMuc29ydChcclxuICAgICAgICAgICAgICAgIChsaHMsIHJocykgPT4gVmVjMy5zcXVhcmVkRGlzdGFuY2UoY2FtZXJhUG9zLCBsaHMucG9zaXRpb24pIC0gVmVjMy5zcXVhcmVkRGlzdGFuY2UoY2FtZXJhUG9zLCByaHMucG9zaXRpb24pLFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHByaXZhdGUgX2FkZExpZ2h0UXVldWVzKGNhbWVyYTogcmVuZGVyZXIuc2NlbmUuQ2FtZXJhLCBwYXNzOiByZW5kZXJpbmcuQmFzaWNSZW5kZXJQYXNzQnVpbGRlcik6IHZvaWQge1xyXG4gICAgICAgIGZvciAoY29uc3QgbGlnaHQgb2YgdGhpcy5saWdodHMpIHtcclxuICAgICAgICAgICAgY29uc3QgcXVldWUgPSBwYXNzLmFkZFF1ZXVlKHJlbmRlcmluZy5RdWV1ZUhpbnQuQkxFTkQsICdmb3J3YXJkLWFkZCcpO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGxpZ2h0LnR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgTGlnaHRUeXBlLlNQSEVSRTpcclxuICAgICAgICAgICAgICAgICAgICBxdWV1ZS5uYW1lID0gJ3NwaGVyZS1saWdodCc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIExpZ2h0VHlwZS5TUE9UOlxyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXVlLm5hbWUgPSAnc3BvdC1saWdodCc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIExpZ2h0VHlwZS5QT0lOVDpcclxuICAgICAgICAgICAgICAgICAgICBxdWV1ZS5uYW1lID0gJ3BvaW50LWxpZ2h0JztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgTGlnaHRUeXBlLlJBTkdFRF9ESVJFQ1RJT05BTDpcclxuICAgICAgICAgICAgICAgICAgICBxdWV1ZS5uYW1lID0gJ3JhbmdlZC1kaXJlY3Rpb25hbC1saWdodCc7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXVlLm5hbWUgPSAndW5rbm93bi1saWdodCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcXVldWUuYWRkU2NlbmUoXHJcbiAgICAgICAgICAgICAgICBjYW1lcmEsXHJcbiAgICAgICAgICAgICAgICByZW5kZXJpbmcuU2NlbmVGbGFncy5CTEVORCxcclxuICAgICAgICAgICAgICAgIGxpZ2h0LFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHB1YmxpYyBhZGRTcG90bGlnaHRTaGFkb3dQYXNzZXMoXHJcbiAgICAgICAgcHBsOiByZW5kZXJpbmcuQmFzaWNQaXBlbGluZSxcclxuICAgICAgICBjYW1lcmE6IHJlbmRlcmVyLnNjZW5lLkNhbWVyYSxcclxuICAgICAgICBtYXhOdW1TaGFkb3dNYXBzOiBudW1iZXIsXHJcbiAgICApOiB2b2lkIHtcclxuICAgICAgICBsZXQgaSA9IDA7XHJcbiAgICAgICAgZm9yIChjb25zdCBsaWdodCBvZiB0aGlzLnNoYWRvd0VuYWJsZWRTcG90TGlnaHRzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNoYWRvd01hcFNpemUgPSBwcGwucGlwZWxpbmVTY2VuZURhdGEuc2hhZG93cy5zaXplO1xyXG4gICAgICAgICAgICBjb25zdCBzaGFkb3dQYXNzID0gcHBsLmFkZFJlbmRlclBhc3Moc2hhZG93TWFwU2l6ZS54LCBzaGFkb3dNYXBTaXplLnksICdkZWZhdWx0Jyk7XHJcbiAgICAgICAgICAgIHNoYWRvd1Bhc3MubmFtZSA9IGBTcG90TGlnaHRTaGFkb3dQYXNzJHtpfWA7XHJcbiAgICAgICAgICAgIHNoYWRvd1Bhc3MuYWRkUmVuZGVyVGFyZ2V0KGBTcG90U2hhZG93TWFwJHtpfWAsIExvYWRPcC5DTEVBUiwgU3RvcmVPcC5TVE9SRSwgbmV3IENvbG9yKDEsIDEsIDEsIDEpKTtcclxuICAgICAgICAgICAgc2hhZG93UGFzcy5hZGREZXB0aFN0ZW5jaWwoYFNwb3RTaGFkb3dEZXB0aCR7aX1gLCBMb2FkT3AuQ0xFQVIsIFN0b3JlT3AuRElTQ0FSRCk7XHJcbiAgICAgICAgICAgIHNoYWRvd1Bhc3MuYWRkUXVldWUocmVuZGVyaW5nLlF1ZXVlSGludC5OT05FLCAnc2hhZG93LWNhc3RlcicpXHJcbiAgICAgICAgICAgICAgICAuYWRkU2NlbmUoY2FtZXJhLCByZW5kZXJpbmcuU2NlbmVGbGFncy5PUEFRVUUgfCByZW5kZXJpbmcuU2NlbmVGbGFncy5NQVNLIHwgcmVuZGVyaW5nLlNjZW5lRmxhZ3MuU0hBRE9XX0NBU1RFUilcclxuICAgICAgICAgICAgICAgIC51c2VMaWdodEZydXN0dW0obGlnaHQpO1xyXG4gICAgICAgICAgICArK2k7XHJcbiAgICAgICAgICAgIGlmIChpID49IG1heE51bVNoYWRvd01hcHMpIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHVibGljIGFkZExpZ2h0UXVldWVzKHBhc3M6IHJlbmRlcmluZy5CYXNpY1JlbmRlclBhc3NCdWlsZGVyLFxyXG4gICAgICAgIGNhbWVyYTogcmVuZGVyZXIuc2NlbmUuQ2FtZXJhLCBtYXhOdW1TaGFkb3dNYXBzOiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLl9hZGRMaWdodFF1ZXVlcyhjYW1lcmEsIHBhc3MpO1xyXG4gICAgICAgIGxldCBpID0gMDtcclxuICAgICAgICBmb3IgKGNvbnN0IGxpZ2h0IG9mIHRoaXMuc2hhZG93RW5hYmxlZFNwb3RMaWdodHMpIHtcclxuICAgICAgICAgICAgLy8gQWRkIHNwb3QtbGlnaHQgcGFzc1xyXG4gICAgICAgICAgICAvLyBTYXZlIGxhc3QgUmVuZGVyUGFzcyB0byB0aGUgYHBhc3NgIHZhcmlhYmxlXHJcbiAgICAgICAgICAgIC8vIFRPRE8oemhvdXpoZW5nbG9uZyk6IEZpeCBwZXIgcXVldWUgYWRkVGV4dHVyZVxyXG4gICAgICAgICAgICBwYXNzLmFkZFRleHR1cmUoYFNwb3RTaGFkb3dNYXAke2l9YCwgJ2NjX3Nwb3RTaGFkb3dNYXAnKTtcclxuICAgICAgICAgICAgY29uc3QgcXVldWUgPSBwYXNzLmFkZFF1ZXVlKHJlbmRlcmluZy5RdWV1ZUhpbnQuQkxFTkQsICdmb3J3YXJkLWFkZCcpO1xyXG4gICAgICAgICAgICBxdWV1ZS5hZGRTY2VuZShjYW1lcmEsIHJlbmRlcmluZy5TY2VuZUZsYWdzLkJMRU5ELCBsaWdodCk7XHJcbiAgICAgICAgICAgICsraTtcclxuICAgICAgICAgICAgaWYgKGkgPj0gbWF4TnVtU2hhZG93TWFwcykge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTm90aWNlOiBGb3J3YXJkTGlnaHRpbmcgY2Fubm90IGhhbmRsZSBhIGxvdCBvZiBsaWdodHMuXHJcbiAgICAvLyBJZiB0aGVyZSBhcmUgdG9vIG1hbnkgbGlnaHRzLCB0aGUgcGVyZm9ybWFuY2Ugd2lsbCBiZSB2ZXJ5IHBvb3IuXHJcbiAgICAvLyBJZiBtYW55IGxpZ2h0cyBhcmUgbmVlZGVkLCBwbGVhc2UgaW1wbGVtZW50IGEgZm9yd2FyZCsgb3IgZGVmZXJyZWQgcmVuZGVyaW5nIHBpcGVsaW5lLlxyXG4gICAgcHVibGljIGFkZExpZ2h0UGFzc2VzKFxyXG4gICAgICAgIGNvbG9yTmFtZTogc3RyaW5nLFxyXG4gICAgICAgIGRlcHRoU3RlbmNpbE5hbWU6IHN0cmluZyxcclxuICAgICAgICBkZXB0aFN0ZW5jaWxTdG9yZU9wOiBnZnguU3RvcmVPcCxcclxuICAgICAgICBpZDogbnVtYmVyLCAvLyB3aW5kb3cgaWRcclxuICAgICAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgICAgIGNhbWVyYTogcmVuZGVyZXIuc2NlbmUuQ2FtZXJhLFxyXG4gICAgICAgIHZpZXdwb3J0OiBnZnguVmlld3BvcnQsXHJcbiAgICAgICAgcHBsOiByZW5kZXJpbmcuQmFzaWNQaXBlbGluZSxcclxuICAgICAgICBwYXNzOiByZW5kZXJpbmcuQmFzaWNSZW5kZXJQYXNzQnVpbGRlcixcclxuICAgICk6IHJlbmRlcmluZy5CYXNpY1JlbmRlclBhc3NCdWlsZGVyIHtcclxuICAgICAgICB0aGlzLl9hZGRMaWdodFF1ZXVlcyhjYW1lcmEsIHBhc3MpO1xyXG5cclxuICAgICAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgICAgIGNvbnN0IHNoYWRvd01hcFNpemUgPSBwcGwucGlwZWxpbmVTY2VuZURhdGEuc2hhZG93cy5zaXplO1xyXG4gICAgICAgIGZvciAoY29uc3QgbGlnaHQgb2YgdGhpcy5zaGFkb3dFbmFibGVkU3BvdExpZ2h0cykge1xyXG4gICAgICAgICAgICBjb25zdCBzaGFkb3dQYXNzID0gcHBsLmFkZFJlbmRlclBhc3Moc2hhZG93TWFwU2l6ZS54LCBzaGFkb3dNYXBTaXplLnksICdkZWZhdWx0Jyk7XHJcbiAgICAgICAgICAgIHNoYWRvd1Bhc3MubmFtZSA9ICdTcG90bGlnaHRTaGFkb3dQYXNzJztcclxuICAgICAgICAgICAgLy8gUmV1c2UgY3NtIHNoYWRvdyBtYXBcclxuICAgICAgICAgICAgc2hhZG93UGFzcy5hZGRSZW5kZXJUYXJnZXQoYFNoYWRvd01hcCR7aWR9YCwgTG9hZE9wLkNMRUFSLCBTdG9yZU9wLlNUT1JFLCBuZXcgQ29sb3IoMSwgMSwgMSwgMSkpO1xyXG4gICAgICAgICAgICBzaGFkb3dQYXNzLmFkZERlcHRoU3RlbmNpbChgU2hhZG93RGVwdGgke2lkfWAsIExvYWRPcC5DTEVBUiwgU3RvcmVPcC5ESVNDQVJEKTtcclxuICAgICAgICAgICAgc2hhZG93UGFzcy5hZGRRdWV1ZShyZW5kZXJpbmcuUXVldWVIaW50Lk5PTkUsICdzaGFkb3ctY2FzdGVyJylcclxuICAgICAgICAgICAgICAgIC5hZGRTY2VuZShjYW1lcmEsIHJlbmRlcmluZy5TY2VuZUZsYWdzLk9QQVFVRSB8IHJlbmRlcmluZy5TY2VuZUZsYWdzLk1BU0sgfCByZW5kZXJpbmcuU2NlbmVGbGFncy5TSEFET1dfQ0FTVEVSKVxyXG4gICAgICAgICAgICAgICAgLnVzZUxpZ2h0RnJ1c3R1bShsaWdodCk7XHJcblxyXG4gICAgICAgICAgICAvLyBBZGQgc3BvdC1saWdodCBwYXNzXHJcbiAgICAgICAgICAgIC8vIFNhdmUgbGFzdCBSZW5kZXJQYXNzIHRvIHRoZSBgcGFzc2AgdmFyaWFibGVcclxuICAgICAgICAgICAgKytjb3VudDtcclxuICAgICAgICAgICAgY29uc3Qgc3RvcmVPcCA9IGNvdW50ID09PSB0aGlzLnNoYWRvd0VuYWJsZWRTcG90TGlnaHRzLmxlbmd0aFxyXG4gICAgICAgICAgICAgICAgPyBkZXB0aFN0ZW5jaWxTdG9yZU9wXHJcbiAgICAgICAgICAgICAgICA6IFN0b3JlT3AuU1RPUkU7XHJcblxyXG4gICAgICAgICAgICBwYXNzID0gcHBsLmFkZFJlbmRlclBhc3Mod2lkdGgsIGhlaWdodCwgJ2RlZmF1bHQnKTtcclxuICAgICAgICAgICAgcGFzcy5uYW1lID0gJ1Nwb3RsaWdodFdpdGhTaGFkb3dNYXAnO1xyXG4gICAgICAgICAgICBwYXNzLnNldFZpZXdwb3J0KHZpZXdwb3J0KTtcclxuICAgICAgICAgICAgcGFzcy5hZGRSZW5kZXJUYXJnZXQoY29sb3JOYW1lLCBMb2FkT3AuTE9BRCk7XHJcbiAgICAgICAgICAgIHBhc3MuYWRkRGVwdGhTdGVuY2lsKGRlcHRoU3RlbmNpbE5hbWUsIExvYWRPcC5MT0FELCBzdG9yZU9wKTtcclxuICAgICAgICAgICAgcGFzcy5hZGRUZXh0dXJlKGBTaGFkb3dNYXAke2lkfWAsICdjY19zcG90U2hhZG93TWFwJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHF1ZXVlID0gcGFzcy5hZGRRdWV1ZShyZW5kZXJpbmcuUXVldWVIaW50LkJMRU5ELCAnZm9yd2FyZC1hZGQnKTtcclxuICAgICAgICAgICAgcXVldWUuYWRkU2NlbmUoXHJcbiAgICAgICAgICAgICAgICBjYW1lcmEsXHJcbiAgICAgICAgICAgICAgICByZW5kZXJpbmcuU2NlbmVGbGFncy5CTEVORCxcclxuICAgICAgICAgICAgICAgIGxpZ2h0LFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGFzcztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaXNNdWx0aXBsZUxpZ2h0UGFzc2VzTmVlZGVkKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNoYWRvd0VuYWJsZWRTcG90TGlnaHRzLmxlbmd0aCA+IDA7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRm9yd2FyZFBhc3NDb25maWdzIHtcclxuICAgIGVuYWJsZU1haW5MaWdodFNoYWRvd01hcDogYm9vbGVhbjtcclxuICAgIGVuYWJsZU1haW5MaWdodFBsYW5hclNoYWRvd01hcDogYm9vbGVhbjtcclxuICAgIGVuYWJsZVBsYW5hclJlZmxlY3Rpb25Qcm9iZTogYm9vbGVhbjtcclxuICAgIGVuYWJsZU1TQUE6IGJvb2xlYW47XHJcbiAgICBlbmFibGVTaW5nbGVGb3J3YXJkUGFzczogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEJ1aWx0aW5Gb3J3YXJkUGFzc0J1aWxkZXIgaW1wbGVtZW50cyByZW5kZXJpbmcuUGlwZWxpbmVQYXNzQnVpbGRlciB7XHJcbiAgICBzdGF0aWMgQ29uZmlnT3JkZXIgPSAxMDA7XHJcbiAgICBzdGF0aWMgUmVuZGVyT3JkZXIgPSAxMDA7XHJcbiAgICBnZXRDb25maWdPcmRlcigpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiBCdWlsdGluRm9yd2FyZFBhc3NCdWlsZGVyLkNvbmZpZ09yZGVyO1xyXG4gICAgfVxyXG4gICAgZ2V0UmVuZGVyT3JkZXIoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gQnVpbHRpbkZvcndhcmRQYXNzQnVpbGRlci5SZW5kZXJPcmRlcjtcclxuICAgIH1cclxuICAgIGNvbmZpZ0NhbWVyYShcclxuICAgICAgICBjYW1lcmE6IFJlYWRvbmx5PHJlbmRlcmVyLnNjZW5lLkNhbWVyYT4sXHJcbiAgICAgICAgcGlwZWxpbmVDb25maWdzOiBSZWFkb25seTxQaXBlbGluZUNvbmZpZ3M+LFxyXG4gICAgICAgIGNhbWVyYUNvbmZpZ3M6IENhbWVyYUNvbmZpZ3MgJiBGb3J3YXJkUGFzc0NvbmZpZ3MpOiB2b2lkIHtcclxuICAgICAgICAvLyBTaGFkb3dcclxuICAgICAgICBjYW1lcmFDb25maWdzLmVuYWJsZU1haW5MaWdodFNoYWRvd01hcCA9IHBpcGVsaW5lQ29uZmlncy5zaGFkb3dFbmFibGVkXHJcbiAgICAgICAgICAgICYmICFwaXBlbGluZUNvbmZpZ3MudXNlUGxhbmFyU2hhZG93XHJcbiAgICAgICAgICAgICYmICEhY2FtZXJhLnNjZW5lXHJcbiAgICAgICAgICAgICYmICEhY2FtZXJhLnNjZW5lLm1haW5MaWdodFxyXG4gICAgICAgICAgICAmJiBjYW1lcmEuc2NlbmUubWFpbkxpZ2h0LnNoYWRvd0VuYWJsZWQ7XHJcblxyXG4gICAgICAgIGNhbWVyYUNvbmZpZ3MuZW5hYmxlTWFpbkxpZ2h0UGxhbmFyU2hhZG93TWFwID0gcGlwZWxpbmVDb25maWdzLnNoYWRvd0VuYWJsZWRcclxuICAgICAgICAgICAgJiYgcGlwZWxpbmVDb25maWdzLnVzZVBsYW5hclNoYWRvd1xyXG4gICAgICAgICAgICAmJiAhIWNhbWVyYS5zY2VuZVxyXG4gICAgICAgICAgICAmJiAhIWNhbWVyYS5zY2VuZS5tYWluTGlnaHRcclxuICAgICAgICAgICAgJiYgY2FtZXJhLnNjZW5lLm1haW5MaWdodC5zaGFkb3dFbmFibGVkO1xyXG5cclxuICAgICAgICAvLyBSZWZsZWN0aW9uIFByb2JlXHJcbiAgICAgICAgY2FtZXJhQ29uZmlncy5lbmFibGVQbGFuYXJSZWZsZWN0aW9uUHJvYmUgPSBjYW1lcmFDb25maWdzLmlzTWFpbkdhbWVXaW5kb3dcclxuICAgICAgICAgICAgfHwgY2FtZXJhLmNhbWVyYVVzYWdlID09PSBDYW1lcmFVc2FnZS5TQ0VORV9WSUVXXHJcbiAgICAgICAgICAgIHx8IGNhbWVyYS5jYW1lcmFVc2FnZSA9PT0gQ2FtZXJhVXNhZ2UuR0FNRV9WSUVXO1xyXG5cclxuICAgICAgICAvLyBNU0FBXHJcbiAgICAgICAgY2FtZXJhQ29uZmlncy5lbmFibGVNU0FBID0gY2FtZXJhQ29uZmlncy5zZXR0aW5ncy5tc2FhLmVuYWJsZWRcclxuICAgICAgICAgICAgJiYgIWNhbWVyYUNvbmZpZ3MuZW5hYmxlU3RvcmVTY2VuZURlcHRoIC8vIENhbm5vdCBzdG9yZSBNUyBkZXB0aCwgcmVzb2x2ZSBkZXB0aCBpcyBhbHNvIG5vdCBjcm9zcy1wbGF0Zm9ybVxyXG4gICAgICAgICAgICAmJiAhcGlwZWxpbmVDb25maWdzLmlzV2ViIC8vIFRPRE8oemhvdXpoZW5nbG9uZyk6IHJlbW92ZSB0aGlzIGNvbnN0cmFpbnRcclxuICAgICAgICAgICAgJiYgIXBpcGVsaW5lQ29uZmlncy5pc1dlYkdMMTtcclxuXHJcbiAgICAgICAgLy8gRm9yd2FyZCByZW5kZXJpbmcgKERlcGVuZCBvbiBNU0FBIGFuZCBUQlIpXHJcbiAgICAgICAgY2FtZXJhQ29uZmlncy5lbmFibGVTaW5nbGVGb3J3YXJkUGFzc1xyXG4gICAgICAgICAgICA9IHBpcGVsaW5lQ29uZmlncy5pc01vYmlsZSB8fCBjYW1lcmFDb25maWdzLmVuYWJsZU1TQUE7XHJcblxyXG4gICAgICAgICsrY2FtZXJhQ29uZmlncy5yZW1haW5pbmdQYXNzZXM7XHJcbiAgICB9XHJcbiAgICB3aW5kb3dSZXNpemUoXHJcbiAgICAgICAgcHBsOiByZW5kZXJpbmcuQmFzaWNQaXBlbGluZSxcclxuICAgICAgICBwcGxDb25maWdzOiBSZWFkb25seTxQaXBlbGluZUNvbmZpZ3M+LFxyXG4gICAgICAgIGNhbWVyYUNvbmZpZ3M6IFJlYWRvbmx5PENhbWVyYUNvbmZpZ3MgJiBGb3J3YXJkUGFzc0NvbmZpZ3M+LFxyXG4gICAgICAgIHdpbmRvdzogcmVuZGVyZXIuUmVuZGVyV2luZG93LFxyXG4gICAgICAgIGNhbWVyYTogcmVuZGVyZXIuc2NlbmUuQ2FtZXJhLFxyXG4gICAgICAgIG5hdGl2ZVdpZHRoOiBudW1iZXIsXHJcbiAgICAgICAgbmF0aXZlSGVpZ2h0OiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBSZXNvdXJjZUZsYWdzID0gcmVuZGVyaW5nLlJlc291cmNlRmxhZ3M7XHJcbiAgICAgICAgY29uc3QgUmVzb3VyY2VSZXNpZGVuY3kgPSByZW5kZXJpbmcuUmVzb3VyY2VSZXNpZGVuY3k7XHJcbiAgICAgICAgY29uc3QgaWQgPSB3aW5kb3cucmVuZGVyV2luZG93SWQ7XHJcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBjYW1lcmFDb25maWdzLnNldHRpbmdzO1xyXG5cclxuICAgICAgICBjb25zdCB3aWR0aCA9IGNhbWVyYUNvbmZpZ3MuZW5hYmxlU2hhZGluZ1NjYWxlXHJcbiAgICAgICAgICAgID8gTWF0aC5tYXgoTWF0aC5mbG9vcihuYXRpdmVXaWR0aCAqIGNhbWVyYUNvbmZpZ3Muc2hhZGluZ1NjYWxlKSwgMSlcclxuICAgICAgICAgICAgOiBuYXRpdmVXaWR0aDtcclxuICAgICAgICBjb25zdCBoZWlnaHQgPSBjYW1lcmFDb25maWdzLmVuYWJsZVNoYWRpbmdTY2FsZVxyXG4gICAgICAgICAgICA/IE1hdGgubWF4KE1hdGguZmxvb3IobmF0aXZlSGVpZ2h0ICogY2FtZXJhQ29uZmlncy5zaGFkaW5nU2NhbGUpLCAxKVxyXG4gICAgICAgICAgICA6IG5hdGl2ZUhlaWdodDtcclxuXHJcbiAgICAgICAgLy8gTXNhYVJhZGlhbmNlXHJcbiAgICAgICAgaWYgKGNhbWVyYUNvbmZpZ3MuZW5hYmxlTVNBQSkge1xyXG4gICAgICAgICAgICAvLyBOb3RpY2U6IFdlIG5ldmVyIHN0b3JlIG11bHRpc2FtcGxlIHJlc3VsdHMuXHJcbiAgICAgICAgICAgIC8vIFRoZXNlIHNhbXBsZXMgYXJlIGFsd2F5cyByZXNvbHZlZCBhbmQgZGlzY2FyZGVkIGF0IHRoZSBlbmQgb2YgdGhlIHJlbmRlciBwYXNzLlxyXG4gICAgICAgICAgICAvLyBTbyB0aGUgUmVzb3VyY2VSZXNpZGVuY3kgc2hvdWxkIGJlIE1FTU9SWUxFU1MuXHJcbiAgICAgICAgICAgIGlmIChjYW1lcmFDb25maWdzLmVuYWJsZUhEUikge1xyXG4gICAgICAgICAgICAgICAgcHBsLmFkZFRleHR1cmUoYE1zYWFSYWRpYW5jZSR7aWR9YCwgVGV4dHVyZVR5cGUuVEVYMkQsIGNhbWVyYUNvbmZpZ3MucmFkaWFuY2VGb3JtYXQsIHdpZHRoLCBoZWlnaHQsIDEsIDEsIDEsXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MubXNhYS5zYW1wbGVDb3VudCwgUmVzb3VyY2VGbGFncy5DT0xPUl9BVFRBQ0hNRU5ULCBSZXNvdXJjZVJlc2lkZW5jeS5NRU1PUllMRVNTKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBwbC5hZGRUZXh0dXJlKGBNc2FhUmFkaWFuY2Uke2lkfWAsIFRleHR1cmVUeXBlLlRFWDJELCBGb3JtYXQuUkdCQTgsIHdpZHRoLCBoZWlnaHQsIDEsIDEsIDEsXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MubXNhYS5zYW1wbGVDb3VudCwgUmVzb3VyY2VGbGFncy5DT0xPUl9BVFRBQ0hNRU5ULCBSZXNvdXJjZVJlc2lkZW5jeS5NRU1PUllMRVNTKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwcGwuYWRkVGV4dHVyZShgTXNhYURlcHRoU3RlbmNpbCR7aWR9YCwgVGV4dHVyZVR5cGUuVEVYMkQsIEZvcm1hdC5ERVBUSF9TVEVOQ0lMLCB3aWR0aCwgaGVpZ2h0LCAxLCAxLCAxLFxyXG4gICAgICAgICAgICAgICAgc2V0dGluZ3MubXNhYS5zYW1wbGVDb3VudCwgUmVzb3VyY2VGbGFncy5ERVBUSF9TVEVOQ0lMX0FUVEFDSE1FTlQsIFJlc291cmNlUmVzaWRlbmN5Lk1FTU9SWUxFU1MpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gTWFpbmxpZ2h0IFNoYWRvd01hcFxyXG4gICAgICAgIHBwbC5hZGRSZW5kZXJUYXJnZXQoXHJcbiAgICAgICAgICAgIGBTaGFkb3dNYXAke2lkfWAsXHJcbiAgICAgICAgICAgIHBwbENvbmZpZ3Muc2hhZG93TWFwRm9ybWF0LFxyXG4gICAgICAgICAgICBwcGxDb25maWdzLnNoYWRvd01hcFNpemUueCxcclxuICAgICAgICAgICAgcHBsQ29uZmlncy5zaGFkb3dNYXBTaXplLnksXHJcbiAgICAgICAgKTtcclxuICAgICAgICBwcGwuYWRkRGVwdGhTdGVuY2lsKFxyXG4gICAgICAgICAgICBgU2hhZG93RGVwdGgke2lkfWAsXHJcbiAgICAgICAgICAgIEZvcm1hdC5ERVBUSF9TVEVOQ0lMLFxyXG4gICAgICAgICAgICBwcGxDb25maWdzLnNoYWRvd01hcFNpemUueCxcclxuICAgICAgICAgICAgcHBsQ29uZmlncy5zaGFkb3dNYXBTaXplLnksXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gU3BvdC1saWdodCBzaGFkb3cgbWFwc1xyXG4gICAgICAgIGlmIChjYW1lcmFDb25maWdzLmVuYWJsZVNpbmdsZUZvcndhcmRQYXNzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvdW50ID0gcHBsQ29uZmlncy5tb2JpbGVNYXhTcG90TGlnaHRTaGFkb3dNYXBzO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gY291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgcHBsLmFkZFJlbmRlclRhcmdldChcclxuICAgICAgICAgICAgICAgICAgICBgU3BvdFNoYWRvd01hcCR7aX1gLFxyXG4gICAgICAgICAgICAgICAgICAgIHBwbENvbmZpZ3Muc2hhZG93TWFwRm9ybWF0LFxyXG4gICAgICAgICAgICAgICAgICAgIHBwbENvbmZpZ3Muc2hhZG93TWFwU2l6ZS54LFxyXG4gICAgICAgICAgICAgICAgICAgIHBwbENvbmZpZ3Muc2hhZG93TWFwU2l6ZS55LFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIHBwbC5hZGREZXB0aFN0ZW5jaWwoXHJcbiAgICAgICAgICAgICAgICAgICAgYFNwb3RTaGFkb3dEZXB0aCR7aX1gLFxyXG4gICAgICAgICAgICAgICAgICAgIEZvcm1hdC5ERVBUSF9TVEVOQ0lMLFxyXG4gICAgICAgICAgICAgICAgICAgIHBwbENvbmZpZ3Muc2hhZG93TWFwU2l6ZS54LFxyXG4gICAgICAgICAgICAgICAgICAgIHBwbENvbmZpZ3Muc2hhZG93TWFwU2l6ZS55LFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHNldHVwKFxyXG4gICAgICAgIHBwbDogcmVuZGVyaW5nLkJhc2ljUGlwZWxpbmUsXHJcbiAgICAgICAgcHBsQ29uZmlnczogUmVhZG9ubHk8UGlwZWxpbmVDb25maWdzPixcclxuICAgICAgICBjYW1lcmFDb25maWdzOiBDYW1lcmFDb25maWdzICYgRm9yd2FyZFBhc3NDb25maWdzLFxyXG4gICAgICAgIGNhbWVyYTogcmVuZGVyZXIuc2NlbmUuQ2FtZXJhLFxyXG4gICAgICAgIGNvbnRleHQ6IFBpcGVsaW5lQ29udGV4dCk6IHJlbmRlcmluZy5CYXNpY1JlbmRlclBhc3NCdWlsZGVyIHwgdW5kZWZpbmVkIHtcclxuICAgICAgICBjb25zdCBpZCA9IGNhbWVyYS53aW5kb3cucmVuZGVyV2luZG93SWQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHNjZW5lID0gY2FtZXJhLnNjZW5lITtcclxuICAgICAgICBjb25zdCBtYWluTGlnaHQgPSBzY2VuZS5tYWluTGlnaHQ7XHJcblxyXG4gICAgICAgIC0tY2FtZXJhQ29uZmlncy5yZW1haW5pbmdQYXNzZXM7XHJcbiAgICAgICAgYXNzZXJ0KGNhbWVyYUNvbmZpZ3MucmVtYWluaW5nUGFzc2VzID49IDApO1xyXG5cclxuICAgICAgICAvLyBGb3J3YXJkIExpZ2h0aW5nIChMaWdodCBDdWxsaW5nKVxyXG4gICAgICAgIHRoaXMuZm9yd2FyZExpZ2h0aW5nLmN1bGxMaWdodHMoc2NlbmUsIGNhbWVyYS5mcnVzdHVtKTtcclxuXHJcbiAgICAgICAgLy8gTWFpbiBEaXJlY3Rpb25hbCBsaWdodCBDU00gU2hhZG93IE1hcFxyXG4gICAgICAgIGlmIChjYW1lcmFDb25maWdzLmVuYWJsZU1haW5MaWdodFNoYWRvd01hcCkge1xyXG4gICAgICAgICAgICBhc3NlcnQoISFtYWluTGlnaHQpO1xyXG4gICAgICAgICAgICB0aGlzLl9hZGRDYXNjYWRlZFNoYWRvd01hcFBhc3MocHBsLCBwcGxDb25maWdzLCBpZCwgbWFpbkxpZ2h0LCBjYW1lcmEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU3BvdCBsaWdodCBzaGFkb3cgbWFwcyAoTW9iaWxlIG9yIE1TQUEpXHJcbiAgICAgICAgaWYgKGNhbWVyYUNvbmZpZ3MuZW5hYmxlU2luZ2xlRm9yd2FyZFBhc3MpIHtcclxuICAgICAgICAgICAgLy8gQ3VycmVudGx5LCBvbmx5IHN1cHBvcnQgMSBzcG90IGxpZ2h0IHdpdGggc2hhZG93IG1hcCBvbiBtb2JpbGUgcGxhdGZvcm0uXHJcbiAgICAgICAgICAgIC8vIFRPRE8oemhvdXpoZW5nbG9uZyk6IFJlbGV4IHRoaXMgbGltaXRhdGlvbi5cclxuICAgICAgICAgICAgdGhpcy5mb3J3YXJkTGlnaHRpbmcuYWRkU3BvdGxpZ2h0U2hhZG93UGFzc2VzKFxyXG4gICAgICAgICAgICAgICAgcHBsLCBjYW1lcmEsIHBwbENvbmZpZ3MubW9iaWxlTWF4U3BvdExpZ2h0U2hhZG93TWFwcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl90cnlBZGRSZWZsZWN0aW9uUHJvYmVQYXNzZXMocHBsLCBjYW1lcmFDb25maWdzLCBpZCwgbWFpbkxpZ2h0LCBjYW1lcmEuc2NlbmUpO1xyXG5cclxuICAgICAgICBpZiAoY2FtZXJhQ29uZmlncy5yZW1haW5pbmdQYXNzZXMgPiAwIHx8IGNhbWVyYUNvbmZpZ3MuZW5hYmxlU2hhZGluZ1NjYWxlKSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuY29sb3JOYW1lID0gY2FtZXJhQ29uZmlncy5lbmFibGVTaGFkaW5nU2NhbGVcclxuICAgICAgICAgICAgICAgID8gYFNjYWxlZFJhZGlhbmNlMF8ke2lkfWBcclxuICAgICAgICAgICAgICAgIDogYFJhZGlhbmNlMF8ke2lkfWA7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZGVwdGhTdGVuY2lsTmFtZSA9IGNhbWVyYUNvbmZpZ3MuZW5hYmxlU2hhZGluZ1NjYWxlXHJcbiAgICAgICAgICAgICAgICA/IGBTY2FsZWRTY2VuZURlcHRoXyR7aWR9YFxyXG4gICAgICAgICAgICAgICAgOiBgU2NlbmVEZXB0aF8ke2lkfWA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29udGV4dC5jb2xvck5hbWUgPSBjYW1lcmFDb25maWdzLmNvbG9yTmFtZTtcclxuICAgICAgICAgICAgY29udGV4dC5kZXB0aFN0ZW5jaWxOYW1lID0gY2FtZXJhQ29uZmlncy5kZXB0aFN0ZW5jaWxOYW1lO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcGFzcyA9IHRoaXMuX2FkZEZvcndhcmRSYWRpYW5jZVBhc3NlcyhcclxuICAgICAgICAgICAgcHBsLCBwcGxDb25maWdzLCBjYW1lcmFDb25maWdzLCBpZCwgY2FtZXJhLFxyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLndpZHRoLCBjYW1lcmFDb25maWdzLmhlaWdodCwgbWFpbkxpZ2h0LFxyXG4gICAgICAgICAgICBjb250ZXh0LmNvbG9yTmFtZSwgY29udGV4dC5kZXB0aFN0ZW5jaWxOYW1lLFxyXG4gICAgICAgICAgICAhY2FtZXJhQ29uZmlncy5lbmFibGVNU0FBLFxyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLmVuYWJsZVN0b3JlU2NlbmVEZXB0aCA/IFN0b3JlT3AuU1RPUkUgOiBTdG9yZU9wLkRJU0NBUkQpO1xyXG5cclxuICAgICAgICBpZiAoIWNhbWVyYUNvbmZpZ3MuZW5hYmxlU3RvcmVTY2VuZURlcHRoKSB7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZGVwdGhTdGVuY2lsTmFtZSA9ICcnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNhbWVyYUNvbmZpZ3MucmVtYWluaW5nUGFzc2VzID09PSAwICYmIGNhbWVyYUNvbmZpZ3MuZW5hYmxlU2hhZGluZ1NjYWxlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhZGRDb3B5VG9TY3JlZW5QYXNzKHBwbCwgcHBsQ29uZmlncywgY2FtZXJhQ29uZmlncywgY29udGV4dC5jb2xvck5hbWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXNzO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHByaXZhdGUgX2FkZENhc2NhZGVkU2hhZG93TWFwUGFzcyhcclxuICAgICAgICBwcGw6IHJlbmRlcmluZy5CYXNpY1BpcGVsaW5lLFxyXG4gICAgICAgIHBwbENvbmZpZ3M6IFJlYWRvbmx5PFBpcGVsaW5lQ29uZmlncz4sXHJcbiAgICAgICAgaWQ6IG51bWJlcixcclxuICAgICAgICBsaWdodDogcmVuZGVyZXIuc2NlbmUuRGlyZWN0aW9uYWxMaWdodCxcclxuICAgICAgICBjYW1lcmE6IHJlbmRlcmVyLnNjZW5lLkNhbWVyYSxcclxuICAgICk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IFF1ZXVlSGludCA9IHJlbmRlcmluZy5RdWV1ZUhpbnQ7XHJcbiAgICAgICAgY29uc3QgU2NlbmVGbGFncyA9IHJlbmRlcmluZy5TY2VuZUZsYWdzO1xyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAvLyBEeW5hbWljIHN0YXRlc1xyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICBjb25zdCBzaGFkb3dTaXplID0gcHBsLnBpcGVsaW5lU2NlbmVEYXRhLnNoYWRvd3Muc2l6ZTtcclxuICAgICAgICBjb25zdCB3aWR0aCA9IHNoYWRvd1NpemUueDtcclxuICAgICAgICBjb25zdCBoZWlnaHQgPSBzaGFkb3dTaXplLnk7XHJcblxyXG4gICAgICAgIGNvbnN0IHZpZXdwb3J0ID0gdGhpcy5fdmlld3BvcnQ7XHJcbiAgICAgICAgdmlld3BvcnQubGVmdCA9IHZpZXdwb3J0LnRvcCA9IDA7XHJcbiAgICAgICAgdmlld3BvcnQud2lkdGggPSB3aWR0aDtcclxuICAgICAgICB2aWV3cG9ydC5oZWlnaHQgPSBoZWlnaHQ7XHJcblxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAvLyBDU00gU2hhZG93IE1hcFxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICBjb25zdCBwYXNzID0gcHBsLmFkZFJlbmRlclBhc3Mod2lkdGgsIGhlaWdodCwgJ2RlZmF1bHQnKTtcclxuICAgICAgICBwYXNzLm5hbWUgPSAnQ2FzY2FkZWRTaGFkb3dNYXAnO1xyXG4gICAgICAgIHBhc3MuYWRkUmVuZGVyVGFyZ2V0KGBTaGFkb3dNYXAke2lkfWAsIExvYWRPcC5DTEVBUiwgU3RvcmVPcC5TVE9SRSwgbmV3IENvbG9yKDEsIDEsIDEsIDEpKTtcclxuICAgICAgICBwYXNzLmFkZERlcHRoU3RlbmNpbChgU2hhZG93RGVwdGgke2lkfWAsIExvYWRPcC5DTEVBUiwgU3RvcmVPcC5ESVNDQVJEKTtcclxuICAgICAgICBjb25zdCBjc21MZXZlbCA9IHBwbC5waXBlbGluZVNjZW5lRGF0YS5jc21TdXBwb3J0ZWQgPyBsaWdodC5jc21MZXZlbCA6IDE7XHJcblxyXG4gICAgICAgIC8vIEFkZCBzaGFkb3cgbWFwIHZpZXdwb3J0c1xyXG4gICAgICAgIGZvciAobGV0IGxldmVsID0gMDsgbGV2ZWwgIT09IGNzbUxldmVsOyArK2xldmVsKSB7XHJcbiAgICAgICAgICAgIGdldENzbU1haW5MaWdodFZpZXdwb3J0KGxpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBsZXZlbCwgdGhpcy5fdmlld3BvcnQsIHBwbENvbmZpZ3Muc2NyZWVuU3BhY2VTaWduWSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHF1ZXVlID0gcGFzcy5hZGRRdWV1ZShRdWV1ZUhpbnQuTk9ORSwgJ3NoYWRvdy1jYXN0ZXInKTtcclxuICAgICAgICAgICAgaWYgKCFwcGxDb25maWdzLmlzV2ViR1BVKSB7IC8vIFRlbXBvcmFyeSB3b3JrYXJvdW5kIGZvciBXZWJHUFVcclxuICAgICAgICAgICAgICAgIHF1ZXVlLnNldFZpZXdwb3J0KHRoaXMuX3ZpZXdwb3J0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBxdWV1ZVxyXG4gICAgICAgICAgICAgICAgLmFkZFNjZW5lKGNhbWVyYSwgU2NlbmVGbGFncy5PUEFRVUUgfCBTY2VuZUZsYWdzLk1BU0sgfCBTY2VuZUZsYWdzLlNIQURPV19DQVNURVIpXHJcbiAgICAgICAgICAgICAgICAudXNlTGlnaHRGcnVzdHVtKGxpZ2h0LCBsZXZlbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBfdHJ5QWRkUmVmbGVjdGlvblByb2JlUGFzc2VzKFxyXG4gICAgICAgIHBwbDogcmVuZGVyaW5nLkJhc2ljUGlwZWxpbmUsXHJcbiAgICAgICAgY2FtZXJhQ29uZmlnczogUmVhZG9ubHk8Q2FtZXJhQ29uZmlncyAmIEZvcndhcmRQYXNzQ29uZmlncz4sXHJcbiAgICAgICAgaWQ6IG51bWJlcixcclxuICAgICAgICBtYWluTGlnaHQ6IHJlbmRlcmVyLnNjZW5lLkRpcmVjdGlvbmFsTGlnaHQgfCBudWxsLFxyXG4gICAgICAgIHNjZW5lOiByZW5kZXJlci5SZW5kZXJTY2VuZSB8IG51bGwsXHJcbiAgICApOiB2b2lkIHtcclxuICAgICAgICBjb25zdCByZWZsZWN0aW9uUHJvYmVNYW5hZ2VyID0gY2NsZWdhY3kuaW50ZXJuYWwucmVmbGVjdGlvblByb2JlTWFuYWdlciBhcyBSZWZsZWN0aW9uUHJvYmVNYW5hZ2VyIHwgdW5kZWZpbmVkO1xyXG4gICAgICAgIGlmICghcmVmbGVjdGlvblByb2JlTWFuYWdlcikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IFJlc291cmNlUmVzaWRlbmN5ID0gcmVuZGVyaW5nLlJlc291cmNlUmVzaWRlbmN5O1xyXG4gICAgICAgIGNvbnN0IHByb2JlcyA9IHJlZmxlY3Rpb25Qcm9iZU1hbmFnZXIuZ2V0UHJvYmVzKCk7XHJcbiAgICAgICAgY29uc3QgbWF4UHJvYmVDb3VudCA9IDQ7XHJcbiAgICAgICAgbGV0IHByb2JlSUQgPSAwO1xyXG4gICAgICAgIGZvciAoY29uc3QgcHJvYmUgb2YgcHJvYmVzKSB7XHJcbiAgICAgICAgICAgIGlmICghcHJvYmUubmVlZFJlbmRlcikge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgYXJlYSA9IHByb2JlLnJlbmRlckFyZWEoKTtcclxuICAgICAgICAgICAgY29uc3Qgd2lkdGggPSBNYXRoLm1heChNYXRoLmZsb29yKGFyZWEueCksIDEpO1xyXG4gICAgICAgICAgICBjb25zdCBoZWlnaHQgPSBNYXRoLm1heChNYXRoLmZsb29yKGFyZWEueSksIDEpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHByb2JlLnByb2JlVHlwZSA9PT0gcmVuZGVyZXIuc2NlbmUuUHJvYmVUeXBlLlBMQU5BUikge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjYW1lcmFDb25maWdzLmVuYWJsZVBsYW5hclJlZmxlY3Rpb25Qcm9iZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3Qgd2luZG93OiByZW5kZXJlci5SZW5kZXJXaW5kb3cgPSBwcm9iZS5yZWFsdGltZVBsYW5hclRleHR1cmUhLndpbmRvdyE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb2xvck5hbWUgPSBgUGxhbmFyUHJvYmVSVCR7cHJvYmVJRH1gO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVwdGhTdGVuY2lsTmFtZSA9IGBQbGFuYXJQcm9iZURTJHtwcm9iZUlEfWA7XHJcbiAgICAgICAgICAgICAgICAvLyBQcm9iZVJlc291cmNlXHJcbiAgICAgICAgICAgICAgICBwcGwuYWRkUmVuZGVyV2luZG93KGNvbG9yTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjYW1lcmFDb25maWdzLnJhZGlhbmNlRm9ybWF0LCB3aWR0aCwgaGVpZ2h0LCB3aW5kb3cpO1xyXG4gICAgICAgICAgICAgICAgcHBsLmFkZERlcHRoU3RlbmNpbChkZXB0aFN0ZW5jaWxOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIGdmeC5Gb3JtYXQuREVQVEhfU1RFTkNJTCwgd2lkdGgsIGhlaWdodCwgUmVzb3VyY2VSZXNpZGVuY3kuTUVNT1JZTEVTUyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gUmVuZGVyaW5nXHJcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9iZVBhc3MgPSBwcGwuYWRkUmVuZGVyUGFzcyh3aWR0aCwgaGVpZ2h0LCAnZGVmYXVsdCcpO1xyXG4gICAgICAgICAgICAgICAgcHJvYmVQYXNzLm5hbWUgPSBgUGxhbmFyUmVmbGVjdGlvblByb2JlJHtwcm9iZUlEfWA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9idWlsZFJlZmxlY3Rpb25Qcm9iZVBhc3MocHJvYmVQYXNzLCBjYW1lcmFDb25maWdzLCBpZCwgcHJvYmUuY2FtZXJhLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yTmFtZSwgZGVwdGhTdGVuY2lsTmFtZSwgbWFpbkxpZ2h0LCBzY2VuZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoRURJVE9SKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBmYWNlSWR4ID0gMDsgZmFjZUlkeCA8IHByb2JlLmJha2VkQ3ViZVRleHR1cmVzLmxlbmd0aDsgZmFjZUlkeCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvYmUudXBkYXRlQ2FtZXJhRGlyKGZhY2VJZHgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHdpbmRvdzogcmVuZGVyZXIuUmVuZGVyV2luZG93ID0gcHJvYmUuYmFrZWRDdWJlVGV4dHVyZXNbZmFjZUlkeF0ud2luZG93ITtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2xvck5hbWUgPSBgQ3ViZVByb2JlUlQke3Byb2JlSUR9JHtmYWNlSWR4fWA7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVwdGhTdGVuY2lsTmFtZSA9IGBDdWJlUHJvYmVEUyR7cHJvYmVJRH0ke2ZhY2VJZHh9YDtcclxuICAgICAgICAgICAgICAgICAgICAvLyBQcm9iZVJlc291cmNlXHJcbiAgICAgICAgICAgICAgICAgICAgcHBsLmFkZFJlbmRlcldpbmRvdyhjb2xvck5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3MucmFkaWFuY2VGb3JtYXQsIHdpZHRoLCBoZWlnaHQsIHdpbmRvdyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHBsLmFkZERlcHRoU3RlbmNpbChkZXB0aFN0ZW5jaWxOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnZnguRm9ybWF0LkRFUFRIX1NURU5DSUwsIHdpZHRoLCBoZWlnaHQsIFJlc291cmNlUmVzaWRlbmN5Lk1FTU9SWUxFU1MpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBSZW5kZXJpbmdcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9iZVBhc3MgPSBwcGwuYWRkUmVuZGVyUGFzcyh3aWR0aCwgaGVpZ2h0LCAnZGVmYXVsdCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2JlUGFzcy5uYW1lID0gYEN1YmVQcm9iZSR7cHJvYmVJRH0ke2ZhY2VJZHh9YDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9idWlsZFJlZmxlY3Rpb25Qcm9iZVBhc3MocHJvYmVQYXNzLCBjYW1lcmFDb25maWdzLCBpZCwgcHJvYmUuY2FtZXJhLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvck5hbWUsIGRlcHRoU3RlbmNpbE5hbWUsIG1haW5MaWdodCwgc2NlbmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcHJvYmUubmVlZFJlbmRlciA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICsrcHJvYmVJRDtcclxuICAgICAgICAgICAgaWYgKHByb2JlSUQgPT09IG1heFByb2JlQ291bnQpIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBfYnVpbGRSZWZsZWN0aW9uUHJvYmVQYXNzKFxyXG4gICAgICAgIHBhc3M6IHJlbmRlcmluZy5CYXNpY1JlbmRlclBhc3NCdWlsZGVyLFxyXG4gICAgICAgIGNhbWVyYUNvbmZpZ3M6IFJlYWRvbmx5PENhbWVyYUNvbmZpZ3MgJiBGb3J3YXJkUGFzc0NvbmZpZ3M+LFxyXG4gICAgICAgIGlkOiBudW1iZXIsXHJcbiAgICAgICAgY2FtZXJhOiByZW5kZXJlci5zY2VuZS5DYW1lcmEsXHJcbiAgICAgICAgY29sb3JOYW1lOiBzdHJpbmcsXHJcbiAgICAgICAgZGVwdGhTdGVuY2lsTmFtZTogc3RyaW5nLFxyXG4gICAgICAgIG1haW5MaWdodDogcmVuZGVyZXIuc2NlbmUuRGlyZWN0aW9uYWxMaWdodCB8IG51bGwsXHJcbiAgICAgICAgc2NlbmU6IHJlbmRlcmVyLlJlbmRlclNjZW5lIHwgbnVsbCA9IG51bGwsXHJcbiAgICApOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBRdWV1ZUhpbnQgPSByZW5kZXJpbmcuUXVldWVIaW50O1xyXG4gICAgICAgIGNvbnN0IFNjZW5lRmxhZ3MgPSByZW5kZXJpbmcuU2NlbmVGbGFncztcclxuICAgICAgICAvLyBzZXQgdmlld3BvcnRcclxuICAgICAgICBjb25zdCBjb2xvclN0b3JlT3AgPSBjYW1lcmFDb25maWdzLmVuYWJsZU1TQUEgPyBTdG9yZU9wLkRJU0NBUkQgOiBTdG9yZU9wLlNUT1JFO1xyXG5cclxuICAgICAgICAvLyBiaW5kIG91dHB1dCByZW5kZXIgdGFyZ2V0XHJcbiAgICAgICAgaWYgKGZvcndhcmROZWVkQ2xlYXJDb2xvcihjYW1lcmEpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlZmxlY3Rpb25Qcm9iZUNsZWFyQ29sb3IueCA9IGNhbWVyYS5jbGVhckNvbG9yLng7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlZmxlY3Rpb25Qcm9iZUNsZWFyQ29sb3IueSA9IGNhbWVyYS5jbGVhckNvbG9yLnk7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlZmxlY3Rpb25Qcm9iZUNsZWFyQ29sb3IueiA9IGNhbWVyYS5jbGVhckNvbG9yLno7XHJcbiAgICAgICAgICAgIGNvbnN0IGNsZWFyQ29sb3IgPSByZW5kZXJpbmcucGFja1JHQkUodGhpcy5fcmVmbGVjdGlvblByb2JlQ2xlYXJDb2xvcik7XHJcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyQ29sb3IueCA9IGNsZWFyQ29sb3IueDtcclxuICAgICAgICAgICAgdGhpcy5fY2xlYXJDb2xvci55ID0gY2xlYXJDb2xvci55O1xyXG4gICAgICAgICAgICB0aGlzLl9jbGVhckNvbG9yLnogPSBjbGVhckNvbG9yLno7XHJcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyQ29sb3IudyA9IGNsZWFyQ29sb3IudztcclxuICAgICAgICAgICAgcGFzcy5hZGRSZW5kZXJUYXJnZXQoY29sb3JOYW1lLCBMb2FkT3AuQ0xFQVIsIGNvbG9yU3RvcmVPcCwgdGhpcy5fY2xlYXJDb2xvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcGFzcy5hZGRSZW5kZXJUYXJnZXQoY29sb3JOYW1lLCBMb2FkT3AuTE9BRCwgY29sb3JTdG9yZU9wKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGJpbmQgZGVwdGggc3RlbmNpbCBidWZmZXJcclxuICAgICAgICBpZiAoY2FtZXJhLmNsZWFyRmxhZyAmIENsZWFyRmxhZ0JpdC5ERVBUSF9TVEVOQ0lMKSB7XHJcbiAgICAgICAgICAgIHBhc3MuYWRkRGVwdGhTdGVuY2lsKFxyXG4gICAgICAgICAgICAgICAgZGVwdGhTdGVuY2lsTmFtZSxcclxuICAgICAgICAgICAgICAgIExvYWRPcC5DTEVBUixcclxuICAgICAgICAgICAgICAgIFN0b3JlT3AuRElTQ0FSRCxcclxuICAgICAgICAgICAgICAgIGNhbWVyYS5jbGVhckRlcHRoLFxyXG4gICAgICAgICAgICAgICAgY2FtZXJhLmNsZWFyU3RlbmNpbCxcclxuICAgICAgICAgICAgICAgIGNhbWVyYS5jbGVhckZsYWcgJiBDbGVhckZsYWdCaXQuREVQVEhfU1RFTkNJTCxcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwYXNzLmFkZERlcHRoU3RlbmNpbChkZXB0aFN0ZW5jaWxOYW1lLCBMb2FkT3AuTE9BRCwgU3RvcmVPcC5ESVNDQVJEKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNldCBzaGFkb3cgbWFwIGlmIGVuYWJsZWRcclxuICAgICAgICBpZiAoY2FtZXJhQ29uZmlncy5lbmFibGVNYWluTGlnaHRTaGFkb3dNYXApIHtcclxuICAgICAgICAgICAgcGFzcy5hZGRUZXh0dXJlKGBTaGFkb3dNYXAke2lkfWAsICdjY19zaGFkb3dNYXAnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRPRE8oemhvdXpoZW5nbG9uZyk6IFNlcGFyYXRlIE9QQVFVRSBhbmQgTUFTSyBxdWV1ZVxyXG5cclxuICAgICAgICAvLyBhZGQgb3BhcXVlIGFuZCBtYXNrIHF1ZXVlXHJcbiAgICAgICAgcGFzcy5hZGRRdWV1ZShRdWV1ZUhpbnQuTk9ORSwgJ3JlZmxlY3QtbWFwJykgLy8gQ3VycmVudGx5IHdlIHB1dCBPUEFRVUUgYW5kIE1BU0sgaW50byBvbmUgcXVldWUsIHNvIFF1ZXVlSGludCBpcyBOT05FXHJcbiAgICAgICAgICAgIC5hZGRTY2VuZShjYW1lcmEsXHJcbiAgICAgICAgICAgICAgICBTY2VuZUZsYWdzLk9QQVFVRSB8IFNjZW5lRmxhZ3MuTUFTSyB8IFNjZW5lRmxhZ3MuUkVGTEVDVElPTl9QUk9CRSxcclxuICAgICAgICAgICAgICAgIG1haW5MaWdodCB8fCB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICBzY2VuZSA/IHNjZW5lIDogdW5kZWZpbmVkKTtcclxuICAgIH1cclxuICAgIHByaXZhdGUgX2FkZEZvcndhcmRSYWRpYW5jZVBhc3NlcyhcclxuICAgICAgICBwcGw6IHJlbmRlcmluZy5CYXNpY1BpcGVsaW5lLFxyXG4gICAgICAgIHBwbENvbmZpZ3M6IFJlYWRvbmx5PFBpcGVsaW5lQ29uZmlncz4sXHJcbiAgICAgICAgY2FtZXJhQ29uZmlnczogUmVhZG9ubHk8Q2FtZXJhQ29uZmlncyAmIEZvcndhcmRQYXNzQ29uZmlncz4sXHJcbiAgICAgICAgaWQ6IG51bWJlcixcclxuICAgICAgICBjYW1lcmE6IHJlbmRlcmVyLnNjZW5lLkNhbWVyYSxcclxuICAgICAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgICAgIG1haW5MaWdodDogcmVuZGVyZXIuc2NlbmUuRGlyZWN0aW9uYWxMaWdodCB8IG51bGwsXHJcbiAgICAgICAgY29sb3JOYW1lOiBzdHJpbmcsXHJcbiAgICAgICAgZGVwdGhTdGVuY2lsTmFtZTogc3RyaW5nLFxyXG4gICAgICAgIGRpc2FibGVNU0FBOiBib29sZWFuID0gZmFsc2UsXHJcbiAgICAgICAgZGVwdGhTdGVuY2lsU3RvcmVPcDogZ2Z4LlN0b3JlT3AgPSBTdG9yZU9wLkRJU0NBUkQsXHJcbiAgICApOiByZW5kZXJpbmcuQmFzaWNSZW5kZXJQYXNzQnVpbGRlciB7XHJcbiAgICAgICAgY29uc3QgUXVldWVIaW50ID0gcmVuZGVyaW5nLlF1ZXVlSGludDtcclxuICAgICAgICBjb25zdCBTY2VuZUZsYWdzID0gcmVuZGVyaW5nLlNjZW5lRmxhZ3M7XHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIC8vIER5bmFtaWMgc3RhdGVzXHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIC8vIFByZXBhcmUgY2FtZXJhIGNsZWFyIGNvbG9yXHJcbiAgICAgICAgY29uc3QgY2xlYXJDb2xvciA9IGNhbWVyYS5jbGVhckNvbG9yOyAvLyBSZWR1Y2UgQysrL1RTIGludGVyb3BcclxuICAgICAgICB0aGlzLl9jbGVhckNvbG9yLnggPSBjbGVhckNvbG9yLng7XHJcbiAgICAgICAgdGhpcy5fY2xlYXJDb2xvci55ID0gY2xlYXJDb2xvci55O1xyXG4gICAgICAgIHRoaXMuX2NsZWFyQ29sb3IueiA9IGNsZWFyQ29sb3IuejtcclxuICAgICAgICB0aGlzLl9jbGVhckNvbG9yLncgPSBjbGVhckNvbG9yLnc7XHJcblxyXG4gICAgICAgIC8vIFByZXBhcmUgY2FtZXJhIHZpZXdwb3J0XHJcbiAgICAgICAgY29uc3Qgdmlld3BvcnQgPSBjYW1lcmEudmlld3BvcnQ7IC8vIFJlZHVjZSBDKysvVFMgaW50ZXJvcFxyXG4gICAgICAgIHRoaXMuX3ZpZXdwb3J0LmxlZnQgPSBNYXRoLnJvdW5kKHZpZXdwb3J0LnggKiB3aWR0aCk7XHJcbiAgICAgICAgdGhpcy5fdmlld3BvcnQudG9wID0gTWF0aC5yb3VuZCh2aWV3cG9ydC55ICogaGVpZ2h0KTtcclxuICAgICAgICAvLyBIZXJlIHdlIG11c3QgdXNlIGNhbWVyYS52aWV3cG9ydC53aWR0aCBpbnN0ZWFkIG9mIGNhbWVyYS52aWV3cG9ydC56LCB3aGljaFxyXG4gICAgICAgIC8vIGlzIHVuZGVmaW5lZCBvbiBuYXRpdmUgcGxhdGZvcm0uIFRoZSBzYW1lIGFzIGNhbWVyYS52aWV3cG9ydC5oZWlnaHQuXHJcbiAgICAgICAgdGhpcy5fdmlld3BvcnQud2lkdGggPSBNYXRoLm1heChNYXRoLnJvdW5kKHZpZXdwb3J0LndpZHRoICogd2lkdGgpLCAxKTtcclxuICAgICAgICB0aGlzLl92aWV3cG9ydC5oZWlnaHQgPSBNYXRoLm1heChNYXRoLnJvdW5kKHZpZXdwb3J0LmhlaWdodCAqIGhlaWdodCksIDEpO1xyXG5cclxuICAgICAgICAvLyBNU0FBXHJcbiAgICAgICAgY29uc3QgZW5hYmxlTVNBQSA9ICFkaXNhYmxlTVNBQSAmJiBjYW1lcmFDb25maWdzLmVuYWJsZU1TQUE7XHJcbiAgICAgICAgYXNzZXJ0KCFlbmFibGVNU0FBIHx8IGNhbWVyYUNvbmZpZ3MuZW5hYmxlU2luZ2xlRm9yd2FyZFBhc3MpO1xyXG5cclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgLy8gRm9yd2FyZCBMaWdodGluZyAoTWFpbiBEaXJlY3Rpb25hbCBMaWdodClcclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgY29uc3QgcGFzcyA9IGNhbWVyYUNvbmZpZ3MuZW5hYmxlU2luZ2xlRm9yd2FyZFBhc3NcclxuICAgICAgICAgICAgPyB0aGlzLl9hZGRGb3J3YXJkU2luZ2xlUmFkaWFuY2VQYXNzKHBwbCwgcHBsQ29uZmlncywgY2FtZXJhQ29uZmlncyxcclxuICAgICAgICAgICAgICAgIGlkLCBjYW1lcmEsIGVuYWJsZU1TQUEsIHdpZHRoLCBoZWlnaHQsIG1haW5MaWdodCxcclxuICAgICAgICAgICAgICAgIGNvbG9yTmFtZSwgZGVwdGhTdGVuY2lsTmFtZSwgZGVwdGhTdGVuY2lsU3RvcmVPcClcclxuICAgICAgICAgICAgOiB0aGlzLl9hZGRGb3J3YXJkTXVsdGlwbGVSYWRpYW5jZVBhc3NlcyhwcGwsIGNhbWVyYUNvbmZpZ3MsXHJcbiAgICAgICAgICAgICAgICBpZCwgY2FtZXJhLCB3aWR0aCwgaGVpZ2h0LCBtYWluTGlnaHQsXHJcbiAgICAgICAgICAgICAgICBjb2xvck5hbWUsIGRlcHRoU3RlbmNpbE5hbWUsIGRlcHRoU3RlbmNpbFN0b3JlT3ApO1xyXG5cclxuICAgICAgICAvLyBQbGFuYXIgU2hhZG93XHJcbiAgICAgICAgaWYgKGNhbWVyYUNvbmZpZ3MuZW5hYmxlTWFpbkxpZ2h0UGxhbmFyU2hhZG93TWFwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2FkZFBsYW5hclNoYWRvd1F1ZXVlKGNhbWVyYSwgbWFpbkxpZ2h0LCBwYXNzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAvLyBGb3J3YXJkIExpZ2h0aW5nIChCbGVuZClcclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgLy8gQWRkIHRyYW5zcGFyZW50IHF1ZXVlXHJcblxyXG4gICAgICAgIGNvbnN0IHNjZW5lRmxhZ3MgPSBTY2VuZUZsYWdzLkJMRU5EIHxcclxuICAgICAgICAgICAgKGNhbWVyYS5nZW9tZXRyeVJlbmRlcmVyXHJcbiAgICAgICAgICAgICAgICA/IFNjZW5lRmxhZ3MuR0VPTUVUUllcclxuICAgICAgICAgICAgICAgIDogU2NlbmVGbGFncy5OT05FKTtcclxuXHJcbiAgICAgICAgcGFzc1xyXG4gICAgICAgICAgICAuYWRkUXVldWUoUXVldWVIaW50LkJMRU5EKVxyXG4gICAgICAgICAgICAuYWRkU2NlbmUoY2FtZXJhLCBzY2VuZUZsYWdzLCBtYWluTGlnaHQgfHwgdW5kZWZpbmVkKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHBhc3M7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIF9hZGRGb3J3YXJkU2luZ2xlUmFkaWFuY2VQYXNzKFxyXG4gICAgICAgIHBwbDogcmVuZGVyaW5nLkJhc2ljUGlwZWxpbmUsXHJcbiAgICAgICAgcHBsQ29uZmlnczogUmVhZG9ubHk8UGlwZWxpbmVDb25maWdzPixcclxuICAgICAgICBjYW1lcmFDb25maWdzOiBSZWFkb25seTxDYW1lcmFDb25maWdzICYgRm9yd2FyZFBhc3NDb25maWdzPixcclxuICAgICAgICBpZDogbnVtYmVyLFxyXG4gICAgICAgIGNhbWVyYTogcmVuZGVyZXIuc2NlbmUuQ2FtZXJhLFxyXG4gICAgICAgIGVuYWJsZU1TQUE6IGJvb2xlYW4sXHJcbiAgICAgICAgd2lkdGg6IG51bWJlcixcclxuICAgICAgICBoZWlnaHQ6IG51bWJlcixcclxuICAgICAgICBtYWluTGlnaHQ6IHJlbmRlcmVyLnNjZW5lLkRpcmVjdGlvbmFsTGlnaHQgfCBudWxsLFxyXG4gICAgICAgIGNvbG9yTmFtZTogc3RyaW5nLFxyXG4gICAgICAgIGRlcHRoU3RlbmNpbE5hbWU6IHN0cmluZyxcclxuICAgICAgICBkZXB0aFN0ZW5jaWxTdG9yZU9wOiBnZnguU3RvcmVPcFxyXG4gICAgKTogcmVuZGVyaW5nLkJhc2ljUmVuZGVyUGFzc0J1aWxkZXIge1xyXG4gICAgICAgIGFzc2VydChjYW1lcmFDb25maWdzLmVuYWJsZVNpbmdsZUZvcndhcmRQYXNzKTtcclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgLy8gRm9yd2FyZCBMaWdodGluZyAoTWFpbiBEaXJlY3Rpb25hbCBMaWdodClcclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgbGV0IHBhc3M6IHJlbmRlcmluZy5CYXNpY1JlbmRlclBhc3NCdWlsZGVyO1xyXG4gICAgICAgIGlmIChlbmFibGVNU0FBKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1zYWFSYWRpYW5jZU5hbWUgPSBgTXNhYVJhZGlhbmNlJHtpZH1gO1xyXG4gICAgICAgICAgICBjb25zdCBtc2FhRGVwdGhTdGVuY2lsTmFtZSA9IGBNc2FhRGVwdGhTdGVuY2lsJHtpZH1gO1xyXG4gICAgICAgICAgICBjb25zdCBzYW1wbGVDb3VudCA9IGNhbWVyYUNvbmZpZ3Muc2V0dGluZ3MubXNhYS5zYW1wbGVDb3VudDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1zUGFzcyA9IHBwbC5hZGRNdWx0aXNhbXBsZVJlbmRlclBhc3Mod2lkdGgsIGhlaWdodCwgc2FtcGxlQ291bnQsIDAsICdkZWZhdWx0Jyk7XHJcbiAgICAgICAgICAgIG1zUGFzcy5uYW1lID0gJ01zYWFGb3J3YXJkUGFzcyc7XHJcblxyXG4gICAgICAgICAgICAvLyBNU0FBIGFsd2F5cyBkaXNjYXJkcyBkZXB0aCBzdGVuY2lsXHJcbiAgICAgICAgICAgIHRoaXMuX2J1aWxkRm9yd2FyZE1haW5MaWdodFBhc3MobXNQYXNzLCBjYW1lcmFDb25maWdzLCBpZCwgY2FtZXJhLFxyXG4gICAgICAgICAgICAgICAgbXNhYVJhZGlhbmNlTmFtZSwgbXNhYURlcHRoU3RlbmNpbE5hbWUsIFN0b3JlT3AuRElTQ0FSRCwgbWFpbkxpZ2h0KTtcclxuXHJcbiAgICAgICAgICAgIG1zUGFzcy5yZXNvbHZlUmVuZGVyVGFyZ2V0KG1zYWFSYWRpYW5jZU5hbWUsIGNvbG9yTmFtZSk7XHJcblxyXG4gICAgICAgICAgICBwYXNzID0gbXNQYXNzO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBhc3MgPSBwcGwuYWRkUmVuZGVyUGFzcyh3aWR0aCwgaGVpZ2h0LCAnZGVmYXVsdCcpO1xyXG4gICAgICAgICAgICBwYXNzLm5hbWUgPSAnRm9yd2FyZFBhc3MnO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fYnVpbGRGb3J3YXJkTWFpbkxpZ2h0UGFzcyhwYXNzLCBjYW1lcmFDb25maWdzLCBpZCwgY2FtZXJhLFxyXG4gICAgICAgICAgICAgICAgY29sb3JOYW1lLCBkZXB0aFN0ZW5jaWxOYW1lLCBkZXB0aFN0ZW5jaWxTdG9yZU9wLCBtYWluTGlnaHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhc3NlcnQocGFzcyAhPT0gdW5kZWZpbmVkKTtcclxuXHJcbiAgICAgICAgLy8gRm9yd2FyZCBMaWdodGluZyAoQWRkaXRpdmUgTGlnaHRzKVxyXG4gICAgICAgIHRoaXMuZm9yd2FyZExpZ2h0aW5nLmFkZExpZ2h0UXVldWVzKFxyXG4gICAgICAgICAgICBwYXNzLFxyXG4gICAgICAgICAgICBjYW1lcmEsXHJcbiAgICAgICAgICAgIHBwbENvbmZpZ3MubW9iaWxlTWF4U3BvdExpZ2h0U2hhZG93TWFwcyxcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICByZXR1cm4gcGFzcztcclxuICAgIH1cclxuICAgIHByaXZhdGUgX2FkZEZvcndhcmRNdWx0aXBsZVJhZGlhbmNlUGFzc2VzKFxyXG4gICAgICAgIHBwbDogcmVuZGVyaW5nLkJhc2ljUGlwZWxpbmUsXHJcbiAgICAgICAgY2FtZXJhQ29uZmlnczogUmVhZG9ubHk8Q2FtZXJhQ29uZmlncyAmIEZvcndhcmRQYXNzQ29uZmlncz4sXHJcbiAgICAgICAgaWQ6IG51bWJlcixcclxuICAgICAgICBjYW1lcmE6IHJlbmRlcmVyLnNjZW5lLkNhbWVyYSxcclxuICAgICAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgICAgIG1haW5MaWdodDogcmVuZGVyZXIuc2NlbmUuRGlyZWN0aW9uYWxMaWdodCB8IG51bGwsXHJcbiAgICAgICAgY29sb3JOYW1lOiBzdHJpbmcsXHJcbiAgICAgICAgZGVwdGhTdGVuY2lsTmFtZTogc3RyaW5nLFxyXG4gICAgICAgIGRlcHRoU3RlbmNpbFN0b3JlT3A6IGdmeC5TdG9yZU9wXHJcbiAgICApOiByZW5kZXJpbmcuQmFzaWNSZW5kZXJQYXNzQnVpbGRlciB7XHJcbiAgICAgICAgYXNzZXJ0KCFjYW1lcmFDb25maWdzLmVuYWJsZVNpbmdsZUZvcndhcmRQYXNzKTtcclxuXHJcbiAgICAgICAgLy8gRm9yd2FyZCBMaWdodGluZyAoTWFpbiBEaXJlY3Rpb25hbCBMaWdodClcclxuICAgICAgICBsZXQgcGFzcyA9IHBwbC5hZGRSZW5kZXJQYXNzKHdpZHRoLCBoZWlnaHQsICdkZWZhdWx0Jyk7XHJcbiAgICAgICAgcGFzcy5uYW1lID0gJ0ZvcndhcmRQYXNzJztcclxuXHJcbiAgICAgICAgY29uc3QgZmlyc3RTdG9yZU9wID0gdGhpcy5mb3J3YXJkTGlnaHRpbmcuaXNNdWx0aXBsZUxpZ2h0UGFzc2VzTmVlZGVkKClcclxuICAgICAgICAgICAgPyBTdG9yZU9wLlNUT1JFXHJcbiAgICAgICAgICAgIDogZGVwdGhTdGVuY2lsU3RvcmVPcDtcclxuXHJcbiAgICAgICAgdGhpcy5fYnVpbGRGb3J3YXJkTWFpbkxpZ2h0UGFzcyhwYXNzLCBjYW1lcmFDb25maWdzLFxyXG4gICAgICAgICAgICBpZCwgY2FtZXJhLCBjb2xvck5hbWUsIGRlcHRoU3RlbmNpbE5hbWUsIGZpcnN0U3RvcmVPcCwgbWFpbkxpZ2h0KTtcclxuXHJcbiAgICAgICAgLy8gRm9yd2FyZCBMaWdodGluZyAoQWRkaXRpdmUgTGlnaHRzKVxyXG4gICAgICAgIHBhc3MgPSB0aGlzLmZvcndhcmRMaWdodGluZ1xyXG4gICAgICAgICAgICAuYWRkTGlnaHRQYXNzZXMoY29sb3JOYW1lLCBkZXB0aFN0ZW5jaWxOYW1lLCBkZXB0aFN0ZW5jaWxTdG9yZU9wLFxyXG4gICAgICAgICAgICAgICAgaWQsIHdpZHRoLCBoZWlnaHQsIGNhbWVyYSwgdGhpcy5fdmlld3BvcnQsIHBwbCwgcGFzcyk7XHJcblxyXG4gICAgICAgIHJldHVybiBwYXNzO1xyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBfYnVpbGRGb3J3YXJkTWFpbkxpZ2h0UGFzcyhcclxuICAgICAgICBwYXNzOiByZW5kZXJpbmcuQmFzaWNSZW5kZXJQYXNzQnVpbGRlcixcclxuICAgICAgICBjYW1lcmFDb25maWdzOiBSZWFkb25seTxDYW1lcmFDb25maWdzICYgRm9yd2FyZFBhc3NDb25maWdzPixcclxuICAgICAgICBpZDogbnVtYmVyLFxyXG4gICAgICAgIGNhbWVyYTogcmVuZGVyZXIuc2NlbmUuQ2FtZXJhLFxyXG4gICAgICAgIGNvbG9yTmFtZTogc3RyaW5nLFxyXG4gICAgICAgIGRlcHRoU3RlbmNpbE5hbWU6IHN0cmluZyxcclxuICAgICAgICBkZXB0aFN0ZW5jaWxTdG9yZU9wOiBnZnguU3RvcmVPcCxcclxuICAgICAgICBtYWluTGlnaHQ6IHJlbmRlcmVyLnNjZW5lLkRpcmVjdGlvbmFsTGlnaHQgfCBudWxsLFxyXG4gICAgICAgIHNjZW5lOiByZW5kZXJlci5SZW5kZXJTY2VuZSB8IG51bGwgPSBudWxsLFxyXG4gICAgKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgUXVldWVIaW50ID0gcmVuZGVyaW5nLlF1ZXVlSGludDtcclxuICAgICAgICBjb25zdCBTY2VuZUZsYWdzID0gcmVuZGVyaW5nLlNjZW5lRmxhZ3M7XHJcbiAgICAgICAgLy8gc2V0IHZpZXdwb3J0XHJcbiAgICAgICAgcGFzcy5zZXRWaWV3cG9ydCh0aGlzLl92aWV3cG9ydCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGNvbG9yU3RvcmVPcCA9IGNhbWVyYUNvbmZpZ3MuZW5hYmxlTVNBQSA/IFN0b3JlT3AuRElTQ0FSRCA6IFN0b3JlT3AuU1RPUkU7XHJcblxyXG4gICAgICAgIC8vIGJpbmQgb3V0cHV0IHJlbmRlciB0YXJnZXRcclxuICAgICAgICBpZiAoZm9yd2FyZE5lZWRDbGVhckNvbG9yKGNhbWVyYSkpIHtcclxuICAgICAgICAgICAgcGFzcy5hZGRSZW5kZXJUYXJnZXQoY29sb3JOYW1lLCBMb2FkT3AuQ0xFQVIsIGNvbG9yU3RvcmVPcCwgdGhpcy5fY2xlYXJDb2xvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcGFzcy5hZGRSZW5kZXJUYXJnZXQoY29sb3JOYW1lLCBMb2FkT3AuTE9BRCwgY29sb3JTdG9yZU9wKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGJpbmQgZGVwdGggc3RlbmNpbCBidWZmZXJcclxuICAgICAgICBpZiAoREVCVUcpIHtcclxuICAgICAgICAgICAgaWYgKGNvbG9yTmFtZSA9PT0gY2FtZXJhQ29uZmlncy5jb2xvck5hbWUgJiZcclxuICAgICAgICAgICAgICAgIGRlcHRoU3RlbmNpbE5hbWUgIT09IGNhbWVyYUNvbmZpZ3MuZGVwdGhTdGVuY2lsTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgd2FybignRGVmYXVsdCBmcmFtZWJ1ZmZlciBjYW5ub3QgdXNlIGN1c3RvbSBkZXB0aCBzdGVuY2lsIGJ1ZmZlcicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2FtZXJhLmNsZWFyRmxhZyAmIENsZWFyRmxhZ0JpdC5ERVBUSF9TVEVOQ0lMKSB7XHJcbiAgICAgICAgICAgIHBhc3MuYWRkRGVwdGhTdGVuY2lsKFxyXG4gICAgICAgICAgICAgICAgZGVwdGhTdGVuY2lsTmFtZSxcclxuICAgICAgICAgICAgICAgIExvYWRPcC5DTEVBUixcclxuICAgICAgICAgICAgICAgIGRlcHRoU3RlbmNpbFN0b3JlT3AsXHJcbiAgICAgICAgICAgICAgICBjYW1lcmEuY2xlYXJEZXB0aCxcclxuICAgICAgICAgICAgICAgIGNhbWVyYS5jbGVhclN0ZW5jaWwsXHJcbiAgICAgICAgICAgICAgICBjYW1lcmEuY2xlYXJGbGFnICYgQ2xlYXJGbGFnQml0LkRFUFRIX1NURU5DSUwsXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcGFzcy5hZGREZXB0aFN0ZW5jaWwoZGVwdGhTdGVuY2lsTmFtZSwgTG9hZE9wLkxPQUQsIGRlcHRoU3RlbmNpbFN0b3JlT3ApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU2V0IHNoYWRvdyBtYXAgaWYgZW5hYmxlZFxyXG4gICAgICAgIGlmIChjYW1lcmFDb25maWdzLmVuYWJsZU1haW5MaWdodFNoYWRvd01hcCkge1xyXG4gICAgICAgICAgICBwYXNzLmFkZFRleHR1cmUoYFNoYWRvd01hcCR7aWR9YCwgJ2NjX3NoYWRvd01hcCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVE9ETyh6aG91emhlbmdsb25nKTogU2VwYXJhdGUgT1BBUVVFIGFuZCBNQVNLIHF1ZXVlXHJcblxyXG4gICAgICAgIC8vIGFkZCBvcGFxdWUgYW5kIG1hc2sgcXVldWVcclxuICAgICAgICBwYXNzLmFkZFF1ZXVlKFF1ZXVlSGludC5OT05FKSAvLyBDdXJyZW50bHkgd2UgcHV0IE9QQVFVRSBhbmQgTUFTSyBpbnRvIG9uZSBxdWV1ZSwgc28gUXVldWVIaW50IGlzIE5PTkVcclxuICAgICAgICAgICAgLmFkZFNjZW5lKGNhbWVyYSxcclxuICAgICAgICAgICAgICAgIFNjZW5lRmxhZ3MuT1BBUVVFIHwgU2NlbmVGbGFncy5NQVNLLFxyXG4gICAgICAgICAgICAgICAgbWFpbkxpZ2h0IHx8IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIHNjZW5lID8gc2NlbmUgOiB1bmRlZmluZWQpO1xyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBfYWRkUGxhbmFyU2hhZG93UXVldWUoXHJcbiAgICAgICAgY2FtZXJhOiByZW5kZXJlci5zY2VuZS5DYW1lcmEsXHJcbiAgICAgICAgbWFpbkxpZ2h0OiByZW5kZXJlci5zY2VuZS5EaXJlY3Rpb25hbExpZ2h0IHwgbnVsbCxcclxuICAgICAgICBwYXNzOiByZW5kZXJpbmcuQmFzaWNSZW5kZXJQYXNzQnVpbGRlcixcclxuICAgICkge1xyXG4gICAgICAgIGNvbnN0IFF1ZXVlSGludCA9IHJlbmRlcmluZy5RdWV1ZUhpbnQ7XHJcbiAgICAgICAgY29uc3QgU2NlbmVGbGFncyA9IHJlbmRlcmluZy5TY2VuZUZsYWdzO1xyXG4gICAgICAgIHBhc3MuYWRkUXVldWUoUXVldWVIaW50LkJMRU5ELCAncGxhbmFyLXNoYWRvdycpXHJcbiAgICAgICAgICAgIC5hZGRTY2VuZShcclxuICAgICAgICAgICAgICAgIGNhbWVyYSxcclxuICAgICAgICAgICAgICAgIFNjZW5lRmxhZ3MuU0hBRE9XX0NBU1RFUiB8IFNjZW5lRmxhZ3MuUExBTkFSX1NIQURPVyB8IFNjZW5lRmxhZ3MuQkxFTkQsXHJcbiAgICAgICAgICAgICAgICBtYWluTGlnaHQgfHwgdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBmb3J3YXJkTGlnaHRpbmcgPSBuZXcgRm9yd2FyZExpZ2h0aW5nKCk7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF92aWV3cG9ydCA9IG5ldyBWaWV3cG9ydCgpO1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBfY2xlYXJDb2xvciA9IG5ldyBDb2xvcigwLCAwLCAwLCAxKTtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX3JlZmxlY3Rpb25Qcm9iZUNsZWFyQ29sb3IgPSBuZXcgVmVjMygwLCAwLCAwKTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBCbG9vbVBhc3NDb25maWdzIHtcclxuICAgIGVuYWJsZUJsb29tOiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQnVpbHRpbkJsb29tUGFzc0J1aWxkZXIgaW1wbGVtZW50cyByZW5kZXJpbmcuUGlwZWxpbmVQYXNzQnVpbGRlciB7XHJcbiAgICBnZXRDb25maWdPcmRlcigpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG4gICAgZ2V0UmVuZGVyT3JkZXIoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gMjAwO1xyXG4gICAgfVxyXG4gICAgY29uZmlnQ2FtZXJhKFxyXG4gICAgICAgIGNhbWVyYTogUmVhZG9ubHk8cmVuZGVyZXIuc2NlbmUuQ2FtZXJhPixcclxuICAgICAgICBwaXBlbGluZUNvbmZpZ3M6IFJlYWRvbmx5PFBpcGVsaW5lQ29uZmlncz4sXHJcbiAgICAgICAgY2FtZXJhQ29uZmlnczogQ2FtZXJhQ29uZmlncyAmIEJsb29tUGFzc0NvbmZpZ3MpOiB2b2lkIHtcclxuICAgICAgICBjYW1lcmFDb25maWdzLmVuYWJsZUJsb29tXHJcbiAgICAgICAgICAgID0gY2FtZXJhQ29uZmlncy5zZXR0aW5ncy5ibG9vbS5lbmFibGVkXHJcbiAgICAgICAgICAgICYmICEhY2FtZXJhQ29uZmlncy5zZXR0aW5ncy5ibG9vbS5tYXRlcmlhbDtcclxuICAgICAgICBpZiAoY2FtZXJhQ29uZmlncy5lbmFibGVCbG9vbSkge1xyXG4gICAgICAgICAgICArK2NhbWVyYUNvbmZpZ3MucmVtYWluaW5nUGFzc2VzO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHdpbmRvd1Jlc2l6ZShcclxuICAgICAgICBwcGw6IHJlbmRlcmluZy5CYXNpY1BpcGVsaW5lLFxyXG4gICAgICAgIHBwbENvbmZpZ3M6IFJlYWRvbmx5PFBpcGVsaW5lQ29uZmlncz4sXHJcbiAgICAgICAgY2FtZXJhQ29uZmlnczogQ2FtZXJhQ29uZmlncyAmIEJsb29tUGFzc0NvbmZpZ3MsXHJcbiAgICAgICAgd2luZG93OiByZW5kZXJlci5SZW5kZXJXaW5kb3cpOiB2b2lkIHtcclxuICAgICAgICBpZiAoY2FtZXJhQ29uZmlncy5lbmFibGVCbG9vbSkge1xyXG4gICAgICAgICAgICBjb25zdCBpZCA9IHdpbmRvdy5yZW5kZXJXaW5kb3dJZDtcclxuICAgICAgICAgICAgbGV0IGJsb29tV2lkdGggPSBjYW1lcmFDb25maWdzLndpZHRoO1xyXG4gICAgICAgICAgICBsZXQgYmxvb21IZWlnaHQgPSBjYW1lcmFDb25maWdzLmhlaWdodDtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IGNhbWVyYUNvbmZpZ3Muc2V0dGluZ3MuYmxvb20uaXRlcmF0aW9ucyArIDE7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgYmxvb21XaWR0aCA9IE1hdGgubWF4KE1hdGguZmxvb3IoYmxvb21XaWR0aCAvIDIpLCAxKTtcclxuICAgICAgICAgICAgICAgIGJsb29tSGVpZ2h0ID0gTWF0aC5tYXgoTWF0aC5mbG9vcihibG9vbUhlaWdodCAvIDIpLCAxKTtcclxuICAgICAgICAgICAgICAgIHBwbC5hZGRSZW5kZXJUYXJnZXQoYEJsb29tVGV4JHtpZH1fJHtpfWAsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5yYWRpYW5jZUZvcm1hdCwgYmxvb21XaWR0aCwgYmxvb21IZWlnaHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldHVwKFxyXG4gICAgICAgIHBwbDogcmVuZGVyaW5nLkJhc2ljUGlwZWxpbmUsXHJcbiAgICAgICAgcHBsQ29uZmlnczogUmVhZG9ubHk8UGlwZWxpbmVDb25maWdzPixcclxuICAgICAgICBjYW1lcmFDb25maWdzOiBDYW1lcmFDb25maWdzICYgQmxvb21QYXNzQ29uZmlncyxcclxuICAgICAgICBjYW1lcmE6IHJlbmRlcmVyLnNjZW5lLkNhbWVyYSxcclxuICAgICAgICBjb250ZXh0OiBQaXBlbGluZUNvbnRleHQsXHJcbiAgICAgICAgcHJldlJlbmRlclBhc3M/OiByZW5kZXJpbmcuQmFzaWNSZW5kZXJQYXNzQnVpbGRlcilcclxuICAgICAgICA6IHJlbmRlcmluZy5CYXNpY1JlbmRlclBhc3NCdWlsZGVyIHwgdW5kZWZpbmVkIHtcclxuICAgICAgICBpZiAoIWNhbWVyYUNvbmZpZ3MuZW5hYmxlQmxvb20pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHByZXZSZW5kZXJQYXNzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLS1jYW1lcmFDb25maWdzLnJlbWFpbmluZ1Bhc3NlcztcclxuICAgICAgICBhc3NlcnQoY2FtZXJhQ29uZmlncy5yZW1haW5pbmdQYXNzZXMgPj0gMCk7XHJcbiAgICAgICAgY29uc3QgaWQgPSBjYW1lcmEud2luZG93LnJlbmRlcldpbmRvd0lkO1xyXG4gICAgICAgIGFzc2VydCghIWNhbWVyYUNvbmZpZ3Muc2V0dGluZ3MuYmxvb20ubWF0ZXJpYWwpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9hZGRLYXdhc2VEdWFsRmlsdGVyQmxvb21QYXNzZXMoXHJcbiAgICAgICAgICAgIHBwbCwgcHBsQ29uZmlncyxcclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncyxcclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5zZXR0aW5ncyxcclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5zZXR0aW5ncy5ibG9vbS5tYXRlcmlhbCxcclxuICAgICAgICAgICAgaWQsXHJcbiAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3Mud2lkdGgsXHJcbiAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3MuaGVpZ2h0LFxyXG4gICAgICAgICAgICBjb250ZXh0LmNvbG9yTmFtZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfYWRkS2F3YXNlRHVhbEZpbHRlckJsb29tUGFzc2VzKFxyXG4gICAgICAgIHBwbDogcmVuZGVyaW5nLkJhc2ljUGlwZWxpbmUsXHJcbiAgICAgICAgcHBsQ29uZmlnczogUmVhZG9ubHk8UGlwZWxpbmVDb25maWdzPixcclxuICAgICAgICBjYW1lcmFDb25maWdzOiBDYW1lcmFDb25maWdzICYgUmVhZG9ubHk8Qmxvb21QYXNzQ29uZmlncz4sXHJcbiAgICAgICAgc2V0dGluZ3M6IFBpcGVsaW5lU2V0dGluZ3MsXHJcbiAgICAgICAgYmxvb21NYXRlcmlhbDogTWF0ZXJpYWwsXHJcbiAgICAgICAgaWQ6IG51bWJlcixcclxuICAgICAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgICAgIHJhZGlhbmNlTmFtZTogc3RyaW5nLFxyXG4gICAgKTogcmVuZGVyaW5nLkJhc2ljUmVuZGVyUGFzc0J1aWxkZXIge1xyXG4gICAgICAgIGNvbnN0IFF1ZXVlSGludCA9IHJlbmRlcmluZy5RdWV1ZUhpbnQ7XHJcbiAgICAgICAgLy8gQmFzZWQgb24gS2F3YXNlIER1YWwgRmlsdGVyIEJsdXIuIFNhdmVzIGJhbmR3aWR0aCBvbiBtb2JpbGUgZGV2aWNlcy5cclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxlblxyXG4gICAgICAgIC8vIGh0dHBzOi8vY29tbXVuaXR5LmFybS5jb20vY2ZzLWZpbGUvX19rZXkvY29tbXVuaXR5c2VydmVyLWJsb2dzLWNvbXBvbmVudHMtd2VibG9nZmlsZXMvMDAtMDAtMDAtMjAtNjYvc2lnZ3JhcGgyMDE1XzJEMDBfbW1nXzJEMDBfbWFyaXVzXzJEMDBfc2xpZGVzLnBkZlxyXG5cclxuICAgICAgICAvLyBTaXplOiBbcHJlZmlsdGVyKDEvMiksIGRvd25zYW1wbGUoMS80KSwgZG93bnNhbXBsZSgxLzgpLCBkb3duc2FtcGxlKDEvMTYpLCAuLi5dXHJcbiAgICAgICAgY29uc3QgaXRlcmF0aW9ucyA9IHNldHRpbmdzLmJsb29tLml0ZXJhdGlvbnM7XHJcbiAgICAgICAgY29uc3Qgc2l6ZUNvdW50ID0gaXRlcmF0aW9ucyArIDE7XHJcbiAgICAgICAgdGhpcy5fYmxvb21XaWR0aHMubGVuZ3RoID0gc2l6ZUNvdW50O1xyXG4gICAgICAgIHRoaXMuX2Jsb29tSGVpZ2h0cy5sZW5ndGggPSBzaXplQ291bnQ7XHJcbiAgICAgICAgdGhpcy5fYmxvb21XaWR0aHNbMF0gPSBNYXRoLm1heChNYXRoLmZsb29yKHdpZHRoIC8gMiksIDEpO1xyXG4gICAgICAgIHRoaXMuX2Jsb29tSGVpZ2h0c1swXSA9IE1hdGgubWF4KE1hdGguZmxvb3IoaGVpZ2h0IC8gMiksIDEpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpICE9PSBzaXplQ291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICB0aGlzLl9ibG9vbVdpZHRoc1tpXSA9IE1hdGgubWF4KE1hdGguZmxvb3IodGhpcy5fYmxvb21XaWR0aHNbaSAtIDFdIC8gMiksIDEpO1xyXG4gICAgICAgICAgICB0aGlzLl9ibG9vbUhlaWdodHNbaV0gPSBNYXRoLm1heChNYXRoLmZsb29yKHRoaXMuX2Jsb29tSGVpZ2h0c1tpIC0gMV0gLyAyKSwgMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBCbG9vbSB0ZXh0dXJlIG5hbWVzXHJcbiAgICAgICAgdGhpcy5fYmxvb21UZXhOYW1lcy5sZW5ndGggPSBzaXplQ291bnQ7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IHNpemVDb3VudDsgKytpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2Jsb29tVGV4TmFtZXNbaV0gPSBgQmxvb21UZXgke2lkfV8ke2l9YDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNldHVwIGJsb29tIHBhcmFtZXRlcnNcclxuICAgICAgICB0aGlzLl9ibG9vbVBhcmFtcy54ID0gcHBsQ29uZmlncy51c2VGbG9hdE91dHB1dCA/IDEgOiAwO1xyXG4gICAgICAgIHRoaXMuX2Jsb29tUGFyYW1zLnggPSAwOyAvLyB1bnVzZWRcclxuICAgICAgICB0aGlzLl9ibG9vbVBhcmFtcy56ID0gc2V0dGluZ3MuYmxvb20udGhyZXNob2xkO1xyXG4gICAgICAgIHRoaXMuX2Jsb29tUGFyYW1zLncgPSBzZXR0aW5ncy5ibG9vbS5lbmFibGVBbHBoYU1hc2sgPyAxIDogMDtcclxuXHJcbiAgICAgICAgLy8gUHJlZmlsdGVyIHBhc3NcclxuICAgICAgICBjb25zdCBwcmVmaWx0ZXJQYXNzID0gcHBsLmFkZFJlbmRlclBhc3ModGhpcy5fYmxvb21XaWR0aHNbMF0sIHRoaXMuX2Jsb29tSGVpZ2h0c1swXSwgJ2NjLWJsb29tLXByZWZpbHRlcicpO1xyXG4gICAgICAgIHByZWZpbHRlclBhc3MuYWRkUmVuZGVyVGFyZ2V0KFxyXG4gICAgICAgICAgICB0aGlzLl9ibG9vbVRleE5hbWVzWzBdLFxyXG4gICAgICAgICAgICBMb2FkT3AuQ0xFQVIsXHJcbiAgICAgICAgICAgIFN0b3JlT3AuU1RPUkUsXHJcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyQ29sb3JUcmFuc3BhcmVudEJsYWNrLFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcHJlZmlsdGVyUGFzcy5hZGRUZXh0dXJlKHJhZGlhbmNlTmFtZSwgJ2lucHV0VGV4dHVyZScpO1xyXG4gICAgICAgIHByZWZpbHRlclBhc3Muc2V0VmVjNCgnZ19wbGF0Zm9ybScsIHBwbENvbmZpZ3MucGxhdGZvcm0pO1xyXG4gICAgICAgIHByZWZpbHRlclBhc3Muc2V0VmVjNCgnYmxvb21QYXJhbXMnLCB0aGlzLl9ibG9vbVBhcmFtcyk7XHJcbiAgICAgICAgcHJlZmlsdGVyUGFzc1xyXG4gICAgICAgICAgICAuYWRkUXVldWUoUXVldWVIaW50Lk9QQVFVRSlcclxuICAgICAgICAgICAgLmFkZEZ1bGxzY3JlZW5RdWFkKGJsb29tTWF0ZXJpYWwsIDApO1xyXG5cclxuICAgICAgICAvLyBEb3duc2FtcGxlIHBhc3Nlc1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpICE9PSBzaXplQ291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICBjb25zdCBkb3duUGFzcyA9IHBwbC5hZGRSZW5kZXJQYXNzKHRoaXMuX2Jsb29tV2lkdGhzW2ldLCB0aGlzLl9ibG9vbUhlaWdodHNbaV0sICdjYy1ibG9vbS1kb3duc2FtcGxlJyk7XHJcbiAgICAgICAgICAgIGRvd25QYXNzLmFkZFJlbmRlclRhcmdldCh0aGlzLl9ibG9vbVRleE5hbWVzW2ldLCBMb2FkT3AuQ0xFQVIsIFN0b3JlT3AuU1RPUkUsIHRoaXMuX2NsZWFyQ29sb3JUcmFuc3BhcmVudEJsYWNrKTtcclxuICAgICAgICAgICAgZG93blBhc3MuYWRkVGV4dHVyZSh0aGlzLl9ibG9vbVRleE5hbWVzW2kgLSAxXSwgJ2Jsb29tVGV4dHVyZScpO1xyXG4gICAgICAgICAgICB0aGlzLl9ibG9vbVRleFNpemUueCA9IHRoaXMuX2Jsb29tV2lkdGhzW2kgLSAxXTtcclxuICAgICAgICAgICAgdGhpcy5fYmxvb21UZXhTaXplLnkgPSB0aGlzLl9ibG9vbUhlaWdodHNbaSAtIDFdO1xyXG4gICAgICAgICAgICBkb3duUGFzcy5zZXRWZWM0KCdnX3BsYXRmb3JtJywgcHBsQ29uZmlncy5wbGF0Zm9ybSk7XHJcbiAgICAgICAgICAgIGRvd25QYXNzLnNldFZlYzQoJ2Jsb29tVGV4U2l6ZScsIHRoaXMuX2Jsb29tVGV4U2l6ZSk7XHJcbiAgICAgICAgICAgIGRvd25QYXNzXHJcbiAgICAgICAgICAgICAgICAuYWRkUXVldWUoUXVldWVIaW50Lk9QQVFVRSlcclxuICAgICAgICAgICAgICAgIC5hZGRGdWxsc2NyZWVuUXVhZChibG9vbU1hdGVyaWFsLCAxKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFVwc2FtcGxlIHBhc3Nlc1xyXG4gICAgICAgIGZvciAobGV0IGkgPSBpdGVyYXRpb25zOyBpLS0gPiAwOykge1xyXG4gICAgICAgICAgICBjb25zdCB1cFBhc3MgPSBwcGwuYWRkUmVuZGVyUGFzcyh0aGlzLl9ibG9vbVdpZHRoc1tpXSwgdGhpcy5fYmxvb21IZWlnaHRzW2ldLCAnY2MtYmxvb20tdXBzYW1wbGUnKTtcclxuICAgICAgICAgICAgdXBQYXNzLmFkZFJlbmRlclRhcmdldCh0aGlzLl9ibG9vbVRleE5hbWVzW2ldLCBMb2FkT3AuQ0xFQVIsIFN0b3JlT3AuU1RPUkUsIHRoaXMuX2NsZWFyQ29sb3JUcmFuc3BhcmVudEJsYWNrKTtcclxuICAgICAgICAgICAgdXBQYXNzLmFkZFRleHR1cmUodGhpcy5fYmxvb21UZXhOYW1lc1tpICsgMV0sICdibG9vbVRleHR1cmUnKTtcclxuICAgICAgICAgICAgdGhpcy5fYmxvb21UZXhTaXplLnggPSB0aGlzLl9ibG9vbVdpZHRoc1tpICsgMV07XHJcbiAgICAgICAgICAgIHRoaXMuX2Jsb29tVGV4U2l6ZS55ID0gdGhpcy5fYmxvb21IZWlnaHRzW2kgKyAxXTtcclxuICAgICAgICAgICAgdXBQYXNzLnNldFZlYzQoJ2dfcGxhdGZvcm0nLCBwcGxDb25maWdzLnBsYXRmb3JtKTtcclxuICAgICAgICAgICAgdXBQYXNzLnNldFZlYzQoJ2Jsb29tVGV4U2l6ZScsIHRoaXMuX2Jsb29tVGV4U2l6ZSk7XHJcbiAgICAgICAgICAgIHVwUGFzc1xyXG4gICAgICAgICAgICAgICAgLmFkZFF1ZXVlKFF1ZXVlSGludC5PUEFRVUUpXHJcbiAgICAgICAgICAgICAgICAuYWRkRnVsbHNjcmVlblF1YWQoYmxvb21NYXRlcmlhbCwgMik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDb21iaW5lIHBhc3NcclxuICAgICAgICBjb25zdCBjb21iaW5lUGFzcyA9IHBwbC5hZGRSZW5kZXJQYXNzKHdpZHRoLCBoZWlnaHQsICdjYy1ibG9vbS1jb21iaW5lJyk7XHJcbiAgICAgICAgY29tYmluZVBhc3MuYWRkUmVuZGVyVGFyZ2V0KHJhZGlhbmNlTmFtZSwgTG9hZE9wLkxPQUQsIFN0b3JlT3AuU1RPUkUpO1xyXG4gICAgICAgIGNvbWJpbmVQYXNzLmFkZFRleHR1cmUodGhpcy5fYmxvb21UZXhOYW1lc1swXSwgJ2Jsb29tVGV4dHVyZScpO1xyXG4gICAgICAgIGNvbWJpbmVQYXNzLnNldFZlYzQoJ2dfcGxhdGZvcm0nLCBwcGxDb25maWdzLnBsYXRmb3JtKTtcclxuICAgICAgICBjb21iaW5lUGFzcy5zZXRWZWM0KCdibG9vbVBhcmFtcycsIHRoaXMuX2Jsb29tUGFyYW1zKTtcclxuICAgICAgICBjb21iaW5lUGFzc1xyXG4gICAgICAgICAgICAuYWRkUXVldWUoUXVldWVIaW50LkJMRU5EKVxyXG4gICAgICAgICAgICAuYWRkRnVsbHNjcmVlblF1YWQoYmxvb21NYXRlcmlhbCwgMyk7XHJcblxyXG4gICAgICAgIGlmIChjYW1lcmFDb25maWdzLnJlbWFpbmluZ1Bhc3NlcyA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYWRkQ29weVRvU2NyZWVuUGFzcyhwcGwsIHBwbENvbmZpZ3MsIGNhbWVyYUNvbmZpZ3MsIHJhZGlhbmNlTmFtZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbWJpbmVQYXNzO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIEJsb29tXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9jbGVhckNvbG9yVHJhbnNwYXJlbnRCbGFjayA9IG5ldyBDb2xvcigwLCAwLCAwLCAwKTtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX2Jsb29tUGFyYW1zID0gbmV3IFZlYzQoMCwgMCwgMCwgMCk7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9ibG9vbVRleFNpemUgPSBuZXcgVmVjNCgwLCAwLCAwLCAwKTtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX2Jsb29tV2lkdGhzOiBBcnJheTxudW1iZXI+ID0gW107XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9ibG9vbUhlaWdodHM6IEFycmF5PG51bWJlcj4gPSBbXTtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX2Jsb29tVGV4TmFtZXM6IEFycmF5PHN0cmluZz4gPSBbXTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBUb25lTWFwcGluZ1Bhc3NDb25maWdzIHtcclxuICAgIGVuYWJsZVRvbmVNYXBwaW5nOiBib29sZWFuO1xyXG4gICAgZW5hYmxlQ29sb3JHcmFkaW5nOiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQnVpbHRpblRvbmVNYXBwaW5nUGFzc0J1aWxkZXIgaW1wbGVtZW50cyByZW5kZXJpbmcuUGlwZWxpbmVQYXNzQnVpbGRlciB7XHJcbiAgICBnZXRDb25maWdPcmRlcigpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG4gICAgZ2V0UmVuZGVyT3JkZXIoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gMzAwO1xyXG4gICAgfVxyXG4gICAgY29uZmlnQ2FtZXJhKFxyXG4gICAgICAgIGNhbWVyYTogUmVhZG9ubHk8cmVuZGVyZXIuc2NlbmUuQ2FtZXJhPixcclxuICAgICAgICBwcGxDb25maWdzOiBSZWFkb25seTxQaXBlbGluZUNvbmZpZ3M+LFxyXG4gICAgICAgIGNhbWVyYUNvbmZpZ3M6IENhbWVyYUNvbmZpZ3MgJiBUb25lTWFwcGluZ1Bhc3NDb25maWdzKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBjYW1lcmFDb25maWdzLnNldHRpbmdzO1xyXG5cclxuICAgICAgICBjYW1lcmFDb25maWdzLmVuYWJsZUNvbG9yR3JhZGluZ1xyXG4gICAgICAgICAgICA9IHNldHRpbmdzLmNvbG9yR3JhZGluZy5lbmFibGVkXHJcbiAgICAgICAgICAgICYmICEhc2V0dGluZ3MuY29sb3JHcmFkaW5nLm1hdGVyaWFsXHJcbiAgICAgICAgICAgICYmICEhc2V0dGluZ3MuY29sb3JHcmFkaW5nLmNvbG9yR3JhZGluZ01hcDtcclxuXHJcbiAgICAgICAgY2FtZXJhQ29uZmlncy5lbmFibGVUb25lTWFwcGluZ1xyXG4gICAgICAgICAgICA9IGNhbWVyYUNvbmZpZ3MuZW5hYmxlSERSIC8vIEZyb20gSGFsZiB0byBSR0JBOFxyXG4gICAgICAgICAgICB8fCBjYW1lcmFDb25maWdzLmVuYWJsZUNvbG9yR3JhZGluZzsgLy8gQ29sb3IgZ3JhZGluZ1xyXG5cclxuICAgICAgICBpZiAoY2FtZXJhQ29uZmlncy5lbmFibGVUb25lTWFwcGluZykge1xyXG4gICAgICAgICAgICArK2NhbWVyYUNvbmZpZ3MucmVtYWluaW5nUGFzc2VzO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHdpbmRvd1Jlc2l6ZShcclxuICAgICAgICBwcGw6IHJlbmRlcmluZy5CYXNpY1BpcGVsaW5lLFxyXG4gICAgICAgIHBwbENvbmZpZ3M6IFJlYWRvbmx5PFBpcGVsaW5lQ29uZmlncz4sXHJcbiAgICAgICAgY2FtZXJhQ29uZmlnczogQ2FtZXJhQ29uZmlncyAmIFRvbmVNYXBwaW5nUGFzc0NvbmZpZ3MpOiB2b2lkIHtcclxuICAgICAgICBpZiAoY2FtZXJhQ29uZmlncy5lbmFibGVDb2xvckdyYWRpbmcpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KCEhY2FtZXJhQ29uZmlncy5zZXR0aW5ncy5jb2xvckdyYWRpbmcubWF0ZXJpYWwpO1xyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLnNldHRpbmdzLmNvbG9yR3JhZGluZy5tYXRlcmlhbC5zZXRQcm9wZXJ0eShcclxuICAgICAgICAgICAgICAgICdjb2xvckdyYWRpbmdNYXAnLFxyXG4gICAgICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5zZXR0aW5ncy5jb2xvckdyYWRpbmcuY29sb3JHcmFkaW5nTWFwKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBzZXR1cChcclxuICAgICAgICBwcGw6IHJlbmRlcmluZy5CYXNpY1BpcGVsaW5lLFxyXG4gICAgICAgIHBwbENvbmZpZ3M6IFJlYWRvbmx5PFBpcGVsaW5lQ29uZmlncz4sXHJcbiAgICAgICAgY2FtZXJhQ29uZmlnczogQ2FtZXJhQ29uZmlncyAmIFRvbmVNYXBwaW5nUGFzc0NvbmZpZ3MsXHJcbiAgICAgICAgY2FtZXJhOiByZW5kZXJlci5zY2VuZS5DYW1lcmEsXHJcbiAgICAgICAgY29udGV4dDogUGlwZWxpbmVDb250ZXh0LFxyXG4gICAgICAgIHByZXZSZW5kZXJQYXNzPzogcmVuZGVyaW5nLkJhc2ljUmVuZGVyUGFzc0J1aWxkZXIpXHJcbiAgICAgICAgOiByZW5kZXJpbmcuQmFzaWNSZW5kZXJQYXNzQnVpbGRlciB8IHVuZGVmaW5lZCB7XHJcbiAgICAgICAgaWYgKCFjYW1lcmFDb25maWdzLmVuYWJsZVRvbmVNYXBwaW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwcmV2UmVuZGVyUGFzcztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC0tY2FtZXJhQ29uZmlncy5yZW1haW5pbmdQYXNzZXM7XHJcbiAgICAgICAgYXNzZXJ0KGNhbWVyYUNvbmZpZ3MucmVtYWluaW5nUGFzc2VzID49IDApO1xyXG4gICAgICAgIGlmIChjYW1lcmFDb25maWdzLnJlbWFpbmluZ1Bhc3NlcyA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWRkQ29weUFuZFRvbmVtYXBQYXNzKHBwbCwgcHBsQ29uZmlncywgY2FtZXJhQ29uZmlncyxcclxuICAgICAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3Mud2lkdGgsIGNhbWVyYUNvbmZpZ3MuaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgY29udGV4dC5jb2xvck5hbWUsIGNhbWVyYUNvbmZpZ3MuY29sb3JOYW1lKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBpZCA9IGNhbWVyYUNvbmZpZ3MucmVuZGVyV2luZG93SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGxkckNvbG9yUHJlZml4ID0gY2FtZXJhQ29uZmlncy5lbmFibGVTaGFkaW5nU2NhbGVcclxuICAgICAgICAgICAgICAgID8gYFNjYWxlZExkckNvbG9yYFxyXG4gICAgICAgICAgICAgICAgOiBgTGRyQ29sb3JgO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbGRyQ29sb3JOYW1lID0gZ2V0UGluZ1BvbmdSZW5kZXJUYXJnZXQoY29udGV4dC5jb2xvck5hbWUsIGxkckNvbG9yUHJlZml4LCBpZCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHJhZGlhbmNlTmFtZSA9IGNvbnRleHQuY29sb3JOYW1lO1xyXG4gICAgICAgICAgICBjb250ZXh0LmNvbG9yTmFtZSA9IGxkckNvbG9yTmFtZTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hZGRDb3B5QW5kVG9uZW1hcFBhc3MocHBsLCBwcGxDb25maWdzLCBjYW1lcmFDb25maWdzLFxyXG4gICAgICAgICAgICAgICAgY2FtZXJhQ29uZmlncy53aWR0aCwgY2FtZXJhQ29uZmlncy5oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICByYWRpYW5jZU5hbWUsIGxkckNvbG9yTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBfYWRkQ29weUFuZFRvbmVtYXBQYXNzKFxyXG4gICAgICAgIHBwbDogcmVuZGVyaW5nLkJhc2ljUGlwZWxpbmUsXHJcbiAgICAgICAgcHBsQ29uZmlnczogUmVhZG9ubHk8UGlwZWxpbmVDb25maWdzPixcclxuICAgICAgICBjYW1lcmFDb25maWdzOiBDYW1lcmFDb25maWdzICYgVG9uZU1hcHBpbmdQYXNzQ29uZmlncyxcclxuICAgICAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgICAgIHJhZGlhbmNlTmFtZTogc3RyaW5nLFxyXG4gICAgICAgIGNvbG9yTmFtZTogc3RyaW5nLFxyXG4gICAgKTogcmVuZGVyaW5nLkJhc2ljUmVuZGVyUGFzc0J1aWxkZXIge1xyXG4gICAgICAgIGxldCBwYXNzOiByZW5kZXJpbmcuQmFzaWNSZW5kZXJQYXNzQnVpbGRlcjtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IGNhbWVyYUNvbmZpZ3Muc2V0dGluZ3M7XHJcbiAgICAgICAgaWYgKGNhbWVyYUNvbmZpZ3MuZW5hYmxlQ29sb3JHcmFkaW5nKSB7XHJcbiAgICAgICAgICAgIGFzc2VydCghIXNldHRpbmdzLmNvbG9yR3JhZGluZy5tYXRlcmlhbCk7XHJcbiAgICAgICAgICAgIGFzc2VydCghIXNldHRpbmdzLmNvbG9yR3JhZGluZy5jb2xvckdyYWRpbmdNYXApO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbHV0VGV4ID0gc2V0dGluZ3MuY29sb3JHcmFkaW5nLmNvbG9yR3JhZGluZ01hcDtcclxuICAgICAgICAgICAgdGhpcy5fY29sb3JHcmFkaW5nVGV4U2l6ZS54ID0gbHV0VGV4LndpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLl9jb2xvckdyYWRpbmdUZXhTaXplLnkgPSBsdXRUZXguaGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgY29uc3QgaXNTcXVhcmVNYXAgPSBsdXRUZXgud2lkdGggPT09IGx1dFRleC5oZWlnaHQ7XHJcbiAgICAgICAgICAgIGlmIChpc1NxdWFyZU1hcCkge1xyXG4gICAgICAgICAgICAgICAgcGFzcyA9IHBwbC5hZGRSZW5kZXJQYXNzKHdpZHRoLCBoZWlnaHQsICdjYy1jb2xvci1ncmFkaW5nLTh4OCcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcGFzcyA9IHBwbC5hZGRSZW5kZXJQYXNzKHdpZHRoLCBoZWlnaHQsICdjYy1jb2xvci1ncmFkaW5nLW54MScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhc3MuYWRkUmVuZGVyVGFyZ2V0KGNvbG9yTmFtZSwgTG9hZE9wLkNMRUFSLCBTdG9yZU9wLlNUT1JFLCBzQ2xlYXJDb2xvclRyYW5zcGFyZW50QmxhY2spO1xyXG4gICAgICAgICAgICBwYXNzLmFkZFRleHR1cmUocmFkaWFuY2VOYW1lLCAnc2NlbmVDb2xvck1hcCcpO1xyXG4gICAgICAgICAgICBwYXNzLnNldFZlYzQoJ2dfcGxhdGZvcm0nLCBwcGxDb25maWdzLnBsYXRmb3JtKTtcclxuICAgICAgICAgICAgcGFzcy5zZXRWZWMyKCdsdXRUZXh0dXJlU2l6ZScsIHRoaXMuX2NvbG9yR3JhZGluZ1RleFNpemUpO1xyXG4gICAgICAgICAgICBwYXNzLnNldEZsb2F0KCdjb250cmlidXRlJywgc2V0dGluZ3MuY29sb3JHcmFkaW5nLmNvbnRyaWJ1dGUpO1xyXG4gICAgICAgICAgICBwYXNzLmFkZFF1ZXVlKHJlbmRlcmluZy5RdWV1ZUhpbnQuT1BBUVVFKVxyXG4gICAgICAgICAgICAgICAgLmFkZEZ1bGxzY3JlZW5RdWFkKHNldHRpbmdzLmNvbG9yR3JhZGluZy5tYXRlcmlhbCwgaXNTcXVhcmVNYXAgPyAxIDogMCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcGFzcyA9IHBwbC5hZGRSZW5kZXJQYXNzKHdpZHRoLCBoZWlnaHQsICdjYy10b25lLW1hcHBpbmcnKTtcclxuICAgICAgICAgICAgcGFzcy5hZGRSZW5kZXJUYXJnZXQoY29sb3JOYW1lLCBMb2FkT3AuQ0xFQVIsIFN0b3JlT3AuU1RPUkUsIHNDbGVhckNvbG9yVHJhbnNwYXJlbnRCbGFjayk7XHJcbiAgICAgICAgICAgIHBhc3MuYWRkVGV4dHVyZShyYWRpYW5jZU5hbWUsICdpbnB1dFRleHR1cmUnKTtcclxuICAgICAgICAgICAgcGFzcy5zZXRWZWM0KCdnX3BsYXRmb3JtJywgcHBsQ29uZmlncy5wbGF0Zm9ybSk7XHJcbiAgICAgICAgICAgIGlmIChzZXR0aW5ncy50b25lTWFwcGluZy5tYXRlcmlhbCkge1xyXG4gICAgICAgICAgICAgICAgcGFzcy5hZGRRdWV1ZShyZW5kZXJpbmcuUXVldWVIaW50Lk9QQVFVRSlcclxuICAgICAgICAgICAgICAgICAgICAuYWRkRnVsbHNjcmVlblF1YWQoc2V0dGluZ3MudG9uZU1hcHBpbmcubWF0ZXJpYWwsIDApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KCEhY2FtZXJhQ29uZmlncy5jb3B5QW5kVG9uZW1hcE1hdGVyaWFsKTtcclxuICAgICAgICAgICAgICAgIHBhc3MuYWRkUXVldWUocmVuZGVyaW5nLlF1ZXVlSGludC5PUEFRVUUpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZEZ1bGxzY3JlZW5RdWFkKGNhbWVyYUNvbmZpZ3MuY29weUFuZFRvbmVtYXBNYXRlcmlhbCwgMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHBhc3M7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9jb2xvckdyYWRpbmdUZXhTaXplID0gbmV3IFZlYzIoMCwgMCk7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRlhBQVBhc3NDb25maWdzIHtcclxuICAgIGVuYWJsZUZYQUE6IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBCdWlsdGluRlhBQVBhc3NCdWlsZGVyIGltcGxlbWVudHMgcmVuZGVyaW5nLlBpcGVsaW5lUGFzc0J1aWxkZXIge1xyXG4gICAgZ2V0Q29uZmlnT3JkZXIoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICAgIGdldFJlbmRlck9yZGVyKCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIDQwMDtcclxuICAgIH1cclxuICAgIGNvbmZpZ0NhbWVyYShcclxuICAgICAgICBjYW1lcmE6IFJlYWRvbmx5PHJlbmRlcmVyLnNjZW5lLkNhbWVyYT4sXHJcbiAgICAgICAgcHBsQ29uZmlnczogUmVhZG9ubHk8UGlwZWxpbmVDb25maWdzPixcclxuICAgICAgICBjYW1lcmFDb25maWdzOiBDYW1lcmFDb25maWdzICYgRlhBQVBhc3NDb25maWdzKTogdm9pZCB7XHJcbiAgICAgICAgY2FtZXJhQ29uZmlncy5lbmFibGVGWEFBXHJcbiAgICAgICAgICAgID0gY2FtZXJhQ29uZmlncy5zZXR0aW5ncy5meGFhLmVuYWJsZWRcclxuICAgICAgICAgICAgJiYgISFjYW1lcmFDb25maWdzLnNldHRpbmdzLmZ4YWEubWF0ZXJpYWw7XHJcbiAgICAgICAgaWYgKGNhbWVyYUNvbmZpZ3MuZW5hYmxlRlhBQSkge1xyXG4gICAgICAgICAgICArK2NhbWVyYUNvbmZpZ3MucmVtYWluaW5nUGFzc2VzO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHNldHVwKFxyXG4gICAgICAgIHBwbDogcmVuZGVyaW5nLkJhc2ljUGlwZWxpbmUsXHJcbiAgICAgICAgcHBsQ29uZmlnczogUmVhZG9ubHk8UGlwZWxpbmVDb25maWdzPixcclxuICAgICAgICBjYW1lcmFDb25maWdzOiBDYW1lcmFDb25maWdzICYgRlhBQVBhc3NDb25maWdzLFxyXG4gICAgICAgIGNhbWVyYTogcmVuZGVyZXIuc2NlbmUuQ2FtZXJhLFxyXG4gICAgICAgIGNvbnRleHQ6IFBpcGVsaW5lQ29udGV4dCxcclxuICAgICAgICBwcmV2UmVuZGVyUGFzcz86IHJlbmRlcmluZy5CYXNpY1JlbmRlclBhc3NCdWlsZGVyKVxyXG4gICAgICAgIDogcmVuZGVyaW5nLkJhc2ljUmVuZGVyUGFzc0J1aWxkZXIgfCB1bmRlZmluZWQge1xyXG4gICAgICAgIGlmICghY2FtZXJhQ29uZmlncy5lbmFibGVGWEFBKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwcmV2UmVuZGVyUGFzcztcclxuICAgICAgICB9XHJcbiAgICAgICAgLS1jYW1lcmFDb25maWdzLnJlbWFpbmluZ1Bhc3NlcztcclxuICAgICAgICBhc3NlcnQoY2FtZXJhQ29uZmlncy5yZW1haW5pbmdQYXNzZXMgPj0gMCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGlkID0gY2FtZXJhQ29uZmlncy5yZW5kZXJXaW5kb3dJZDtcclxuICAgICAgICBjb25zdCBsZHJDb2xvclByZWZpeCA9IGNhbWVyYUNvbmZpZ3MuZW5hYmxlU2hhZGluZ1NjYWxlXHJcbiAgICAgICAgICAgID8gYFNjYWxlZExkckNvbG9yYFxyXG4gICAgICAgICAgICA6IGBMZHJDb2xvcmA7XHJcbiAgICAgICAgY29uc3QgbGRyQ29sb3JOYW1lID0gZ2V0UGluZ1BvbmdSZW5kZXJUYXJnZXQoY29udGV4dC5jb2xvck5hbWUsIGxkckNvbG9yUHJlZml4LCBpZCk7XHJcblxyXG4gICAgICAgIGFzc2VydCghIWNhbWVyYUNvbmZpZ3Muc2V0dGluZ3MuZnhhYS5tYXRlcmlhbCk7XHJcbiAgICAgICAgaWYgKGNhbWVyYUNvbmZpZ3MucmVtYWluaW5nUGFzc2VzID09PSAwKSB7XHJcbiAgICAgICAgICAgIGlmIChjYW1lcmFDb25maWdzLmVuYWJsZVNoYWRpbmdTY2FsZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYWRkRnhhYVBhc3MocHBsLCBwcGxDb25maWdzLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3Muc2V0dGluZ3MuZnhhYS5tYXRlcmlhbCxcclxuICAgICAgICAgICAgICAgICAgICBjYW1lcmFDb25maWdzLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3MuaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuY29sb3JOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIGxkckNvbG9yTmFtZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYWRkQ29weVRvU2NyZWVuUGFzcyhwcGwsIHBwbENvbmZpZ3MsIGNhbWVyYUNvbmZpZ3MsIGxkckNvbG9yTmFtZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoY2FtZXJhQ29uZmlncy53aWR0aCA9PT0gY2FtZXJhQ29uZmlncy5uYXRpdmVXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoY2FtZXJhQ29uZmlncy5oZWlnaHQgPT09IGNhbWVyYUNvbmZpZ3MubmF0aXZlSGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9hZGRGeGFhUGFzcyhwcGwsIHBwbENvbmZpZ3MsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5zZXR0aW5ncy5meGFhLm1hdGVyaWFsLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3Mud2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5jb2xvck5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5jb2xvck5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgaW5wdXRDb2xvck5hbWUgPSBjb250ZXh0LmNvbG9yTmFtZTtcclxuICAgICAgICAgICAgY29udGV4dC5jb2xvck5hbWUgPSBsZHJDb2xvck5hbWU7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhc3RQYXNzID0gdGhpcy5fYWRkRnhhYVBhc3MocHBsLCBwcGxDb25maWdzLFxyXG4gICAgICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5zZXR0aW5ncy5meGFhLm1hdGVyaWFsLFxyXG4gICAgICAgICAgICAgICAgY2FtZXJhQ29uZmlncy53aWR0aCxcclxuICAgICAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3MuaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgaW5wdXRDb2xvck5hbWUsXHJcbiAgICAgICAgICAgICAgICBsZHJDb2xvck5hbWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbGFzdFBhc3M7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBfYWRkRnhhYVBhc3MoXHJcbiAgICAgICAgcHBsOiByZW5kZXJpbmcuQmFzaWNQaXBlbGluZSxcclxuICAgICAgICBwcGxDb25maWdzOiBSZWFkb25seTxQaXBlbGluZUNvbmZpZ3M+LFxyXG4gICAgICAgIGZ4YWFNYXRlcmlhbDogTWF0ZXJpYWwsXHJcbiAgICAgICAgd2lkdGg6IG51bWJlcixcclxuICAgICAgICBoZWlnaHQ6IG51bWJlcixcclxuICAgICAgICBsZHJDb2xvck5hbWU6IHN0cmluZyxcclxuICAgICAgICBjb2xvck5hbWU6IHN0cmluZyxcclxuICAgICk6IHJlbmRlcmluZy5CYXNpY1JlbmRlclBhc3NCdWlsZGVyIHtcclxuICAgICAgICB0aGlzLl9meGFhUGFyYW1zLnggPSB3aWR0aDtcclxuICAgICAgICB0aGlzLl9meGFhUGFyYW1zLnkgPSBoZWlnaHQ7XHJcbiAgICAgICAgdGhpcy5fZnhhYVBhcmFtcy56ID0gMSAvIHdpZHRoO1xyXG4gICAgICAgIHRoaXMuX2Z4YWFQYXJhbXMudyA9IDEgLyBoZWlnaHQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHBhc3MgPSBwcGwuYWRkUmVuZGVyUGFzcyh3aWR0aCwgaGVpZ2h0LCAnY2MtZnhhYScpO1xyXG4gICAgICAgIHBhc3MuYWRkUmVuZGVyVGFyZ2V0KGNvbG9yTmFtZSwgTG9hZE9wLkNMRUFSLCBTdG9yZU9wLlNUT1JFLCBzQ2xlYXJDb2xvclRyYW5zcGFyZW50QmxhY2spO1xyXG4gICAgICAgIHBhc3MuYWRkVGV4dHVyZShsZHJDb2xvck5hbWUsICdzY2VuZUNvbG9yTWFwJyk7XHJcbiAgICAgICAgcGFzcy5zZXRWZWM0KCdnX3BsYXRmb3JtJywgcHBsQ29uZmlncy5wbGF0Zm9ybSk7XHJcbiAgICAgICAgcGFzcy5zZXRWZWM0KCd0ZXhTaXplJywgdGhpcy5fZnhhYVBhcmFtcyk7XHJcbiAgICAgICAgcGFzcy5hZGRRdWV1ZShyZW5kZXJpbmcuUXVldWVIaW50Lk9QQVFVRSlcclxuICAgICAgICAgICAgLmFkZEZ1bGxzY3JlZW5RdWFkKGZ4YWFNYXRlcmlhbCwgMCk7XHJcbiAgICAgICAgcmV0dXJuIHBhc3M7XHJcbiAgICB9XHJcbiAgICAvLyBGWEFBXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9meGFhUGFyYW1zID0gbmV3IFZlYzQoMCwgMCwgMCwgMCk7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRlNSUGFzc0NvbmZpZ3Mge1xyXG4gICAgZW5hYmxlRlNSOiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQnVpbHRpbkZzclBhc3NCdWlsZGVyIGltcGxlbWVudHMgcmVuZGVyaW5nLlBpcGVsaW5lUGFzc0J1aWxkZXIge1xyXG4gICAgZ2V0Q29uZmlnT3JkZXIoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICAgIGdldFJlbmRlck9yZGVyKCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIDUwMDtcclxuICAgIH1cclxuICAgIGNvbmZpZ0NhbWVyYShcclxuICAgICAgICBjYW1lcmE6IFJlYWRvbmx5PHJlbmRlcmVyLnNjZW5lLkNhbWVyYT4sXHJcbiAgICAgICAgcHBsQ29uZmlnczogUmVhZG9ubHk8UGlwZWxpbmVDb25maWdzPixcclxuICAgICAgICBjYW1lcmFDb25maWdzOiBDYW1lcmFDb25maWdzICYgRlNSUGFzc0NvbmZpZ3MpOiB2b2lkIHtcclxuICAgICAgICAvLyBGU1IgKERlcGVuZCBvbiBTaGFkaW5nIHNjYWxlKVxyXG4gICAgICAgIGNhbWVyYUNvbmZpZ3MuZW5hYmxlRlNSID0gY2FtZXJhQ29uZmlncy5zZXR0aW5ncy5mc3IuZW5hYmxlZFxyXG4gICAgICAgICAgICAmJiAhIWNhbWVyYUNvbmZpZ3Muc2V0dGluZ3MuZnNyLm1hdGVyaWFsXHJcbiAgICAgICAgICAgICYmIGNhbWVyYUNvbmZpZ3MuZW5hYmxlU2hhZGluZ1NjYWxlXHJcbiAgICAgICAgICAgICYmIGNhbWVyYUNvbmZpZ3Muc2hhZGluZ1NjYWxlIDwgMS4wO1xyXG5cclxuICAgICAgICBpZiAoY2FtZXJhQ29uZmlncy5lbmFibGVGU1IpIHtcclxuICAgICAgICAgICAgKytjYW1lcmFDb25maWdzLnJlbWFpbmluZ1Bhc3NlcztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBzZXR1cChcclxuICAgICAgICBwcGw6IHJlbmRlcmluZy5CYXNpY1BpcGVsaW5lLFxyXG4gICAgICAgIHBwbENvbmZpZ3M6IFJlYWRvbmx5PFBpcGVsaW5lQ29uZmlncz4sXHJcbiAgICAgICAgY2FtZXJhQ29uZmlnczogQ2FtZXJhQ29uZmlncyAmIEZTUlBhc3NDb25maWdzLFxyXG4gICAgICAgIGNhbWVyYTogcmVuZGVyZXIuc2NlbmUuQ2FtZXJhLFxyXG4gICAgICAgIGNvbnRleHQ6IFBpcGVsaW5lQ29udGV4dCxcclxuICAgICAgICBwcmV2UmVuZGVyUGFzcz86IHJlbmRlcmluZy5CYXNpY1JlbmRlclBhc3NCdWlsZGVyKVxyXG4gICAgICAgIDogcmVuZGVyaW5nLkJhc2ljUmVuZGVyUGFzc0J1aWxkZXIgfCB1bmRlZmluZWQge1xyXG4gICAgICAgIGlmICghY2FtZXJhQ29uZmlncy5lbmFibGVGU1IpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHByZXZSZW5kZXJQYXNzO1xyXG4gICAgICAgIH1cclxuICAgICAgICAtLWNhbWVyYUNvbmZpZ3MucmVtYWluaW5nUGFzc2VzO1xyXG5cclxuICAgICAgICBjb25zdCBpbnB1dENvbG9yTmFtZSA9IGNvbnRleHQuY29sb3JOYW1lO1xyXG4gICAgICAgIGNvbnN0IG91dHB1dENvbG9yTmFtZVxyXG4gICAgICAgICAgICA9IGNhbWVyYUNvbmZpZ3MucmVtYWluaW5nUGFzc2VzID09PSAwXHJcbiAgICAgICAgICAgICAgICA/IGNhbWVyYUNvbmZpZ3MuY29sb3JOYW1lXHJcbiAgICAgICAgICAgICAgICA6IGdldFBpbmdQb25nUmVuZGVyVGFyZ2V0KGNvbnRleHQuY29sb3JOYW1lLCAnVWlDb2xvcicsIGNhbWVyYUNvbmZpZ3MucmVuZGVyV2luZG93SWQpO1xyXG4gICAgICAgIGNvbnRleHQuY29sb3JOYW1lID0gb3V0cHV0Q29sb3JOYW1lO1xyXG5cclxuICAgICAgICBhc3NlcnQoISFjYW1lcmFDb25maWdzLnNldHRpbmdzLmZzci5tYXRlcmlhbCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FkZEZzclBhc3MocHBsLCBwcGxDb25maWdzLCBjYW1lcmFDb25maWdzLFxyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLnNldHRpbmdzLFxyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLnNldHRpbmdzLmZzci5tYXRlcmlhbCxcclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5yZW5kZXJXaW5kb3dJZCxcclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncy53aWR0aCxcclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5oZWlnaHQsXHJcbiAgICAgICAgICAgIGlucHV0Q29sb3JOYW1lLFxyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLm5hdGl2ZVdpZHRoLFxyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLm5hdGl2ZUhlaWdodCxcclxuICAgICAgICAgICAgb3V0cHV0Q29sb3JOYW1lKTtcclxuICAgIH1cclxuICAgIHByaXZhdGUgX2FkZEZzclBhc3MoXHJcbiAgICAgICAgcHBsOiByZW5kZXJpbmcuQmFzaWNQaXBlbGluZSxcclxuICAgICAgICBwcGxDb25maWdzOiBSZWFkb25seTxQaXBlbGluZUNvbmZpZ3M+LFxyXG4gICAgICAgIGNhbWVyYUNvbmZpZ3M6IENhbWVyYUNvbmZpZ3MgJiBGU1JQYXNzQ29uZmlncyxcclxuICAgICAgICBzZXR0aW5nczogUGlwZWxpbmVTZXR0aW5ncyxcclxuICAgICAgICBmc3JNYXRlcmlhbDogTWF0ZXJpYWwsXHJcbiAgICAgICAgaWQ6IG51bWJlcixcclxuICAgICAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgICAgIGlucHV0Q29sb3JOYW1lOiBzdHJpbmcsXHJcbiAgICAgICAgbmF0aXZlV2lkdGg6IG51bWJlcixcclxuICAgICAgICBuYXRpdmVIZWlnaHQ6IG51bWJlcixcclxuICAgICAgICBvdXRwdXRDb2xvck5hbWU6IHN0cmluZyxcclxuICAgICk6IHJlbmRlcmluZy5CYXNpY1JlbmRlclBhc3NCdWlsZGVyIHtcclxuICAgICAgICB0aGlzLl9mc3JUZXhTaXplLnggPSB3aWR0aDtcclxuICAgICAgICB0aGlzLl9mc3JUZXhTaXplLnkgPSBoZWlnaHQ7XHJcbiAgICAgICAgdGhpcy5fZnNyVGV4U2l6ZS56ID0gbmF0aXZlV2lkdGg7XHJcbiAgICAgICAgdGhpcy5fZnNyVGV4U2l6ZS53ID0gbmF0aXZlSGVpZ2h0O1xyXG4gICAgICAgIHRoaXMuX2ZzclBhcmFtcy54ID0gY2xhbXAoMS4wIC0gc2V0dGluZ3MuZnNyLnNoYXJwbmVzcywgMC4wMiwgMC45OCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHVpQ29sb3JQcmVmaXggPSAnVWlDb2xvcic7XHJcblxyXG4gICAgICAgIGNvbnN0IGZzckNvbG9yTmFtZSA9IGdldFBpbmdQb25nUmVuZGVyVGFyZ2V0KG91dHB1dENvbG9yTmFtZSwgdWlDb2xvclByZWZpeCwgaWQpO1xyXG5cclxuICAgICAgICBjb25zdCBlYXN1UGFzcyA9IHBwbC5hZGRSZW5kZXJQYXNzKG5hdGl2ZVdpZHRoLCBuYXRpdmVIZWlnaHQsICdjYy1mc3ItZWFzdScpO1xyXG4gICAgICAgIGVhc3VQYXNzLmFkZFJlbmRlclRhcmdldChmc3JDb2xvck5hbWUsIExvYWRPcC5DTEVBUiwgU3RvcmVPcC5TVE9SRSwgc0NsZWFyQ29sb3JUcmFuc3BhcmVudEJsYWNrKTtcclxuICAgICAgICBlYXN1UGFzcy5hZGRUZXh0dXJlKGlucHV0Q29sb3JOYW1lLCAnb3V0cHV0UmVzdWx0TWFwJyk7XHJcbiAgICAgICAgZWFzdVBhc3Muc2V0VmVjNCgnZ19wbGF0Zm9ybScsIHBwbENvbmZpZ3MucGxhdGZvcm0pO1xyXG4gICAgICAgIGVhc3VQYXNzLnNldFZlYzQoJ2ZzclRleFNpemUnLCB0aGlzLl9mc3JUZXhTaXplKTtcclxuICAgICAgICBlYXN1UGFzc1xyXG4gICAgICAgICAgICAuYWRkUXVldWUocmVuZGVyaW5nLlF1ZXVlSGludC5PUEFRVUUpXHJcbiAgICAgICAgICAgIC5hZGRGdWxsc2NyZWVuUXVhZChmc3JNYXRlcmlhbCwgMCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJjYXNQYXNzID0gcHBsLmFkZFJlbmRlclBhc3MobmF0aXZlV2lkdGgsIG5hdGl2ZUhlaWdodCwgJ2NjLWZzci1yY2FzJyk7XHJcbiAgICAgICAgcmNhc1Bhc3MuYWRkUmVuZGVyVGFyZ2V0KG91dHB1dENvbG9yTmFtZSwgTG9hZE9wLkNMRUFSLCBTdG9yZU9wLlNUT1JFLCBzQ2xlYXJDb2xvclRyYW5zcGFyZW50QmxhY2spO1xyXG4gICAgICAgIHJjYXNQYXNzLmFkZFRleHR1cmUoZnNyQ29sb3JOYW1lLCAnb3V0cHV0UmVzdWx0TWFwJyk7XHJcbiAgICAgICAgcmNhc1Bhc3Muc2V0VmVjNCgnZ19wbGF0Zm9ybScsIHBwbENvbmZpZ3MucGxhdGZvcm0pO1xyXG4gICAgICAgIHJjYXNQYXNzLnNldFZlYzQoJ2ZzclRleFNpemUnLCB0aGlzLl9mc3JUZXhTaXplKTtcclxuICAgICAgICByY2FzUGFzcy5zZXRWZWM0KCdmc3JQYXJhbXMnLCB0aGlzLl9mc3JQYXJhbXMpO1xyXG4gICAgICAgIHJjYXNQYXNzXHJcbiAgICAgICAgICAgIC5hZGRRdWV1ZShyZW5kZXJpbmcuUXVldWVIaW50Lk9QQVFVRSlcclxuICAgICAgICAgICAgLmFkZEZ1bGxzY3JlZW5RdWFkKGZzck1hdGVyaWFsLCAxKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJjYXNQYXNzO1xyXG4gICAgfVxyXG4gICAgLy8gRlNSXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9mc3JQYXJhbXMgPSBuZXcgVmVjNCgwLCAwLCAwLCAwKTtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX2ZzclRleFNpemUgPSBuZXcgVmVjNCgwLCAwLCAwLCAwKTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEJ1aWx0aW5VaVBhc3NCdWlsZGVyIGltcGxlbWVudHMgcmVuZGVyaW5nLlBpcGVsaW5lUGFzc0J1aWxkZXIge1xyXG4gICAgZ2V0Q29uZmlnT3JkZXIoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuICAgIGdldFJlbmRlck9yZGVyKCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIDEwMDA7XHJcbiAgICB9XHJcbiAgICBzZXR1cChcclxuICAgICAgICBwcGw6IHJlbmRlcmluZy5CYXNpY1BpcGVsaW5lLFxyXG4gICAgICAgIHBwbENvbmZpZ3M6IFJlYWRvbmx5PFBpcGVsaW5lQ29uZmlncz4sXHJcbiAgICAgICAgY2FtZXJhQ29uZmlnczogQ2FtZXJhQ29uZmlncyAmIEZTUlBhc3NDb25maWdzLFxyXG4gICAgICAgIGNhbWVyYTogcmVuZGVyZXIuc2NlbmUuQ2FtZXJhLFxyXG4gICAgICAgIGNvbnRleHQ6IFBpcGVsaW5lQ29udGV4dCxcclxuICAgICAgICBwcmV2UmVuZGVyUGFzcz86IHJlbmRlcmluZy5CYXNpY1JlbmRlclBhc3NCdWlsZGVyKVxyXG4gICAgICAgIDogcmVuZGVyaW5nLkJhc2ljUmVuZGVyUGFzc0J1aWxkZXIgfCB1bmRlZmluZWQge1xyXG4gICAgICAgIGFzc2VydCghIXByZXZSZW5kZXJQYXNzKTtcclxuXHJcbiAgICAgICAgbGV0IGZsYWdzID0gcmVuZGVyaW5nLlNjZW5lRmxhZ3MuVUk7XHJcbiAgICAgICAgaWYgKGNhbWVyYUNvbmZpZ3MuZW5hYmxlUHJvZmlsZXIpIHtcclxuICAgICAgICAgICAgZmxhZ3MgfD0gcmVuZGVyaW5nLlNjZW5lRmxhZ3MuUFJPRklMRVI7XHJcbiAgICAgICAgICAgIHByZXZSZW5kZXJQYXNzLnNob3dTdGF0aXN0aWNzID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcHJldlJlbmRlclBhc3NcclxuICAgICAgICAgICAgLmFkZFF1ZXVlKHJlbmRlcmluZy5RdWV1ZUhpbnQuQkxFTkQsICdkZWZhdWx0JywgJ2RlZmF1bHQnKVxyXG4gICAgICAgICAgICAuYWRkU2NlbmUoY2FtZXJhLCBmbGFncyk7XHJcblxyXG4gICAgICAgIHJldHVybiBwcmV2UmVuZGVyUGFzcztcclxuICAgIH1cclxufVxyXG5cclxuaWYgKHJlbmRlcmluZykge1xyXG5cclxuICAgIGNvbnN0IHsgUXVldWVIaW50LCBTY2VuZUZsYWdzIH0gPSByZW5kZXJpbmc7XHJcblxyXG4gICAgY2xhc3MgQnVpbHRpblBpcGVsaW5lQnVpbGRlciBpbXBsZW1lbnRzIHJlbmRlcmluZy5QaXBlbGluZUJ1aWxkZXIge1xyXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgX3BpcGVsaW5lRXZlbnQ6IFBpcGVsaW5lRXZlbnRQcm9jZXNzb3IgPSBjY2xlZ2FjeS5kaXJlY3Rvci5yb290LnBpcGVsaW5lRXZlbnQgYXMgUGlwZWxpbmVFdmVudFByb2Nlc3NvcjtcclxuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IF9mb3J3YXJkUGFzcyA9IG5ldyBCdWlsdGluRm9yd2FyZFBhc3NCdWlsZGVyKCk7XHJcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBfYmxvb21QYXNzID0gbmV3IEJ1aWx0aW5CbG9vbVBhc3NCdWlsZGVyKCk7XHJcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBfdG9uZU1hcHBpbmdQYXNzID0gbmV3IEJ1aWx0aW5Ub25lTWFwcGluZ1Bhc3NCdWlsZGVyKCk7XHJcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBfZnhhYVBhc3MgPSBuZXcgQnVpbHRpbkZYQUFQYXNzQnVpbGRlcigpO1xyXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgX2ZzclBhc3MgPSBuZXcgQnVpbHRpbkZzclBhc3NCdWlsZGVyKCk7XHJcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBfdWlQYXNzID0gbmV3IEJ1aWx0aW5VaVBhc3NCdWlsZGVyKCk7XHJcbiAgICAgICAgLy8gSW50ZXJuYWwgY2FjaGVkIHJlc291cmNlc1xyXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgX2NsZWFyQ29sb3IgPSBuZXcgQ29sb3IoMCwgMCwgMCwgMSk7XHJcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBfdmlld3BvcnQgPSBuZXcgVmlld3BvcnQoKTtcclxuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IF9jb25maWdzID0gbmV3IFBpcGVsaW5lQ29uZmlncygpO1xyXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgX2NhbWVyYUNvbmZpZ3MgPSBuZXcgQ2FtZXJhQ29uZmlncygpO1xyXG4gICAgICAgIC8vIE1hdGVyaWFsc1xyXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgX2NvcHlBbmRUb25lbWFwTWF0ZXJpYWwgPSBuZXcgTWF0ZXJpYWwoKTtcclxuXHJcbiAgICAgICAgLy8gSW50ZXJuYWwgU3RhdGVzXHJcbiAgICAgICAgcHJpdmF0ZSBfaW5pdGlhbGl6ZWQgPSBmYWxzZTsgLy8gVE9ETyh6aG91emhlbmdsb25nKTogTWFrZSBkZWZhdWx0IGVmZmVjdCBhc3NldCBsb2FkaW5nIGVhcmxpZXIgYW5kIHJlbW92ZSB0aGlzIGZsYWdcclxuICAgICAgICBwcml2YXRlIF9wYXNzQnVpbGRlcnM6IHJlbmRlcmluZy5QaXBlbGluZVBhc3NCdWlsZGVyW10gPSBbXTtcclxuXHJcbiAgICAgICAgcHJpdmF0ZSBfc2V0dXBQaXBlbGluZVByZXZpZXcoXHJcbiAgICAgICAgICAgIGNhbWVyYTogcmVuZGVyZXIuc2NlbmUuQ2FtZXJhLFxyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzOiBDYW1lcmFDb25maWdzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzRWRpdG9yVmlldzogYm9vbGVhblxyXG4gICAgICAgICAgICAgICAgPSBjYW1lcmEuY2FtZXJhVXNhZ2UgPT09IENhbWVyYVVzYWdlLlNDRU5FX1ZJRVdcclxuICAgICAgICAgICAgICAgIHx8IGNhbWVyYS5jYW1lcmFVc2FnZSA9PT0gQ2FtZXJhVXNhZ2UuUFJFVklFVztcclxuXHJcbiAgICAgICAgICAgIGlmIChpc0VkaXRvclZpZXcpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvclNldHRpbmdzID0gcmVuZGVyaW5nLmdldEVkaXRvclBpcGVsaW5lU2V0dGluZ3MoKSBhcyBQaXBlbGluZVNldHRpbmdzIHwgbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmIChlZGl0b3JTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3Muc2V0dGluZ3MgPSBlZGl0b3JTZXR0aW5ncztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5zZXR0aW5ncyA9IGRlZmF1bHRTZXR0aW5ncztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChjYW1lcmEucGlwZWxpbmVTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3Muc2V0dGluZ3MgPSBjYW1lcmEucGlwZWxpbmVTZXR0aW5ncyBhcyBQaXBlbGluZVNldHRpbmdzO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjYW1lcmFDb25maWdzLnNldHRpbmdzID0gZGVmYXVsdFNldHRpbmdzO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIF9wcmVwYXJlUGlwZWxpbmVQYXNzZXMoY2FtZXJhQ29uZmlnczogQ2FtZXJhQ29uZmlncyk6IHZvaWQge1xyXG4gICAgICAgICAgICBjb25zdCBwYXNzQnVpbGRlcnMgPSB0aGlzLl9wYXNzQnVpbGRlcnM7XHJcbiAgICAgICAgICAgIHBhc3NCdWlsZGVycy5sZW5ndGggPSAwO1xyXG5cclxuICAgICAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBjYW1lcmFDb25maWdzLnNldHRpbmdzIGFzIFBpcGVsaW5lU2V0dGluZ3MyO1xyXG4gICAgICAgICAgICBpZiAoc2V0dGluZ3MuX3Bhc3Nlcykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBwYXNzIG9mIHNldHRpbmdzLl9wYXNzZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXNzQnVpbGRlcnMucHVzaChwYXNzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGFzc2VydChwYXNzQnVpbGRlcnMubGVuZ3RoID09PSBzZXR0aW5ncy5fcGFzc2VzLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHBhc3NCdWlsZGVycy5wdXNoKHRoaXMuX2ZvcndhcmRQYXNzKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChzZXR0aW5ncy5ibG9vbS5lbmFibGVkKSB7XHJcbiAgICAgICAgICAgICAgICBwYXNzQnVpbGRlcnMucHVzaCh0aGlzLl9ibG9vbVBhc3MpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBwYXNzQnVpbGRlcnMucHVzaCh0aGlzLl90b25lTWFwcGluZ1Bhc3MpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHNldHRpbmdzLmZ4YWEuZW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgcGFzc0J1aWxkZXJzLnB1c2godGhpcy5fZnhhYVBhc3MpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoc2V0dGluZ3MuZnNyLmVuYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgIHBhc3NCdWlsZGVycy5wdXNoKHRoaXMuX2ZzclBhc3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhc3NCdWlsZGVycy5wdXNoKHRoaXMuX3VpUGFzcyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIF9zZXR1cEJ1aWx0aW5DYW1lcmFDb25maWdzKFxyXG4gICAgICAgICAgICBjYW1lcmE6IHJlbmRlcmVyLnNjZW5lLkNhbWVyYSxcclxuICAgICAgICAgICAgcGlwZWxpbmVDb25maWdzOiBQaXBlbGluZUNvbmZpZ3MsXHJcbiAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3M6IENhbWVyYUNvbmZpZ3NcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgY29uc3Qgd2luZG93ID0gY2FtZXJhLndpbmRvdztcclxuICAgICAgICAgICAgY29uc3QgaXNNYWluR2FtZVdpbmRvdzogYm9vbGVhbiA9IGNhbWVyYS5jYW1lcmFVc2FnZSA9PT0gQ2FtZXJhVXNhZ2UuR0FNRSAmJiAhIXdpbmRvdy5zd2FwY2hhaW47XHJcblxyXG4gICAgICAgICAgICAvLyBXaW5kb3dcclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5pc01haW5HYW1lV2luZG93ID0gaXNNYWluR2FtZVdpbmRvdztcclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5yZW5kZXJXaW5kb3dJZCA9IHdpbmRvdy5yZW5kZXJXaW5kb3dJZDtcclxuXHJcbiAgICAgICAgICAgIC8vIENhbWVyYVxyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLmNvbG9yTmFtZSA9IHdpbmRvdy5jb2xvck5hbWU7XHJcbiAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3MuZGVwdGhTdGVuY2lsTmFtZSA9IHdpbmRvdy5kZXB0aFN0ZW5jaWxOYW1lO1xyXG5cclxuICAgICAgICAgICAgLy8gUGlwZWxpbmVcclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5lbmFibGVGdWxsUGlwZWxpbmUgPSAoY2FtZXJhLnZpc2liaWxpdHkgJiAoTGF5ZXJzLkVudW0uREVGQVVMVCkpICE9PSAwO1xyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLmVuYWJsZVByb2ZpbGVyID0gREVCVUcgJiYgaXNNYWluR2FtZVdpbmRvdztcclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5yZW1haW5pbmdQYXNzZXMgPSAwO1xyXG5cclxuICAgICAgICAgICAgLy8gU2hhZGluZyBzY2FsZVxyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLnNoYWRpbmdTY2FsZSA9IGNhbWVyYUNvbmZpZ3Muc2V0dGluZ3Muc2hhZGluZ1NjYWxlO1xyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLmVuYWJsZVNoYWRpbmdTY2FsZSA9IGNhbWVyYUNvbmZpZ3Muc2V0dGluZ3MuZW5hYmxlU2hhZGluZ1NjYWxlXHJcbiAgICAgICAgICAgICAgICAmJiBjYW1lcmFDb25maWdzLnNoYWRpbmdTY2FsZSAhPT0gMS4wO1xyXG5cclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5uYXRpdmVXaWR0aCA9IE1hdGgubWF4KE1hdGguZmxvb3Iod2luZG93LndpZHRoKSwgMSk7XHJcbiAgICAgICAgICAgIGNhbWVyYUNvbmZpZ3MubmF0aXZlSGVpZ2h0ID0gTWF0aC5tYXgoTWF0aC5mbG9vcih3aW5kb3cuaGVpZ2h0KSwgMSk7XHJcblxyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLndpZHRoID0gY2FtZXJhQ29uZmlncy5lbmFibGVTaGFkaW5nU2NhbGVcclxuICAgICAgICAgICAgICAgID8gTWF0aC5tYXgoTWF0aC5mbG9vcihjYW1lcmFDb25maWdzLm5hdGl2ZVdpZHRoICogY2FtZXJhQ29uZmlncy5zaGFkaW5nU2NhbGUpLCAxKVxyXG4gICAgICAgICAgICAgICAgOiBjYW1lcmFDb25maWdzLm5hdGl2ZVdpZHRoO1xyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLmhlaWdodCA9IGNhbWVyYUNvbmZpZ3MuZW5hYmxlU2hhZGluZ1NjYWxlXHJcbiAgICAgICAgICAgICAgICA/IE1hdGgubWF4KE1hdGguZmxvb3IoY2FtZXJhQ29uZmlncy5uYXRpdmVIZWlnaHQgKiBjYW1lcmFDb25maWdzLnNoYWRpbmdTY2FsZSksIDEpXHJcbiAgICAgICAgICAgICAgICA6IGNhbWVyYUNvbmZpZ3MubmF0aXZlSGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgLy8gUmFkaWFuY2VcclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5lbmFibGVIRFIgPSBjYW1lcmFDb25maWdzLmVuYWJsZUZ1bGxQaXBlbGluZVxyXG4gICAgICAgICAgICAgICAgJiYgcGlwZWxpbmVDb25maWdzLnVzZUZsb2F0T3V0cHV0O1xyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLnJhZGlhbmNlRm9ybWF0ID0gY2FtZXJhQ29uZmlncy5lbmFibGVIRFJcclxuICAgICAgICAgICAgICAgID8gZ2Z4LkZvcm1hdC5SR0JBMTZGIDogZ2Z4LkZvcm1hdC5SR0JBODtcclxuXHJcbiAgICAgICAgICAgIC8vIFRvbmUgTWFwcGluZ1xyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzLmNvcHlBbmRUb25lbWFwTWF0ZXJpYWwgPSB0aGlzLl9jb3B5QW5kVG9uZW1hcE1hdGVyaWFsO1xyXG5cclxuICAgICAgICAgICAgLy8gRGVwdGhcclxuICAgICAgICAgICAgY2FtZXJhQ29uZmlncy5lbmFibGVTdG9yZVNjZW5lRGVwdGggPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgX3NldHVwQ2FtZXJhQ29uZmlncyhcclxuICAgICAgICAgICAgY2FtZXJhOiByZW5kZXJlci5zY2VuZS5DYW1lcmEsXHJcbiAgICAgICAgICAgIHBpcGVsaW5lQ29uZmlnczogUGlwZWxpbmVDb25maWdzLFxyXG4gICAgICAgICAgICBjYW1lcmFDb25maWdzOiBDYW1lcmFDb25maWdzXHJcbiAgICAgICAgKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NldHVwUGlwZWxpbmVQcmV2aWV3KGNhbWVyYSwgY2FtZXJhQ29uZmlncyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9wcmVwYXJlUGlwZWxpbmVQYXNzZXMoY2FtZXJhQ29uZmlncyk7XHJcblxyXG4gICAgICAgICAgICBzb3J0UGlwZWxpbmVQYXNzQnVpbGRlcnNCeUNvbmZpZ09yZGVyKHRoaXMuX3Bhc3NCdWlsZGVycyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9zZXR1cEJ1aWx0aW5DYW1lcmFDb25maWdzKGNhbWVyYSwgcGlwZWxpbmVDb25maWdzLCBjYW1lcmFDb25maWdzKTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgYnVpbGRlciBvZiB0aGlzLl9wYXNzQnVpbGRlcnMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChidWlsZGVyLmNvbmZpZ0NhbWVyYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuY29uZmlnQ2FtZXJhKGNhbWVyYSwgcGlwZWxpbmVDb25maWdzLCBjYW1lcmFDb25maWdzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIC8vIEludGVyZmFjZVxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICB3aW5kb3dSZXNpemUoXHJcbiAgICAgICAgICAgIHBwbDogcmVuZGVyaW5nLkJhc2ljUGlwZWxpbmUsXHJcbiAgICAgICAgICAgIHdpbmRvdzogcmVuZGVyZXIuUmVuZGVyV2luZG93LFxyXG4gICAgICAgICAgICBjYW1lcmE6IHJlbmRlcmVyLnNjZW5lLkNhbWVyYSxcclxuICAgICAgICAgICAgbmF0aXZlV2lkdGg6IG51bWJlcixcclxuICAgICAgICAgICAgbmF0aXZlSGVpZ2h0OiBudW1iZXIsXHJcbiAgICAgICAgKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHNldHVwUGlwZWxpbmVDb25maWdzKHBwbCwgdGhpcy5fY29uZmlncyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9zZXR1cENhbWVyYUNvbmZpZ3MoY2FtZXJhLCB0aGlzLl9jb25maWdzLCB0aGlzLl9jYW1lcmFDb25maWdzKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlbmRlciBXaW5kb3cgKFVJKVxyXG4gICAgICAgICAgICBjb25zdCBpZCA9IHdpbmRvdy5yZW5kZXJXaW5kb3dJZDtcclxuXHJcbiAgICAgICAgICAgIHBwbC5hZGRSZW5kZXJXaW5kb3codGhpcy5fY2FtZXJhQ29uZmlncy5jb2xvck5hbWUsXHJcbiAgICAgICAgICAgICAgICBGb3JtYXQuUkdCQTgsIG5hdGl2ZVdpZHRoLCBuYXRpdmVIZWlnaHQsIHdpbmRvdyxcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NhbWVyYUNvbmZpZ3MuZGVwdGhTdGVuY2lsTmFtZSk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB3aWR0aCA9IHRoaXMuX2NhbWVyYUNvbmZpZ3Mud2lkdGg7XHJcbiAgICAgICAgICAgIGNvbnN0IGhlaWdodCA9IHRoaXMuX2NhbWVyYUNvbmZpZ3MuaGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuX2NhbWVyYUNvbmZpZ3MuZW5hYmxlU2hhZGluZ1NjYWxlKSB7XHJcbiAgICAgICAgICAgICAgICBwcGwuYWRkRGVwdGhTdGVuY2lsKGBTY2FsZWRTY2VuZURlcHRoXyR7aWR9YCwgRm9ybWF0LkRFUFRIX1NURU5DSUwsIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgcHBsLmFkZFJlbmRlclRhcmdldChgU2NhbGVkUmFkaWFuY2UwXyR7aWR9YCwgdGhpcy5fY2FtZXJhQ29uZmlncy5yYWRpYW5jZUZvcm1hdCwgd2lkdGgsIGhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICBwcGwuYWRkUmVuZGVyVGFyZ2V0KGBTY2FsZWRSYWRpYW5jZTFfJHtpZH1gLCB0aGlzLl9jYW1lcmFDb25maWdzLnJhZGlhbmNlRm9ybWF0LCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIHBwbC5hZGRSZW5kZXJUYXJnZXQoYFNjYWxlZExkckNvbG9yMF8ke2lkfWAsIEZvcm1hdC5SR0JBOCwgd2lkdGgsIGhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICBwcGwuYWRkUmVuZGVyVGFyZ2V0KGBTY2FsZWRMZHJDb2xvcjFfJHtpZH1gLCBGb3JtYXQuUkdCQTgsIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcHBsLmFkZERlcHRoU3RlbmNpbChgU2NlbmVEZXB0aF8ke2lkfWAsIEZvcm1hdC5ERVBUSF9TVEVOQ0lMLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIHBwbC5hZGRSZW5kZXJUYXJnZXQoYFJhZGlhbmNlMF8ke2lkfWAsIHRoaXMuX2NhbWVyYUNvbmZpZ3MucmFkaWFuY2VGb3JtYXQsIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgcHBsLmFkZFJlbmRlclRhcmdldChgUmFkaWFuY2UxXyR7aWR9YCwgdGhpcy5fY2FtZXJhQ29uZmlncy5yYWRpYW5jZUZvcm1hdCwgd2lkdGgsIGhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICBwcGwuYWRkUmVuZGVyVGFyZ2V0KGBMZHJDb2xvcjBfJHtpZH1gLCBGb3JtYXQuUkdCQTgsIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgcHBsLmFkZFJlbmRlclRhcmdldChgTGRyQ29sb3IxXyR7aWR9YCwgRm9ybWF0LlJHQkE4LCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwcGwuYWRkUmVuZGVyVGFyZ2V0KGBVaUNvbG9yMF8ke2lkfWAsIEZvcm1hdC5SR0JBOCwgbmF0aXZlV2lkdGgsIG5hdGl2ZUhlaWdodCk7XHJcbiAgICAgICAgICAgIHBwbC5hZGRSZW5kZXJUYXJnZXQoYFVpQ29sb3IxXyR7aWR9YCwgRm9ybWF0LlJHQkE4LCBuYXRpdmVXaWR0aCwgbmF0aXZlSGVpZ2h0KTtcclxuXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgYnVpbGRlciBvZiB0aGlzLl9wYXNzQnVpbGRlcnMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChidWlsZGVyLndpbmRvd1Jlc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIud2luZG93UmVzaXplKHBwbCwgdGhpcy5fY29uZmlncywgdGhpcy5fY2FtZXJhQ29uZmlncywgd2luZG93LCBjYW1lcmEsIG5hdGl2ZVdpZHRoLCBuYXRpdmVIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNldHVwKGNhbWVyYXM6IHJlbmRlcmVyLnNjZW5lLkNhbWVyYVtdLCBwcGw6IHJlbmRlcmluZy5CYXNpY1BpcGVsaW5lKTogdm9pZCB7XHJcbiAgICAgICAgICAgIC8vIFRPRE8oemhvdXpoZW5nbG9uZyk6IE1ha2UgZGVmYXVsdCBlZmZlY3QgYXNzZXQgbG9hZGluZyBlYXJsaWVyIGFuZCByZW1vdmUgX2luaXRNYXRlcmlhbHNcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2luaXRNYXRlcmlhbHMocHBsKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIFJlbmRlciBjYW1lcmFzXHJcbiAgICAgICAgICAgIC8vIGxvZyhgPT09PT09PT09PT09PT09PT09PT0gT25lIEZyYW1lID09PT09PT09PT09PT09PT09PT09YCk7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2FtZXJhIG9mIGNhbWVyYXMpIHtcclxuICAgICAgICAgICAgICAgIC8vIFNraXAgaW52YWxpZCBjYW1lcmFcclxuICAgICAgICAgICAgICAgIGlmICghY2FtZXJhLnNjZW5lIHx8ICFjYW1lcmEud2luZG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBTZXR1cCBjYW1lcmEgY29uZmlnc1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0dXBDYW1lcmFDb25maWdzKGNhbWVyYSwgdGhpcy5fY29uZmlncywgdGhpcy5fY2FtZXJhQ29uZmlncyk7XHJcbiAgICAgICAgICAgICAgICAvLyBsb2coYFNldHVwIGNhbWVyYTogJHtjYW1lcmEubm9kZSEubmFtZX0sIHdpbmRvdzogJHtjYW1lcmEud2luZG93LnJlbmRlcldpbmRvd0lkfSwgaXNGdWxsOiAke3RoaXMuX2NhbWVyYUNvbmZpZ3MuZW5hYmxlRnVsbFBpcGVsaW5lfSwgYFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICsgYHNpemU6ICR7Y2FtZXJhLndpbmRvdy53aWR0aH14JHtjYW1lcmEud2luZG93LmhlaWdodH1gKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9waXBlbGluZUV2ZW50LmVtaXQoUGlwZWxpbmVFdmVudFR5cGUuUkVOREVSX0NBTUVSQV9CRUdJTiwgY2FtZXJhKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBCdWlsZCBwaXBlbGluZVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NhbWVyYUNvbmZpZ3MuZW5hYmxlRnVsbFBpcGVsaW5lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYnVpbGRGb3J3YXJkUGlwZWxpbmUocHBsLCBjYW1lcmEsIGNhbWVyYS5zY2VuZSwgdGhpcy5fcGFzc0J1aWxkZXJzKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYnVpbGRTaW1wbGVQaXBlbGluZShwcGwsIGNhbWVyYSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcGlwZWxpbmVFdmVudC5lbWl0KFBpcGVsaW5lRXZlbnRUeXBlLlJFTkRFUl9DQU1FUkFfRU5ELCBjYW1lcmEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICAvLyBQaXBlbGluZXNcclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgcHJpdmF0ZSBfYnVpbGRTaW1wbGVQaXBlbGluZShcclxuICAgICAgICAgICAgcHBsOiByZW5kZXJpbmcuQmFzaWNQaXBlbGluZSxcclxuICAgICAgICAgICAgY2FtZXJhOiByZW5kZXJlci5zY2VuZS5DYW1lcmEsXHJcbiAgICAgICAgKTogdm9pZCB7XHJcbiAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gTWF0aC5tYXgoTWF0aC5mbG9vcihjYW1lcmEud2luZG93LndpZHRoKSwgMSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGhlaWdodCA9IE1hdGgubWF4KE1hdGguZmxvb3IoY2FtZXJhLndpbmRvdy5oZWlnaHQpLCAxKTtcclxuICAgICAgICAgICAgY29uc3QgY29sb3JOYW1lID0gdGhpcy5fY2FtZXJhQ29uZmlncy5jb2xvck5hbWU7XHJcbiAgICAgICAgICAgIGNvbnN0IGRlcHRoU3RlbmNpbE5hbWUgPSB0aGlzLl9jYW1lcmFDb25maWdzLmRlcHRoU3RlbmNpbE5hbWU7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB2aWV3cG9ydCA9IGNhbWVyYS52aWV3cG9ydDsgIC8vIFJlZHVjZSBDKysvVFMgaW50ZXJvcFxyXG4gICAgICAgICAgICB0aGlzLl92aWV3cG9ydC5sZWZ0ID0gTWF0aC5yb3VuZCh2aWV3cG9ydC54ICogd2lkdGgpO1xyXG4gICAgICAgICAgICB0aGlzLl92aWV3cG9ydC50b3AgPSBNYXRoLnJvdW5kKHZpZXdwb3J0LnkgKiBoZWlnaHQpO1xyXG4gICAgICAgICAgICAvLyBIZXJlIHdlIG11c3QgdXNlIGNhbWVyYS52aWV3cG9ydC53aWR0aCBpbnN0ZWFkIG9mIGNhbWVyYS52aWV3cG9ydC56LCB3aGljaFxyXG4gICAgICAgICAgICAvLyBpcyB1bmRlZmluZWQgb24gbmF0aXZlIHBsYXRmb3JtLiBUaGUgc2FtZSBhcyBjYW1lcmEudmlld3BvcnQuaGVpZ2h0LlxyXG4gICAgICAgICAgICB0aGlzLl92aWV3cG9ydC53aWR0aCA9IE1hdGgubWF4KE1hdGgucm91bmQodmlld3BvcnQud2lkdGggKiB3aWR0aCksIDEpO1xyXG4gICAgICAgICAgICB0aGlzLl92aWV3cG9ydC5oZWlnaHQgPSBNYXRoLm1heChNYXRoLnJvdW5kKHZpZXdwb3J0LmhlaWdodCAqIGhlaWdodCksIDEpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgY2xlYXJDb2xvciA9IGNhbWVyYS5jbGVhckNvbG9yOyAgLy8gUmVkdWNlIEMrKy9UUyBpbnRlcm9wXHJcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyQ29sb3IueCA9IGNsZWFyQ29sb3IueDtcclxuICAgICAgICAgICAgdGhpcy5fY2xlYXJDb2xvci55ID0gY2xlYXJDb2xvci55O1xyXG4gICAgICAgICAgICB0aGlzLl9jbGVhckNvbG9yLnogPSBjbGVhckNvbG9yLno7XHJcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyQ29sb3IudyA9IGNsZWFyQ29sb3IudztcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHBhc3MgPSBwcGwuYWRkUmVuZGVyUGFzcyh3aWR0aCwgaGVpZ2h0LCAnZGVmYXVsdCcpO1xyXG5cclxuICAgICAgICAgICAgLy8gYmluZCBvdXRwdXQgcmVuZGVyIHRhcmdldFxyXG4gICAgICAgICAgICBpZiAoZm9yd2FyZE5lZWRDbGVhckNvbG9yKGNhbWVyYSkpIHtcclxuICAgICAgICAgICAgICAgIHBhc3MuYWRkUmVuZGVyVGFyZ2V0KGNvbG9yTmFtZSwgTG9hZE9wLkNMRUFSLCBTdG9yZU9wLlNUT1JFLCB0aGlzLl9jbGVhckNvbG9yKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBhc3MuYWRkUmVuZGVyVGFyZ2V0KGNvbG9yTmFtZSwgTG9hZE9wLkxPQUQsIFN0b3JlT3AuU1RPUkUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBiaW5kIGRlcHRoIHN0ZW5jaWwgYnVmZmVyXHJcbiAgICAgICAgICAgIGlmIChjYW1lcmEuY2xlYXJGbGFnICYgQ2xlYXJGbGFnQml0LkRFUFRIX1NURU5DSUwpIHtcclxuICAgICAgICAgICAgICAgIHBhc3MuYWRkRGVwdGhTdGVuY2lsKFxyXG4gICAgICAgICAgICAgICAgICAgIGRlcHRoU3RlbmNpbE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgTG9hZE9wLkNMRUFSLFxyXG4gICAgICAgICAgICAgICAgICAgIFN0b3JlT3AuRElTQ0FSRCxcclxuICAgICAgICAgICAgICAgICAgICBjYW1lcmEuY2xlYXJEZXB0aCxcclxuICAgICAgICAgICAgICAgICAgICBjYW1lcmEuY2xlYXJTdGVuY2lsLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhbWVyYS5jbGVhckZsYWcgJiBDbGVhckZsYWdCaXQuREVQVEhfU1RFTkNJTCxcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwYXNzLmFkZERlcHRoU3RlbmNpbChkZXB0aFN0ZW5jaWxOYW1lLCBMb2FkT3AuTE9BRCwgU3RvcmVPcC5ESVNDQVJEKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcGFzcy5zZXRWaWV3cG9ydCh0aGlzLl92aWV3cG9ydCk7XHJcblxyXG4gICAgICAgICAgICAvLyBUaGUgb3BhcXVlIHF1ZXVlIGlzIHVzZWQgZm9yIFJlZmxlY3Rpb24gcHJvYmUgcHJldmlld1xyXG4gICAgICAgICAgICBwYXNzLmFkZFF1ZXVlKFF1ZXVlSGludC5PUEFRVUUpXHJcbiAgICAgICAgICAgICAgICAuYWRkU2NlbmUoY2FtZXJhLCBTY2VuZUZsYWdzLk9QQVFVRSk7XHJcblxyXG4gICAgICAgICAgICAvLyBUaGUgYmxlbmQgcXVldWUgaXMgdXNlZCBmb3IgVUkgYW5kIEdpem1vc1xyXG4gICAgICAgICAgICBsZXQgZmxhZ3MgPSBTY2VuZUZsYWdzLkJMRU5EIHwgU2NlbmVGbGFncy5VSTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2NhbWVyYUNvbmZpZ3MuZW5hYmxlUHJvZmlsZXIpIHtcclxuICAgICAgICAgICAgICAgIGZsYWdzIHw9IFNjZW5lRmxhZ3MuUFJPRklMRVI7XHJcbiAgICAgICAgICAgICAgICBwYXNzLnNob3dTdGF0aXN0aWNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwYXNzLmFkZFF1ZXVlKFF1ZXVlSGludC5CTEVORClcclxuICAgICAgICAgICAgICAgIC5hZGRTY2VuZShjYW1lcmEsIGZsYWdzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgX2J1aWxkRm9yd2FyZFBpcGVsaW5lKFxyXG4gICAgICAgICAgICBwcGw6IHJlbmRlcmluZy5CYXNpY1BpcGVsaW5lLFxyXG4gICAgICAgICAgICBjYW1lcmE6IHJlbmRlcmVyLnNjZW5lLkNhbWVyYSxcclxuICAgICAgICAgICAgc2NlbmU6IHJlbmRlcmVyLlJlbmRlclNjZW5lLFxyXG4gICAgICAgICAgICBwYXNzQnVpbGRlcnM6IHJlbmRlcmluZy5QaXBlbGluZVBhc3NCdWlsZGVyW10sXHJcbiAgICAgICAgKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHNvcnRQaXBlbGluZVBhc3NCdWlsZGVyc0J5UmVuZGVyT3JkZXIocGFzc0J1aWxkZXJzKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHQ6IFBpcGVsaW5lQ29udGV4dCA9IHtcclxuICAgICAgICAgICAgICAgIGNvbG9yTmFtZTogJycsXHJcbiAgICAgICAgICAgICAgICBkZXB0aFN0ZW5jaWxOYW1lOiAnJyxcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGxldCBsYXN0UGFzczogcmVuZGVyaW5nLkJhc2ljUmVuZGVyUGFzc0J1aWxkZXIgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGJ1aWxkZXIgb2YgcGFzc0J1aWxkZXJzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYnVpbGRlci5zZXR1cCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxhc3RQYXNzID0gYnVpbGRlci5zZXR1cChwcGwsIHRoaXMuX2NvbmZpZ3MsIHRoaXMuX2NhbWVyYUNvbmZpZ3MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbWVyYSwgY29udGV4dCwgbGFzdFBhc3MpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3NlcnQodGhpcy5fY2FtZXJhQ29uZmlncy5yZW1haW5pbmdQYXNzZXMgPT09IDApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBfaW5pdE1hdGVyaWFscyhwcGw6IHJlbmRlcmluZy5CYXNpY1BpcGVsaW5lKTogbnVtYmVyIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2luaXRpYWxpemVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0dXBQaXBlbGluZUNvbmZpZ3MocHBsLCB0aGlzLl9jb25maWdzKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFdoZW4gYWRkIG5ldyBlZmZlY3QgYXNzZXQsIHBsZWFzZSBhZGQgaXRzIHV1aWQgdG8gdGhlIGRlcGVuZGVudEFzc2V0cyBpbiBjYy5jb25maWcuanNvbi5cclxuICAgICAgICAgICAgdGhpcy5fY29weUFuZFRvbmVtYXBNYXRlcmlhbC5fdXVpZCA9IGBidWlsdGluLXBpcGVsaW5lLXRvbmUtbWFwcGluZy1tYXRlcmlhbGA7XHJcbiAgICAgICAgICAgIHRoaXMuX2NvcHlBbmRUb25lbWFwTWF0ZXJpYWwuaW5pdGlhbGl6ZSh7IGVmZmVjdE5hbWU6ICdwaXBlbGluZS9wb3N0LXByb2Nlc3MvdG9uZS1tYXBwaW5nJyB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9jb3B5QW5kVG9uZW1hcE1hdGVyaWFsLmVmZmVjdEFzc2V0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbml0aWFsaXplZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbml0aWFsaXplZCA/IDAgOiAxO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJpbmcuc2V0Q3VzdG9tUGlwZWxpbmUoJ0J1aWx0aW4nLCBuZXcgQnVpbHRpblBpcGVsaW5lQnVpbGRlcigpKTtcclxuXHJcbn0gLy8gaWYgKHJlbmRlcmluZylcclxuIiwiZXhwb3J0IGNvbnN0IEhUTUw1ID0gdHJ1ZTtcbmV4cG9ydCBjb25zdCBOQVRJVkUgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBBTkRST0lEID0gZmFsc2U7XG5leHBvcnQgY29uc3QgSU9TID0gZmFsc2U7XG5leHBvcnQgY29uc3QgTUFDID0gZmFsc2U7XG5leHBvcnQgY29uc3QgV0lORE9XUyA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IExJTlVYID0gZmFsc2U7XG5leHBvcnQgY29uc3QgT0hPUyA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IE9QRU5fSEFSTU9OWSA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IFdFQ0hBVCA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IFdFQ0hBVF9NSU5JX1BST0dSQU0gPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBYSUFPTUkgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBBTElQQVkgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBUQU9CQU8gPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBUQU9CQU9fTUlOSUdBTUUgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBCWVRFREFOQ0UgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBPUFBPID0gZmFsc2U7XG5leHBvcnQgY29uc3QgVklWTyA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IEhVQVdFSSA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IE1JR1UgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBIT05PUiA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IENPQ09TX1JVTlRJTUUgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBFRElUT1IgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBFRElUT1JfTk9UX0lOX1BSRVZJRVcgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBQUkVWSUVXID0gZmFsc2U7XG5leHBvcnQgY29uc3QgQlVJTEQgPSB0cnVlO1xuZXhwb3J0IGNvbnN0IFRFU1QgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBERUJVRyA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IERFViA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IE1JTklHQU1FID0gZmFsc2U7XG5leHBvcnQgY29uc3QgUlVOVElNRV9CQVNFRCA9IGZhbHNlO1xuZXhwb3J0IGNvbnN0IFNVUFBPUlRfSklUID0gdHJ1ZTtcbmV4cG9ydCBjb25zdCBKU0IgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBORVRfTU9ERSA9IDA7IiwiZXhwb3J0IHsgX0FzeW5jR2VuZXJhdG9yIGFzIEFzeW5jR2VuZXJhdG9yLCBfT3ZlcmxvYWRZaWVsZCBhcyBPdmVybG9hZFlpZWxkLCBfYXBwbHlEZWNzIGFzIGFwcGx5RGVjcywgX2FwcGx5RGVjczIyMDMgYXMgYXBwbHlEZWNzMjIwMywgX2FwcGx5RGVjczIyMDNSIGFzIGFwcGx5RGVjczIyMDNSLCBfYXBwbHlEZWNzMjMwMSBhcyBhcHBseURlY3MyMzAxLCBfYXBwbHlEZWNzMjMwNSBhcyBhcHBseURlY3MyMzA1LCBfYXN5bmNHZW5lcmF0b3JEZWxlZ2F0ZSBhcyBhc3luY0dlbmVyYXRvckRlbGVnYXRlLCBfYXN5bmNJdGVyYXRvciBhcyBhc3luY0l0ZXJhdG9yLCBfYXdhaXRBc3luY0dlbmVyYXRvciBhcyBhd2FpdEFzeW5jR2VuZXJhdG9yLCBfY2hlY2tJblJIUyBhcyBjaGVja0luUkhTLCBfZGVmaW5lQWNjZXNzb3IgYXMgZGVmaW5lQWNjZXNzb3IsIF9kaXNwb3NlIGFzIGRpc3Bvc2UsIF9pdGVyYWJsZVRvQXJyYXlMaW1pdCBhcyBpdGVyYWJsZVRvQXJyYXlMaW1pdCwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0TG9vc2UgYXMgaXRlcmFibGVUb0FycmF5TGltaXRMb29zZSwgX2pzeCBhcyBqc3gsIF9vYmplY3RTcHJlYWQyIGFzIG9iamVjdFNwcmVhZDIsIF9yZWdlbmVyYXRvclJ1bnRpbWUgYXMgcmVnZW5lcmF0b3JSdW50aW1lLCBfdHlwZW9mIGFzIHR5cGVvZiwgX3VzaW5nIGFzIHVzaW5nLCBfd3JhcFJlZ0V4cCBhcyB3cmFwUmVnRXhwLCBfQXdhaXRWYWx1ZSBhcyBBd2FpdFZhbHVlLCBfd3JhcEFzeW5jR2VuZXJhdG9yIGFzIHdyYXBBc3luY0dlbmVyYXRvciwgX2FzeW5jVG9HZW5lcmF0b3IgYXMgYXN5bmNUb0dlbmVyYXRvciwgX2NsYXNzQ2FsbENoZWNrIGFzIGNsYXNzQ2FsbENoZWNrLCBfY3JlYXRlQ2xhc3MgYXMgY3JlYXRlQ2xhc3MsIF9kZWZpbmVFbnVtZXJhYmxlUHJvcGVydGllcyBhcyBkZWZpbmVFbnVtZXJhYmxlUHJvcGVydGllcywgX2RlZmF1bHRzIGFzIGRlZmF1bHRzLCBfZGVmaW5lUHJvcGVydHkgYXMgZGVmaW5lUHJvcGVydHksIF9leHRlbmRzIGFzIGV4dGVuZHMsIF9vYmplY3RTcHJlYWQgYXMgb2JqZWN0U3ByZWFkLCBfaW5oZXJpdHMgYXMgaW5oZXJpdHMsIF9pbmhlcml0c0xvb3NlIGFzIGluaGVyaXRzTG9vc2UsIF9nZXRQcm90b3R5cGVPZiBhcyBnZXRQcm90b3R5cGVPZiwgX3NldFByb3RvdHlwZU9mIGFzIHNldFByb3RvdHlwZU9mLCBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0IGFzIGlzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCwgX2NvbnN0cnVjdCBhcyBjb25zdHJ1Y3QsIF9pc05hdGl2ZUZ1bmN0aW9uIGFzIGlzTmF0aXZlRnVuY3Rpb24sIF93cmFwTmF0aXZlU3VwZXIgYXMgd3JhcE5hdGl2ZVN1cGVyLCBfaW5zdGFuY2VvZiBhcyBpbnN0YW5jZW9mLCBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IGFzIGludGVyb3BSZXF1aXJlRGVmYXVsdCwgX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQgYXMgaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCwgX25ld0Fycm93Q2hlY2sgYXMgbmV3QXJyb3dDaGVjaywgX29iamVjdERlc3RydWN0dXJpbmdFbXB0eSBhcyBvYmplY3REZXN0cnVjdHVyaW5nRW1wdHksIF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlIGFzIG9iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UsIF9vYmplY3RXaXRob3V0UHJvcGVydGllcyBhcyBvYmplY3RXaXRob3V0UHJvcGVydGllcywgX2Fzc2VydFRoaXNJbml0aWFsaXplZCBhcyBhc3NlcnRUaGlzSW5pdGlhbGl6ZWQsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGFzIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4sIF9jcmVhdGVTdXBlciBhcyBjcmVhdGVTdXBlciwgX3N1cGVyUHJvcEJhc2UgYXMgc3VwZXJQcm9wQmFzZSwgX2dldCBhcyBnZXQsIF9zZXQgYXMgc2V0LCBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsIGFzIHRhZ2dlZFRlbXBsYXRlTGl0ZXJhbCwgX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlIGFzIHRhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlLCBfcmVhZE9ubHlFcnJvciBhcyByZWFkT25seUVycm9yLCBfd3JpdGVPbmx5RXJyb3IgYXMgd3JpdGVPbmx5RXJyb3IsIF9jbGFzc05hbWVURFpFcnJvciBhcyBjbGFzc05hbWVURFpFcnJvciwgX3RlbXBvcmFsVW5kZWZpbmVkIGFzIHRlbXBvcmFsVW5kZWZpbmVkLCBfdGR6IGFzIHRkeiwgX3RlbXBvcmFsUmVmIGFzIHRlbXBvcmFsUmVmLCBfc2xpY2VkVG9BcnJheSBhcyBzbGljZWRUb0FycmF5LCBfc2xpY2VkVG9BcnJheUxvb3NlIGFzIHNsaWNlZFRvQXJyYXlMb29zZSwgX3RvQXJyYXkgYXMgdG9BcnJheSwgX3RvQ29uc3VtYWJsZUFycmF5IGFzIHRvQ29uc3VtYWJsZUFycmF5LCBfYXJyYXlXaXRob3V0SG9sZXMgYXMgYXJyYXlXaXRob3V0SG9sZXMsIF9hcnJheVdpdGhIb2xlcyBhcyBhcnJheVdpdGhIb2xlcywgX21heWJlQXJyYXlMaWtlIGFzIG1heWJlQXJyYXlMaWtlLCBfaXRlcmFibGVUb0FycmF5IGFzIGl0ZXJhYmxlVG9BcnJheSwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5IGFzIHVuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5LCBfYXJyYXlMaWtlVG9BcnJheSBhcyBhcnJheUxpa2VUb0FycmF5LCBfbm9uSXRlcmFibGVTcHJlYWQgYXMgbm9uSXRlcmFibGVTcHJlYWQsIF9ub25JdGVyYWJsZVJlc3QgYXMgbm9uSXRlcmFibGVSZXN0LCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciBhcyBjcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyLCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlckxvb3NlIGFzIGNyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXJMb29zZSwgX3NraXBGaXJzdEdlbmVyYXRvck5leHQgYXMgc2tpcEZpcnN0R2VuZXJhdG9yTmV4dCwgX3RvUHJpbWl0aXZlIGFzIHRvUHJpbWl0aXZlLCBfdG9Qcm9wZXJ0eUtleSBhcyB0b1Byb3BlcnR5S2V5LCBfaW5pdGlhbGl6ZXJXYXJuaW5nSGVscGVyIGFzIGluaXRpYWxpemVyV2FybmluZ0hlbHBlciwgX2luaXRpYWxpemVyRGVmaW5lUHJvcGVydHkgYXMgaW5pdGlhbGl6ZXJEZWZpbmVQcm9wZXJ0eSwgX2FwcGx5RGVjb3JhdGVkRGVzY3JpcHRvciBhcyBhcHBseURlY29yYXRlZERlc2NyaXB0b3IsIF9jbGFzc1ByaXZhdGVGaWVsZExvb3NlS2V5IGFzIGNsYXNzUHJpdmF0ZUZpZWxkTG9vc2VLZXksIF9jbGFzc1ByaXZhdGVGaWVsZExvb3NlQmFzZSBhcyBjbGFzc1ByaXZhdGVGaWVsZExvb3NlQmFzZSwgX2NsYXNzUHJpdmF0ZUZpZWxkR2V0IGFzIGNsYXNzUHJpdmF0ZUZpZWxkR2V0LCBfY2xhc3NQcml2YXRlRmllbGRTZXQgYXMgY2xhc3NQcml2YXRlRmllbGRTZXQsIF9jbGFzc1ByaXZhdGVGaWVsZERlc3RydWN0dXJlU2V0IGFzIGNsYXNzUHJpdmF0ZUZpZWxkRGVzdHJ1Y3R1cmVTZXQsIF9jbGFzc0V4dHJhY3RGaWVsZERlc2NyaXB0b3IgYXMgY2xhc3NFeHRyYWN0RmllbGREZXNjcmlwdG9yLCBfY2xhc3NTdGF0aWNQcml2YXRlRmllbGRTcGVjR2V0IGFzIGNsYXNzU3RhdGljUHJpdmF0ZUZpZWxkU3BlY0dldCwgX2NsYXNzU3RhdGljUHJpdmF0ZUZpZWxkU3BlY1NldCBhcyBjbGFzc1N0YXRpY1ByaXZhdGVGaWVsZFNwZWNTZXQsIF9jbGFzc1N0YXRpY1ByaXZhdGVNZXRob2RHZXQgYXMgY2xhc3NTdGF0aWNQcml2YXRlTWV0aG9kR2V0LCBfY2xhc3NTdGF0aWNQcml2YXRlTWV0aG9kU2V0IGFzIGNsYXNzU3RhdGljUHJpdmF0ZU1ldGhvZFNldCwgX2NsYXNzQXBwbHlEZXNjcmlwdG9yR2V0IGFzIGNsYXNzQXBwbHlEZXNjcmlwdG9yR2V0LCBfY2xhc3NBcHBseURlc2NyaXB0b3JTZXQgYXMgY2xhc3NBcHBseURlc2NyaXB0b3JTZXQsIF9jbGFzc0FwcGx5RGVzY3JpcHRvckRlc3RydWN0dXJlU2V0IGFzIGNsYXNzQXBwbHlEZXNjcmlwdG9yRGVzdHJ1Y3R1cmVTZXQsIF9jbGFzc1N0YXRpY1ByaXZhdGVGaWVsZERlc3RydWN0dXJlU2V0IGFzIGNsYXNzU3RhdGljUHJpdmF0ZUZpZWxkRGVzdHJ1Y3R1cmVTZXQsIF9jbGFzc0NoZWNrUHJpdmF0ZVN0YXRpY0FjY2VzcyBhcyBjbGFzc0NoZWNrUHJpdmF0ZVN0YXRpY0FjY2VzcywgX2NsYXNzQ2hlY2tQcml2YXRlU3RhdGljRmllbGREZXNjcmlwdG9yIGFzIGNsYXNzQ2hlY2tQcml2YXRlU3RhdGljRmllbGREZXNjcmlwdG9yLCBfZGVjb3JhdGUgYXMgZGVjb3JhdGUsIF9jbGFzc1ByaXZhdGVNZXRob2RHZXQgYXMgY2xhc3NQcml2YXRlTWV0aG9kR2V0LCBfY2hlY2tQcml2YXRlUmVkZWNsYXJhdGlvbiBhcyBjaGVja1ByaXZhdGVSZWRlY2xhcmF0aW9uLCBfY2xhc3NQcml2YXRlRmllbGRJbml0U3BlYyBhcyBjbGFzc1ByaXZhdGVGaWVsZEluaXRTcGVjLCBfY2xhc3NQcml2YXRlTWV0aG9kSW5pdFNwZWMgYXMgY2xhc3NQcml2YXRlTWV0aG9kSW5pdFNwZWMsIF9jbGFzc1ByaXZhdGVNZXRob2RTZXQgYXMgY2xhc3NQcml2YXRlTWV0aG9kU2V0LCBfaWRlbnRpdHkgYXMgaWRlbnRpdHkgfTtcbmZ1bmN0aW9uIF9Bc3luY0dlbmVyYXRvcihlKSB7XG4gIHZhciByLCB0O1xuICBmdW5jdGlvbiByZXN1bWUociwgdCkge1xuICAgIHRyeSB7XG4gICAgICB2YXIgbiA9IGVbcl0odCksXG4gICAgICAgIG8gPSBuLnZhbHVlLFxuICAgICAgICB1ID0gbyBpbnN0YW5jZW9mIF9PdmVybG9hZFlpZWxkO1xuICAgICAgUHJvbWlzZS5yZXNvbHZlKHUgPyBvLnYgOiBvKS50aGVuKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIGlmICh1KSB7XG4gICAgICAgICAgdmFyIGkgPSBcInJldHVyblwiID09PSByID8gXCJyZXR1cm5cIiA6IFwibmV4dFwiO1xuICAgICAgICAgIGlmICghby5rIHx8IHQuZG9uZSkgcmV0dXJuIHJlc3VtZShpLCB0KTtcbiAgICAgICAgICB0ID0gZVtpXSh0KS52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBzZXR0bGUobi5kb25lID8gXCJyZXR1cm5cIiA6IFwibm9ybWFsXCIsIHQpO1xuICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgcmVzdW1lKFwidGhyb3dcIiwgZSk7XG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBzZXR0bGUoXCJ0aHJvd1wiLCBlKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gc2V0dGxlKGUsIG4pIHtcbiAgICBzd2l0Y2ggKGUpIHtcbiAgICAgIGNhc2UgXCJyZXR1cm5cIjpcbiAgICAgICAgci5yZXNvbHZlKHtcbiAgICAgICAgICB2YWx1ZTogbixcbiAgICAgICAgICBkb25lOiAhMFxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwidGhyb3dcIjpcbiAgICAgICAgci5yZWplY3Qobik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgci5yZXNvbHZlKHtcbiAgICAgICAgICB2YWx1ZTogbixcbiAgICAgICAgICBkb25lOiAhMVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgKHIgPSByLm5leHQpID8gcmVzdW1lKHIua2V5LCByLmFyZykgOiB0ID0gbnVsbDtcbiAgfVxuICB0aGlzLl9pbnZva2UgPSBmdW5jdGlvbiAoZSwgbikge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAobywgdSkge1xuICAgICAgdmFyIGkgPSB7XG4gICAgICAgIGtleTogZSxcbiAgICAgICAgYXJnOiBuLFxuICAgICAgICByZXNvbHZlOiBvLFxuICAgICAgICByZWplY3Q6IHUsXG4gICAgICAgIG5leHQ6IG51bGxcbiAgICAgIH07XG4gICAgICB0ID8gdCA9IHQubmV4dCA9IGkgOiAociA9IHQgPSBpLCByZXN1bWUoZSwgbikpO1xuICAgIH0pO1xuICB9LCBcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIGUucmV0dXJuICYmICh0aGlzLnJldHVybiA9IHZvaWQgMCk7XG59XG5fQXN5bmNHZW5lcmF0b3IucHJvdG90eXBlW1wiZnVuY3Rpb25cIiA9PSB0eXBlb2YgU3ltYm9sICYmIFN5bWJvbC5hc3luY0l0ZXJhdG9yIHx8IFwiQEBhc3luY0l0ZXJhdG9yXCJdID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcztcbn0sIF9Bc3luY0dlbmVyYXRvci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIChlKSB7XG4gIHJldHVybiB0aGlzLl9pbnZva2UoXCJuZXh0XCIsIGUpO1xufSwgX0FzeW5jR2VuZXJhdG9yLnByb3RvdHlwZS50aHJvdyA9IGZ1bmN0aW9uIChlKSB7XG4gIHJldHVybiB0aGlzLl9pbnZva2UoXCJ0aHJvd1wiLCBlKTtcbn0sIF9Bc3luY0dlbmVyYXRvci5wcm90b3R5cGUucmV0dXJuID0gZnVuY3Rpb24gKGUpIHtcbiAgcmV0dXJuIHRoaXMuX2ludm9rZShcInJldHVyblwiLCBlKTtcbn07XG5mdW5jdGlvbiBfT3ZlcmxvYWRZaWVsZCh0LCBlKSB7XG4gIHRoaXMudiA9IHQsIHRoaXMuayA9IGU7XG59XG5mdW5jdGlvbiBvbGRfY3JlYXRlTWV0YWRhdGFNZXRob2RzRm9yUHJvcGVydHkoZSwgdCwgYSwgcikge1xuICByZXR1cm4ge1xuICAgIGdldE1ldGFkYXRhOiBmdW5jdGlvbiAobykge1xuICAgICAgb2xkX2Fzc2VydE5vdEZpbmlzaGVkKHIsIFwiZ2V0TWV0YWRhdGFcIiksIG9sZF9hc3NlcnRNZXRhZGF0YUtleShvKTtcbiAgICAgIHZhciBpID0gZVtvXTtcbiAgICAgIGlmICh2b2lkIDAgIT09IGkpIGlmICgxID09PSB0KSB7XG4gICAgICAgIHZhciBuID0gaS5wdWJsaWM7XG4gICAgICAgIGlmICh2b2lkIDAgIT09IG4pIHJldHVybiBuW2FdO1xuICAgICAgfSBlbHNlIGlmICgyID09PSB0KSB7XG4gICAgICAgIHZhciBsID0gaS5wcml2YXRlO1xuICAgICAgICBpZiAodm9pZCAwICE9PSBsKSByZXR1cm4gbC5nZXQoYSk7XG4gICAgICB9IGVsc2UgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKGksIFwiY29uc3RydWN0b3JcIikpIHJldHVybiBpLmNvbnN0cnVjdG9yO1xuICAgIH0sXG4gICAgc2V0TWV0YWRhdGE6IGZ1bmN0aW9uIChvLCBpKSB7XG4gICAgICBvbGRfYXNzZXJ0Tm90RmluaXNoZWQociwgXCJzZXRNZXRhZGF0YVwiKSwgb2xkX2Fzc2VydE1ldGFkYXRhS2V5KG8pO1xuICAgICAgdmFyIG4gPSBlW29dO1xuICAgICAgaWYgKHZvaWQgMCA9PT0gbiAmJiAobiA9IGVbb10gPSB7fSksIDEgPT09IHQpIHtcbiAgICAgICAgdmFyIGwgPSBuLnB1YmxpYztcbiAgICAgICAgdm9pZCAwID09PSBsICYmIChsID0gbi5wdWJsaWMgPSB7fSksIGxbYV0gPSBpO1xuICAgICAgfSBlbHNlIGlmICgyID09PSB0KSB7XG4gICAgICAgIHZhciBzID0gbi5wcml2O1xuICAgICAgICB2b2lkIDAgPT09IHMgJiYgKHMgPSBuLnByaXZhdGUgPSBuZXcgTWFwKCkpLCBzLnNldChhLCBpKTtcbiAgICAgIH0gZWxzZSBuLmNvbnN0cnVjdG9yID0gaTtcbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiBvbGRfY29udmVydE1ldGFkYXRhTWFwVG9GaW5hbChlLCB0KSB7XG4gIHZhciBhID0gZVtTeW1ib2wubWV0YWRhdGEgfHwgU3ltYm9sLmZvcihcIlN5bWJvbC5tZXRhZGF0YVwiKV0sXG4gICAgciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHModCk7XG4gIGlmICgwICE9PSByLmxlbmd0aCkge1xuICAgIGZvciAodmFyIG8gPSAwOyBvIDwgci5sZW5ndGg7IG8rKykge1xuICAgICAgdmFyIGkgPSByW29dLFxuICAgICAgICBuID0gdFtpXSxcbiAgICAgICAgbCA9IGEgPyBhW2ldIDogbnVsbCxcbiAgICAgICAgcyA9IG4ucHVibGljLFxuICAgICAgICBjID0gbCA/IGwucHVibGljIDogbnVsbDtcbiAgICAgIHMgJiYgYyAmJiBPYmplY3Quc2V0UHJvdG90eXBlT2YocywgYyk7XG4gICAgICB2YXIgZCA9IG4ucHJpdmF0ZTtcbiAgICAgIGlmIChkKSB7XG4gICAgICAgIHZhciB1ID0gQXJyYXkuZnJvbShkLnZhbHVlcygpKSxcbiAgICAgICAgICBmID0gbCA/IGwucHJpdmF0ZSA6IG51bGw7XG4gICAgICAgIGYgJiYgKHUgPSB1LmNvbmNhdChmKSksIG4ucHJpdmF0ZSA9IHU7XG4gICAgICB9XG4gICAgICBsICYmIE9iamVjdC5zZXRQcm90b3R5cGVPZihuLCBsKTtcbiAgICB9XG4gICAgYSAmJiBPYmplY3Quc2V0UHJvdG90eXBlT2YodCwgYSksIGVbU3ltYm9sLm1ldGFkYXRhIHx8IFN5bWJvbC5mb3IoXCJTeW1ib2wubWV0YWRhdGFcIildID0gdDtcbiAgfVxufVxuZnVuY3Rpb24gb2xkX2NyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKGUsIHQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgb2xkX2Fzc2VydE5vdEZpbmlzaGVkKHQsIFwiYWRkSW5pdGlhbGl6ZXJcIiksIG9sZF9hc3NlcnRDYWxsYWJsZShhLCBcIkFuIGluaXRpYWxpemVyXCIpLCBlLnB1c2goYSk7XG4gIH07XG59XG5mdW5jdGlvbiBvbGRfbWVtYmVyRGVjKGUsIHQsIGEsIHIsIG8sIGksIG4sIGwsIHMpIHtcbiAgdmFyIGM7XG4gIHN3aXRjaCAoaSkge1xuICAgIGNhc2UgMTpcbiAgICAgIGMgPSBcImFjY2Vzc29yXCI7XG4gICAgICBicmVhaztcbiAgICBjYXNlIDI6XG4gICAgICBjID0gXCJtZXRob2RcIjtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMzpcbiAgICAgIGMgPSBcImdldHRlclwiO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSA0OlxuICAgICAgYyA9IFwic2V0dGVyXCI7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgYyA9IFwiZmllbGRcIjtcbiAgfVxuICB2YXIgZCxcbiAgICB1LFxuICAgIGYgPSB7XG4gICAgICBraW5kOiBjLFxuICAgICAgbmFtZTogbCA/IFwiI1wiICsgdCA6IHQsXG4gICAgICBpc1N0YXRpYzogbixcbiAgICAgIGlzUHJpdmF0ZTogbFxuICAgIH0sXG4gICAgcCA9IHtcbiAgICAgIHY6ICExXG4gICAgfTtcbiAgaWYgKDAgIT09IGkgJiYgKGYuYWRkSW5pdGlhbGl6ZXIgPSBvbGRfY3JlYXRlQWRkSW5pdGlhbGl6ZXJNZXRob2QobywgcCkpLCBsKSB7XG4gICAgZCA9IDIsIHUgPSBTeW1ib2wodCk7XG4gICAgdmFyIHYgPSB7fTtcbiAgICAwID09PSBpID8gKHYuZ2V0ID0gYS5nZXQsIHYuc2V0ID0gYS5zZXQpIDogMiA9PT0gaSA/IHYuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGEudmFsdWU7XG4gICAgfSA6ICgxICE9PSBpICYmIDMgIT09IGkgfHwgKHYuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGEuZ2V0LmNhbGwodGhpcyk7XG4gICAgfSksIDEgIT09IGkgJiYgNCAhPT0gaSB8fCAodi5zZXQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgYS5zZXQuY2FsbCh0aGlzLCBlKTtcbiAgICB9KSksIGYuYWNjZXNzID0gdjtcbiAgfSBlbHNlIGQgPSAxLCB1ID0gdDtcbiAgdHJ5IHtcbiAgICByZXR1cm4gZShzLCBPYmplY3QuYXNzaWduKGYsIG9sZF9jcmVhdGVNZXRhZGF0YU1ldGhvZHNGb3JQcm9wZXJ0eShyLCBkLCB1LCBwKSkpO1xuICB9IGZpbmFsbHkge1xuICAgIHAudiA9ICEwO1xuICB9XG59XG5mdW5jdGlvbiBvbGRfYXNzZXJ0Tm90RmluaXNoZWQoZSwgdCkge1xuICBpZiAoZS52KSB0aHJvdyBuZXcgRXJyb3IoXCJhdHRlbXB0ZWQgdG8gY2FsbCBcIiArIHQgKyBcIiBhZnRlciBkZWNvcmF0aW9uIHdhcyBmaW5pc2hlZFwiKTtcbn1cbmZ1bmN0aW9uIG9sZF9hc3NlcnRNZXRhZGF0YUtleShlKSB7XG4gIGlmIChcInN5bWJvbFwiICE9IHR5cGVvZiBlKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiTWV0YWRhdGEga2V5cyBtdXN0IGJlIHN5bWJvbHMsIHJlY2VpdmVkOiBcIiArIGUpO1xufVxuZnVuY3Rpb24gb2xkX2Fzc2VydENhbGxhYmxlKGUsIHQpIHtcbiAgaWYgKFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgZSkgdGhyb3cgbmV3IFR5cGVFcnJvcih0ICsgXCIgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xufVxuZnVuY3Rpb24gb2xkX2Fzc2VydFZhbGlkUmV0dXJuVmFsdWUoZSwgdCkge1xuICB2YXIgYSA9IHR5cGVvZiB0O1xuICBpZiAoMSA9PT0gZSkge1xuICAgIGlmIChcIm9iamVjdFwiICE9PSBhIHx8IG51bGwgPT09IHQpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhY2Nlc3NvciBkZWNvcmF0b3JzIG11c3QgcmV0dXJuIGFuIG9iamVjdCB3aXRoIGdldCwgc2V0LCBvciBpbml0IHByb3BlcnRpZXMgb3Igdm9pZCAwXCIpO1xuICAgIHZvaWQgMCAhPT0gdC5nZXQgJiYgb2xkX2Fzc2VydENhbGxhYmxlKHQuZ2V0LCBcImFjY2Vzc29yLmdldFwiKSwgdm9pZCAwICE9PSB0LnNldCAmJiBvbGRfYXNzZXJ0Q2FsbGFibGUodC5zZXQsIFwiYWNjZXNzb3Iuc2V0XCIpLCB2b2lkIDAgIT09IHQuaW5pdCAmJiBvbGRfYXNzZXJ0Q2FsbGFibGUodC5pbml0LCBcImFjY2Vzc29yLmluaXRcIiksIHZvaWQgMCAhPT0gdC5pbml0aWFsaXplciAmJiBvbGRfYXNzZXJ0Q2FsbGFibGUodC5pbml0aWFsaXplciwgXCJhY2Nlc3Nvci5pbml0aWFsaXplclwiKTtcbiAgfSBlbHNlIGlmIChcImZ1bmN0aW9uXCIgIT09IGEpIHtcbiAgICB2YXIgcjtcbiAgICB0aHJvdyByID0gMCA9PT0gZSA/IFwiZmllbGRcIiA6IDEwID09PSBlID8gXCJjbGFzc1wiIDogXCJtZXRob2RcIiwgbmV3IFR5cGVFcnJvcihyICsgXCIgZGVjb3JhdG9ycyBtdXN0IHJldHVybiBhIGZ1bmN0aW9uIG9yIHZvaWQgMFwiKTtcbiAgfVxufVxuZnVuY3Rpb24gb2xkX2dldEluaXQoZSkge1xuICB2YXIgdDtcbiAgcmV0dXJuIG51bGwgPT0gKHQgPSBlLmluaXQpICYmICh0ID0gZS5pbml0aWFsaXplcikgJiYgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgY29uc29sZSAmJiBjb25zb2xlLndhcm4oXCIuaW5pdGlhbGl6ZXIgaGFzIGJlZW4gcmVuYW1lZCB0byAuaW5pdCBhcyBvZiBNYXJjaCAyMDIyXCIpLCB0O1xufVxuZnVuY3Rpb24gb2xkX2FwcGx5TWVtYmVyRGVjKGUsIHQsIGEsIHIsIG8sIGksIG4sIGwsIHMpIHtcbiAgdmFyIGMsXG4gICAgZCxcbiAgICB1LFxuICAgIGYsXG4gICAgcCxcbiAgICB2LFxuICAgIGggPSBhWzBdO1xuICBpZiAobiA/IGMgPSAwID09PSBvIHx8IDEgPT09IG8gPyB7XG4gICAgZ2V0OiBhWzNdLFxuICAgIHNldDogYVs0XVxuICB9IDogMyA9PT0gbyA/IHtcbiAgICBnZXQ6IGFbM11cbiAgfSA6IDQgPT09IG8gPyB7XG4gICAgc2V0OiBhWzNdXG4gIH0gOiB7XG4gICAgdmFsdWU6IGFbM11cbiAgfSA6IDAgIT09IG8gJiYgKGMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsIHIpKSwgMSA9PT0gbyA/IHUgPSB7XG4gICAgZ2V0OiBjLmdldCxcbiAgICBzZXQ6IGMuc2V0XG4gIH0gOiAyID09PSBvID8gdSA9IGMudmFsdWUgOiAzID09PSBvID8gdSA9IGMuZ2V0IDogNCA9PT0gbyAmJiAodSA9IGMuc2V0KSwgXCJmdW5jdGlvblwiID09IHR5cGVvZiBoKSB2b2lkIDAgIT09IChmID0gb2xkX21lbWJlckRlYyhoLCByLCBjLCBsLCBzLCBvLCBpLCBuLCB1KSkgJiYgKG9sZF9hc3NlcnRWYWxpZFJldHVyblZhbHVlKG8sIGYpLCAwID09PSBvID8gZCA9IGYgOiAxID09PSBvID8gKGQgPSBvbGRfZ2V0SW5pdChmKSwgcCA9IGYuZ2V0IHx8IHUuZ2V0LCB2ID0gZi5zZXQgfHwgdS5zZXQsIHUgPSB7XG4gICAgZ2V0OiBwLFxuICAgIHNldDogdlxuICB9KSA6IHUgPSBmKTtlbHNlIGZvciAodmFyIHkgPSBoLmxlbmd0aCAtIDE7IHkgPj0gMDsgeS0tKSB7XG4gICAgdmFyIGI7XG4gICAgaWYgKHZvaWQgMCAhPT0gKGYgPSBvbGRfbWVtYmVyRGVjKGhbeV0sIHIsIGMsIGwsIHMsIG8sIGksIG4sIHUpKSkgb2xkX2Fzc2VydFZhbGlkUmV0dXJuVmFsdWUobywgZiksIDAgPT09IG8gPyBiID0gZiA6IDEgPT09IG8gPyAoYiA9IG9sZF9nZXRJbml0KGYpLCBwID0gZi5nZXQgfHwgdS5nZXQsIHYgPSBmLnNldCB8fCB1LnNldCwgdSA9IHtcbiAgICAgIGdldDogcCxcbiAgICAgIHNldDogdlxuICAgIH0pIDogdSA9IGYsIHZvaWQgMCAhPT0gYiAmJiAodm9pZCAwID09PSBkID8gZCA9IGIgOiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGQgPyBkID0gW2QsIGJdIDogZC5wdXNoKGIpKTtcbiAgfVxuICBpZiAoMCA9PT0gbyB8fCAxID09PSBvKSB7XG4gICAgaWYgKHZvaWQgMCA9PT0gZCkgZCA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICByZXR1cm4gdDtcbiAgICB9O2Vsc2UgaWYgKFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgZCkge1xuICAgICAgdmFyIGcgPSBkO1xuICAgICAgZCA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgIGZvciAodmFyIGEgPSB0LCByID0gMDsgciA8IGcubGVuZ3RoOyByKyspIGEgPSBnW3JdLmNhbGwoZSwgYSk7XG4gICAgICAgIHJldHVybiBhO1xuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIG0gPSBkO1xuICAgICAgZCA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgIHJldHVybiBtLmNhbGwoZSwgdCk7XG4gICAgICB9O1xuICAgIH1cbiAgICBlLnB1c2goZCk7XG4gIH1cbiAgMCAhPT0gbyAmJiAoMSA9PT0gbyA/IChjLmdldCA9IHUuZ2V0LCBjLnNldCA9IHUuc2V0KSA6IDIgPT09IG8gPyBjLnZhbHVlID0gdSA6IDMgPT09IG8gPyBjLmdldCA9IHUgOiA0ID09PSBvICYmIChjLnNldCA9IHUpLCBuID8gMSA9PT0gbyA/IChlLnB1c2goZnVuY3Rpb24gKGUsIHQpIHtcbiAgICByZXR1cm4gdS5nZXQuY2FsbChlLCB0KTtcbiAgfSksIGUucHVzaChmdW5jdGlvbiAoZSwgdCkge1xuICAgIHJldHVybiB1LnNldC5jYWxsKGUsIHQpO1xuICB9KSkgOiAyID09PSBvID8gZS5wdXNoKHUpIDogZS5wdXNoKGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgcmV0dXJuIHUuY2FsbChlLCB0KTtcbiAgfSkgOiBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgciwgYykpO1xufVxuZnVuY3Rpb24gb2xkX2FwcGx5TWVtYmVyRGVjcyhlLCB0LCBhLCByLCBvKSB7XG4gIGZvciAodmFyIGksIG4sIGwgPSBuZXcgTWFwKCksIHMgPSBuZXcgTWFwKCksIGMgPSAwOyBjIDwgby5sZW5ndGg7IGMrKykge1xuICAgIHZhciBkID0gb1tjXTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShkKSkge1xuICAgICAgdmFyIHUsXG4gICAgICAgIGYsXG4gICAgICAgIHAsXG4gICAgICAgIHYgPSBkWzFdLFxuICAgICAgICBoID0gZFsyXSxcbiAgICAgICAgeSA9IGQubGVuZ3RoID4gMyxcbiAgICAgICAgYiA9IHYgPj0gNTtcbiAgICAgIGlmIChiID8gKHUgPSB0LCBmID0gciwgMCAhPT0gKHYgLT0gNSkgJiYgKHAgPSBuID0gbiB8fCBbXSkpIDogKHUgPSB0LnByb3RvdHlwZSwgZiA9IGEsIDAgIT09IHYgJiYgKHAgPSBpID0gaSB8fCBbXSkpLCAwICE9PSB2ICYmICF5KSB7XG4gICAgICAgIHZhciBnID0gYiA/IHMgOiBsLFxuICAgICAgICAgIG0gPSBnLmdldChoKSB8fCAwO1xuICAgICAgICBpZiAoITAgPT09IG0gfHwgMyA9PT0gbSAmJiA0ICE9PSB2IHx8IDQgPT09IG0gJiYgMyAhPT0gdikgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGRlY29yYXRlIGEgcHVibGljIG1ldGhvZC9hY2Nlc3NvciB0aGF0IGhhcyB0aGUgc2FtZSBuYW1lIGFzIGEgcHJldmlvdXNseSBkZWNvcmF0ZWQgcHVibGljIG1ldGhvZC9hY2Nlc3Nvci4gVGhpcyBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBieSB0aGUgZGVjb3JhdG9ycyBwbHVnaW4uIFByb3BlcnR5IG5hbWUgd2FzOiBcIiArIGgpO1xuICAgICAgICAhbSAmJiB2ID4gMiA/IGcuc2V0KGgsIHYpIDogZy5zZXQoaCwgITApO1xuICAgICAgfVxuICAgICAgb2xkX2FwcGx5TWVtYmVyRGVjKGUsIHUsIGQsIGgsIHYsIGIsIHksIGYsIHApO1xuICAgIH1cbiAgfVxuICBvbGRfcHVzaEluaXRpYWxpemVycyhlLCBpKSwgb2xkX3B1c2hJbml0aWFsaXplcnMoZSwgbik7XG59XG5mdW5jdGlvbiBvbGRfcHVzaEluaXRpYWxpemVycyhlLCB0KSB7XG4gIHQgJiYgZS5wdXNoKGZ1bmN0aW9uIChlKSB7XG4gICAgZm9yICh2YXIgYSA9IDA7IGEgPCB0Lmxlbmd0aDsgYSsrKSB0W2FdLmNhbGwoZSk7XG4gICAgcmV0dXJuIGU7XG4gIH0pO1xufVxuZnVuY3Rpb24gb2xkX2FwcGx5Q2xhc3NEZWNzKGUsIHQsIGEsIHIpIHtcbiAgaWYgKHIubGVuZ3RoID4gMCkge1xuICAgIGZvciAodmFyIG8gPSBbXSwgaSA9IHQsIG4gPSB0Lm5hbWUsIGwgPSByLmxlbmd0aCAtIDE7IGwgPj0gMDsgbC0tKSB7XG4gICAgICB2YXIgcyA9IHtcbiAgICAgICAgdjogITFcbiAgICAgIH07XG4gICAgICB0cnkge1xuICAgICAgICB2YXIgYyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAga2luZDogXCJjbGFzc1wiLFxuICAgICAgICAgICAgbmFtZTogbixcbiAgICAgICAgICAgIGFkZEluaXRpYWxpemVyOiBvbGRfY3JlYXRlQWRkSW5pdGlhbGl6ZXJNZXRob2QobywgcylcbiAgICAgICAgICB9LCBvbGRfY3JlYXRlTWV0YWRhdGFNZXRob2RzRm9yUHJvcGVydHkoYSwgMCwgbiwgcykpLFxuICAgICAgICAgIGQgPSByW2xdKGksIGMpO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgcy52ID0gITA7XG4gICAgICB9XG4gICAgICB2b2lkIDAgIT09IGQgJiYgKG9sZF9hc3NlcnRWYWxpZFJldHVyblZhbHVlKDEwLCBkKSwgaSA9IGQpO1xuICAgIH1cbiAgICBlLnB1c2goaSwgZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCBvLmxlbmd0aDsgZSsrKSBvW2VdLmNhbGwoaSk7XG4gICAgfSk7XG4gIH1cbn1cbmZ1bmN0aW9uIF9hcHBseURlY3MoZSwgdCwgYSkge1xuICB2YXIgciA9IFtdLFxuICAgIG8gPSB7fSxcbiAgICBpID0ge307XG4gIHJldHVybiBvbGRfYXBwbHlNZW1iZXJEZWNzKHIsIGUsIGksIG8sIHQpLCBvbGRfY29udmVydE1ldGFkYXRhTWFwVG9GaW5hbChlLnByb3RvdHlwZSwgaSksIG9sZF9hcHBseUNsYXNzRGVjcyhyLCBlLCBvLCBhKSwgb2xkX2NvbnZlcnRNZXRhZGF0YU1hcFRvRmluYWwoZSwgbyksIHI7XG59XG5mdW5jdGlvbiBhcHBseURlY3MyMjAzRmFjdG9yeSgpIHtcbiAgZnVuY3Rpb24gY3JlYXRlQWRkSW5pdGlhbGl6ZXJNZXRob2QoZSwgdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAocikge1xuICAgICAgIWZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgIGlmIChlLnYpIHRocm93IG5ldyBFcnJvcihcImF0dGVtcHRlZCB0byBjYWxsIFwiICsgdCArIFwiIGFmdGVyIGRlY29yYXRpb24gd2FzIGZpbmlzaGVkXCIpO1xuICAgICAgfSh0LCBcImFkZEluaXRpYWxpemVyXCIpLCBhc3NlcnRDYWxsYWJsZShyLCBcIkFuIGluaXRpYWxpemVyXCIpLCBlLnB1c2gocik7XG4gICAgfTtcbiAgfVxuICBmdW5jdGlvbiBtZW1iZXJEZWMoZSwgdCwgciwgYSwgbiwgaSwgcywgbykge1xuICAgIHZhciBjO1xuICAgIHN3aXRjaCAobikge1xuICAgICAgY2FzZSAxOlxuICAgICAgICBjID0gXCJhY2Nlc3NvclwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgYyA9IFwibWV0aG9kXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAzOlxuICAgICAgICBjID0gXCJnZXR0ZXJcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDQ6XG4gICAgICAgIGMgPSBcInNldHRlclwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGMgPSBcImZpZWxkXCI7XG4gICAgfVxuICAgIHZhciBsLFxuICAgICAgdSxcbiAgICAgIGYgPSB7XG4gICAgICAgIGtpbmQ6IGMsXG4gICAgICAgIG5hbWU6IHMgPyBcIiNcIiArIHQgOiB0LFxuICAgICAgICBzdGF0aWM6IGksXG4gICAgICAgIHByaXZhdGU6IHNcbiAgICAgIH0sXG4gICAgICBwID0ge1xuICAgICAgICB2OiAhMVxuICAgICAgfTtcbiAgICAwICE9PSBuICYmIChmLmFkZEluaXRpYWxpemVyID0gY3JlYXRlQWRkSW5pdGlhbGl6ZXJNZXRob2QoYSwgcCkpLCAwID09PSBuID8gcyA/IChsID0gci5nZXQsIHUgPSByLnNldCkgOiAobCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzW3RdO1xuICAgIH0sIHUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpc1t0XSA9IGU7XG4gICAgfSkgOiAyID09PSBuID8gbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiByLnZhbHVlO1xuICAgIH0gOiAoMSAhPT0gbiAmJiAzICE9PSBuIHx8IChsID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHIuZ2V0LmNhbGwodGhpcyk7XG4gICAgfSksIDEgIT09IG4gJiYgNCAhPT0gbiB8fCAodSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICByLnNldC5jYWxsKHRoaXMsIGUpO1xuICAgIH0pKSwgZi5hY2Nlc3MgPSBsICYmIHUgPyB7XG4gICAgICBnZXQ6IGwsXG4gICAgICBzZXQ6IHVcbiAgICB9IDogbCA/IHtcbiAgICAgIGdldDogbFxuICAgIH0gOiB7XG4gICAgICBzZXQ6IHVcbiAgICB9O1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gZShvLCBmKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgcC52ID0gITA7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGFzc2VydENhbGxhYmxlKGUsIHQpIHtcbiAgICBpZiAoXCJmdW5jdGlvblwiICE9IHR5cGVvZiBlKSB0aHJvdyBuZXcgVHlwZUVycm9yKHQgKyBcIiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gIH1cbiAgZnVuY3Rpb24gYXNzZXJ0VmFsaWRSZXR1cm5WYWx1ZShlLCB0KSB7XG4gICAgdmFyIHIgPSB0eXBlb2YgdDtcbiAgICBpZiAoMSA9PT0gZSkge1xuICAgICAgaWYgKFwib2JqZWN0XCIgIT09IHIgfHwgbnVsbCA9PT0gdCkgdGhyb3cgbmV3IFR5cGVFcnJvcihcImFjY2Vzc29yIGRlY29yYXRvcnMgbXVzdCByZXR1cm4gYW4gb2JqZWN0IHdpdGggZ2V0LCBzZXQsIG9yIGluaXQgcHJvcGVydGllcyBvciB2b2lkIDBcIik7XG4gICAgICB2b2lkIDAgIT09IHQuZ2V0ICYmIGFzc2VydENhbGxhYmxlKHQuZ2V0LCBcImFjY2Vzc29yLmdldFwiKSwgdm9pZCAwICE9PSB0LnNldCAmJiBhc3NlcnRDYWxsYWJsZSh0LnNldCwgXCJhY2Nlc3Nvci5zZXRcIiksIHZvaWQgMCAhPT0gdC5pbml0ICYmIGFzc2VydENhbGxhYmxlKHQuaW5pdCwgXCJhY2Nlc3Nvci5pbml0XCIpO1xuICAgIH0gZWxzZSBpZiAoXCJmdW5jdGlvblwiICE9PSByKSB7XG4gICAgICB2YXIgYTtcbiAgICAgIHRocm93IGEgPSAwID09PSBlID8gXCJmaWVsZFwiIDogMTAgPT09IGUgPyBcImNsYXNzXCIgOiBcIm1ldGhvZFwiLCBuZXcgVHlwZUVycm9yKGEgKyBcIiBkZWNvcmF0b3JzIG11c3QgcmV0dXJuIGEgZnVuY3Rpb24gb3Igdm9pZCAwXCIpO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBhcHBseU1lbWJlckRlYyhlLCB0LCByLCBhLCBuLCBpLCBzLCBvKSB7XG4gICAgdmFyIGMsXG4gICAgICBsLFxuICAgICAgdSxcbiAgICAgIGYsXG4gICAgICBwLFxuICAgICAgZCxcbiAgICAgIGggPSByWzBdO1xuICAgIGlmIChzID8gYyA9IDAgPT09IG4gfHwgMSA9PT0gbiA/IHtcbiAgICAgIGdldDogclszXSxcbiAgICAgIHNldDogcls0XVxuICAgIH0gOiAzID09PSBuID8ge1xuICAgICAgZ2V0OiByWzNdXG4gICAgfSA6IDQgPT09IG4gPyB7XG4gICAgICBzZXQ6IHJbM11cbiAgICB9IDoge1xuICAgICAgdmFsdWU6IHJbM11cbiAgICB9IDogMCAhPT0gbiAmJiAoYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCwgYSkpLCAxID09PSBuID8gdSA9IHtcbiAgICAgIGdldDogYy5nZXQsXG4gICAgICBzZXQ6IGMuc2V0XG4gICAgfSA6IDIgPT09IG4gPyB1ID0gYy52YWx1ZSA6IDMgPT09IG4gPyB1ID0gYy5nZXQgOiA0ID09PSBuICYmICh1ID0gYy5zZXQpLCBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGgpIHZvaWQgMCAhPT0gKGYgPSBtZW1iZXJEZWMoaCwgYSwgYywgbywgbiwgaSwgcywgdSkpICYmIChhc3NlcnRWYWxpZFJldHVyblZhbHVlKG4sIGYpLCAwID09PSBuID8gbCA9IGYgOiAxID09PSBuID8gKGwgPSBmLmluaXQsIHAgPSBmLmdldCB8fCB1LmdldCwgZCA9IGYuc2V0IHx8IHUuc2V0LCB1ID0ge1xuICAgICAgZ2V0OiBwLFxuICAgICAgc2V0OiBkXG4gICAgfSkgOiB1ID0gZik7ZWxzZSBmb3IgKHZhciB2ID0gaC5sZW5ndGggLSAxOyB2ID49IDA7IHYtLSkge1xuICAgICAgdmFyIGc7XG4gICAgICBpZiAodm9pZCAwICE9PSAoZiA9IG1lbWJlckRlYyhoW3ZdLCBhLCBjLCBvLCBuLCBpLCBzLCB1KSkpIGFzc2VydFZhbGlkUmV0dXJuVmFsdWUobiwgZiksIDAgPT09IG4gPyBnID0gZiA6IDEgPT09IG4gPyAoZyA9IGYuaW5pdCwgcCA9IGYuZ2V0IHx8IHUuZ2V0LCBkID0gZi5zZXQgfHwgdS5zZXQsIHUgPSB7XG4gICAgICAgIGdldDogcCxcbiAgICAgICAgc2V0OiBkXG4gICAgICB9KSA6IHUgPSBmLCB2b2lkIDAgIT09IGcgJiYgKHZvaWQgMCA9PT0gbCA/IGwgPSBnIDogXCJmdW5jdGlvblwiID09IHR5cGVvZiBsID8gbCA9IFtsLCBnXSA6IGwucHVzaChnKSk7XG4gICAgfVxuICAgIGlmICgwID09PSBuIHx8IDEgPT09IG4pIHtcbiAgICAgIGlmICh2b2lkIDAgPT09IGwpIGwgPSBmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICByZXR1cm4gdDtcbiAgICAgIH07ZWxzZSBpZiAoXCJmdW5jdGlvblwiICE9IHR5cGVvZiBsKSB7XG4gICAgICAgIHZhciB5ID0gbDtcbiAgICAgICAgbCA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgICAgZm9yICh2YXIgciA9IHQsIGEgPSAwOyBhIDwgeS5sZW5ndGg7IGErKykgciA9IHlbYV0uY2FsbChlLCByKTtcbiAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBtID0gbDtcbiAgICAgICAgbCA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgICAgcmV0dXJuIG0uY2FsbChlLCB0KTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGUucHVzaChsKTtcbiAgICB9XG4gICAgMCAhPT0gbiAmJiAoMSA9PT0gbiA/IChjLmdldCA9IHUuZ2V0LCBjLnNldCA9IHUuc2V0KSA6IDIgPT09IG4gPyBjLnZhbHVlID0gdSA6IDMgPT09IG4gPyBjLmdldCA9IHUgOiA0ID09PSBuICYmIChjLnNldCA9IHUpLCBzID8gMSA9PT0gbiA/IChlLnB1c2goZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgIHJldHVybiB1LmdldC5jYWxsKGUsIHQpO1xuICAgIH0pLCBlLnB1c2goZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgIHJldHVybiB1LnNldC5jYWxsKGUsIHQpO1xuICAgIH0pKSA6IDIgPT09IG4gPyBlLnB1c2godSkgOiBlLnB1c2goZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgIHJldHVybiB1LmNhbGwoZSwgdCk7XG4gICAgfSkgOiBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgYSwgYykpO1xuICB9XG4gIGZ1bmN0aW9uIHB1c2hJbml0aWFsaXplcnMoZSwgdCkge1xuICAgIHQgJiYgZS5wdXNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICBmb3IgKHZhciByID0gMDsgciA8IHQubGVuZ3RoOyByKyspIHRbcl0uY2FsbChlKTtcbiAgICAgIHJldHVybiBlO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBmdW5jdGlvbiAoZSwgdCwgcikge1xuICAgIHZhciBhID0gW107XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChlLCB0LCByKSB7XG4gICAgICBmb3IgKHZhciBhLCBuLCBpID0gbmV3IE1hcCgpLCBzID0gbmV3IE1hcCgpLCBvID0gMDsgbyA8IHIubGVuZ3RoOyBvKyspIHtcbiAgICAgICAgdmFyIGMgPSByW29dO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjKSkge1xuICAgICAgICAgIHZhciBsLFxuICAgICAgICAgICAgdSxcbiAgICAgICAgICAgIGYgPSBjWzFdLFxuICAgICAgICAgICAgcCA9IGNbMl0sXG4gICAgICAgICAgICBkID0gYy5sZW5ndGggPiAzLFxuICAgICAgICAgICAgaCA9IGYgPj0gNTtcbiAgICAgICAgICBpZiAoaCA/IChsID0gdCwgMCAhPSAoZiAtPSA1KSAmJiAodSA9IG4gPSBuIHx8IFtdKSkgOiAobCA9IHQucHJvdG90eXBlLCAwICE9PSBmICYmICh1ID0gYSA9IGEgfHwgW10pKSwgMCAhPT0gZiAmJiAhZCkge1xuICAgICAgICAgICAgdmFyIHYgPSBoID8gcyA6IGksXG4gICAgICAgICAgICAgIGcgPSB2LmdldChwKSB8fCAwO1xuICAgICAgICAgICAgaWYgKCEwID09PSBnIHx8IDMgPT09IGcgJiYgNCAhPT0gZiB8fCA0ID09PSBnICYmIDMgIT09IGYpIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBkZWNvcmF0ZSBhIHB1YmxpYyBtZXRob2QvYWNjZXNzb3IgdGhhdCBoYXMgdGhlIHNhbWUgbmFtZSBhcyBhIHByZXZpb3VzbHkgZGVjb3JhdGVkIHB1YmxpYyBtZXRob2QvYWNjZXNzb3IuIFRoaXMgaXMgbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgYnkgdGhlIGRlY29yYXRvcnMgcGx1Z2luLiBQcm9wZXJ0eSBuYW1lIHdhczogXCIgKyBwKTtcbiAgICAgICAgICAgICFnICYmIGYgPiAyID8gdi5zZXQocCwgZikgOiB2LnNldChwLCAhMCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFwcGx5TWVtYmVyRGVjKGUsIGwsIGMsIHAsIGYsIGgsIGQsIHUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBwdXNoSW5pdGlhbGl6ZXJzKGUsIGEpLCBwdXNoSW5pdGlhbGl6ZXJzKGUsIG4pO1xuICAgIH0oYSwgZSwgdCksIGZ1bmN0aW9uIChlLCB0LCByKSB7XG4gICAgICBpZiAoci5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZvciAodmFyIGEgPSBbXSwgbiA9IHQsIGkgPSB0Lm5hbWUsIHMgPSByLmxlbmd0aCAtIDE7IHMgPj0gMDsgcy0tKSB7XG4gICAgICAgICAgdmFyIG8gPSB7XG4gICAgICAgICAgICB2OiAhMVxuICAgICAgICAgIH07XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBjID0gcltzXShuLCB7XG4gICAgICAgICAgICAgIGtpbmQ6IFwiY2xhc3NcIixcbiAgICAgICAgICAgICAgbmFtZTogaSxcbiAgICAgICAgICAgICAgYWRkSW5pdGlhbGl6ZXI6IGNyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKGEsIG8pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgby52ID0gITA7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZvaWQgMCAhPT0gYyAmJiAoYXNzZXJ0VmFsaWRSZXR1cm5WYWx1ZSgxMCwgYyksIG4gPSBjKTtcbiAgICAgICAgfVxuICAgICAgICBlLnB1c2gobiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgYS5sZW5ndGg7IGUrKykgYVtlXS5jYWxsKG4pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KGEsIGUsIHIpLCBhO1xuICB9O1xufVxudmFyIGFwcGx5RGVjczIyMDNJbXBsO1xuZnVuY3Rpb24gX2FwcGx5RGVjczIyMDMoZSwgdCwgcikge1xuICByZXR1cm4gKGFwcGx5RGVjczIyMDNJbXBsID0gYXBwbHlEZWNzMjIwM0ltcGwgfHwgYXBwbHlEZWNzMjIwM0ZhY3RvcnkoKSkoZSwgdCwgcik7XG59XG5mdW5jdGlvbiBhcHBseURlY3MyMjAzUkZhY3RvcnkoKSB7XG4gIGZ1bmN0aW9uIGNyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKGUsIHQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHIpIHtcbiAgICAgICFmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICBpZiAoZS52KSB0aHJvdyBuZXcgRXJyb3IoXCJhdHRlbXB0ZWQgdG8gY2FsbCBcIiArIHQgKyBcIiBhZnRlciBkZWNvcmF0aW9uIHdhcyBmaW5pc2hlZFwiKTtcbiAgICAgIH0odCwgXCJhZGRJbml0aWFsaXplclwiKSwgYXNzZXJ0Q2FsbGFibGUociwgXCJBbiBpbml0aWFsaXplclwiKSwgZS5wdXNoKHIpO1xuICAgIH07XG4gIH1cbiAgZnVuY3Rpb24gbWVtYmVyRGVjKGUsIHQsIHIsIG4sIGEsIGksIHMsIG8pIHtcbiAgICB2YXIgYztcbiAgICBzd2l0Y2ggKGEpIHtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgYyA9IFwiYWNjZXNzb3JcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIGMgPSBcIm1ldGhvZFwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgYyA9IFwiZ2V0dGVyXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSA0OlxuICAgICAgICBjID0gXCJzZXR0ZXJcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjID0gXCJmaWVsZFwiO1xuICAgIH1cbiAgICB2YXIgbCxcbiAgICAgIHUsXG4gICAgICBmID0ge1xuICAgICAgICBraW5kOiBjLFxuICAgICAgICBuYW1lOiBzID8gXCIjXCIgKyB0IDogdCxcbiAgICAgICAgc3RhdGljOiBpLFxuICAgICAgICBwcml2YXRlOiBzXG4gICAgICB9LFxuICAgICAgcCA9IHtcbiAgICAgICAgdjogITFcbiAgICAgIH07XG4gICAgMCAhPT0gYSAmJiAoZi5hZGRJbml0aWFsaXplciA9IGNyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKG4sIHApKSwgMCA9PT0gYSA/IHMgPyAobCA9IHIuZ2V0LCB1ID0gci5zZXQpIDogKGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpc1t0XTtcbiAgICB9LCB1ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXNbdF0gPSBlO1xuICAgIH0pIDogMiA9PT0gYSA/IGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gci52YWx1ZTtcbiAgICB9IDogKDEgIT09IGEgJiYgMyAhPT0gYSB8fCAobCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiByLmdldC5jYWxsKHRoaXMpO1xuICAgIH0pLCAxICE9PSBhICYmIDQgIT09IGEgfHwgKHUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgci5zZXQuY2FsbCh0aGlzLCBlKTtcbiAgICB9KSksIGYuYWNjZXNzID0gbCAmJiB1ID8ge1xuICAgICAgZ2V0OiBsLFxuICAgICAgc2V0OiB1XG4gICAgfSA6IGwgPyB7XG4gICAgICBnZXQ6IGxcbiAgICB9IDoge1xuICAgICAgc2V0OiB1XG4gICAgfTtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGUobywgZik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHAudiA9ICEwO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBhc3NlcnRDYWxsYWJsZShlLCB0KSB7XG4gICAgaWYgKFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgZSkgdGhyb3cgbmV3IFR5cGVFcnJvcih0ICsgXCIgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICB9XG4gIGZ1bmN0aW9uIGFzc2VydFZhbGlkUmV0dXJuVmFsdWUoZSwgdCkge1xuICAgIHZhciByID0gdHlwZW9mIHQ7XG4gICAgaWYgKDEgPT09IGUpIHtcbiAgICAgIGlmIChcIm9iamVjdFwiICE9PSByIHx8IG51bGwgPT09IHQpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhY2Nlc3NvciBkZWNvcmF0b3JzIG11c3QgcmV0dXJuIGFuIG9iamVjdCB3aXRoIGdldCwgc2V0LCBvciBpbml0IHByb3BlcnRpZXMgb3Igdm9pZCAwXCIpO1xuICAgICAgdm9pZCAwICE9PSB0LmdldCAmJiBhc3NlcnRDYWxsYWJsZSh0LmdldCwgXCJhY2Nlc3Nvci5nZXRcIiksIHZvaWQgMCAhPT0gdC5zZXQgJiYgYXNzZXJ0Q2FsbGFibGUodC5zZXQsIFwiYWNjZXNzb3Iuc2V0XCIpLCB2b2lkIDAgIT09IHQuaW5pdCAmJiBhc3NlcnRDYWxsYWJsZSh0LmluaXQsIFwiYWNjZXNzb3IuaW5pdFwiKTtcbiAgICB9IGVsc2UgaWYgKFwiZnVuY3Rpb25cIiAhPT0gcikge1xuICAgICAgdmFyIG47XG4gICAgICB0aHJvdyBuID0gMCA9PT0gZSA/IFwiZmllbGRcIiA6IDEwID09PSBlID8gXCJjbGFzc1wiIDogXCJtZXRob2RcIiwgbmV3IFR5cGVFcnJvcihuICsgXCIgZGVjb3JhdG9ycyBtdXN0IHJldHVybiBhIGZ1bmN0aW9uIG9yIHZvaWQgMFwiKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gYXBwbHlNZW1iZXJEZWMoZSwgdCwgciwgbiwgYSwgaSwgcywgbykge1xuICAgIHZhciBjLFxuICAgICAgbCxcbiAgICAgIHUsXG4gICAgICBmLFxuICAgICAgcCxcbiAgICAgIGQsXG4gICAgICBoID0gclswXTtcbiAgICBpZiAocyA/IGMgPSAwID09PSBhIHx8IDEgPT09IGEgPyB7XG4gICAgICBnZXQ6IHJbM10sXG4gICAgICBzZXQ6IHJbNF1cbiAgICB9IDogMyA9PT0gYSA/IHtcbiAgICAgIGdldDogclszXVxuICAgIH0gOiA0ID09PSBhID8ge1xuICAgICAgc2V0OiByWzNdXG4gICAgfSA6IHtcbiAgICAgIHZhbHVlOiByWzNdXG4gICAgfSA6IDAgIT09IGEgJiYgKGMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsIG4pKSwgMSA9PT0gYSA/IHUgPSB7XG4gICAgICBnZXQ6IGMuZ2V0LFxuICAgICAgc2V0OiBjLnNldFxuICAgIH0gOiAyID09PSBhID8gdSA9IGMudmFsdWUgOiAzID09PSBhID8gdSA9IGMuZ2V0IDogNCA9PT0gYSAmJiAodSA9IGMuc2V0KSwgXCJmdW5jdGlvblwiID09IHR5cGVvZiBoKSB2b2lkIDAgIT09IChmID0gbWVtYmVyRGVjKGgsIG4sIGMsIG8sIGEsIGksIHMsIHUpKSAmJiAoYXNzZXJ0VmFsaWRSZXR1cm5WYWx1ZShhLCBmKSwgMCA9PT0gYSA/IGwgPSBmIDogMSA9PT0gYSA/IChsID0gZi5pbml0LCBwID0gZi5nZXQgfHwgdS5nZXQsIGQgPSBmLnNldCB8fCB1LnNldCwgdSA9IHtcbiAgICAgIGdldDogcCxcbiAgICAgIHNldDogZFxuICAgIH0pIDogdSA9IGYpO2Vsc2UgZm9yICh2YXIgdiA9IGgubGVuZ3RoIC0gMTsgdiA+PSAwOyB2LS0pIHtcbiAgICAgIHZhciBnO1xuICAgICAgaWYgKHZvaWQgMCAhPT0gKGYgPSBtZW1iZXJEZWMoaFt2XSwgbiwgYywgbywgYSwgaSwgcywgdSkpKSBhc3NlcnRWYWxpZFJldHVyblZhbHVlKGEsIGYpLCAwID09PSBhID8gZyA9IGYgOiAxID09PSBhID8gKGcgPSBmLmluaXQsIHAgPSBmLmdldCB8fCB1LmdldCwgZCA9IGYuc2V0IHx8IHUuc2V0LCB1ID0ge1xuICAgICAgICBnZXQ6IHAsXG4gICAgICAgIHNldDogZFxuICAgICAgfSkgOiB1ID0gZiwgdm9pZCAwICE9PSBnICYmICh2b2lkIDAgPT09IGwgPyBsID0gZyA6IFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgbCA/IGwgPSBbbCwgZ10gOiBsLnB1c2goZykpO1xuICAgIH1cbiAgICBpZiAoMCA9PT0gYSB8fCAxID09PSBhKSB7XG4gICAgICBpZiAodm9pZCAwID09PSBsKSBsID0gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgICB9O2Vsc2UgaWYgKFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgbCkge1xuICAgICAgICB2YXIgeSA9IGw7XG4gICAgICAgIGwgPSBmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICAgIGZvciAodmFyIHIgPSB0LCBuID0gMDsgbiA8IHkubGVuZ3RoOyBuKyspIHIgPSB5W25dLmNhbGwoZSwgcik7XG4gICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgbSA9IGw7XG4gICAgICAgIGwgPSBmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICAgIHJldHVybiBtLmNhbGwoZSwgdCk7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBlLnB1c2gobCk7XG4gICAgfVxuICAgIDAgIT09IGEgJiYgKDEgPT09IGEgPyAoYy5nZXQgPSB1LmdldCwgYy5zZXQgPSB1LnNldCkgOiAyID09PSBhID8gYy52YWx1ZSA9IHUgOiAzID09PSBhID8gYy5nZXQgPSB1IDogNCA9PT0gYSAmJiAoYy5zZXQgPSB1KSwgcyA/IDEgPT09IGEgPyAoZS5wdXNoKGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICByZXR1cm4gdS5nZXQuY2FsbChlLCB0KTtcbiAgICB9KSwgZS5wdXNoKGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICByZXR1cm4gdS5zZXQuY2FsbChlLCB0KTtcbiAgICB9KSkgOiAyID09PSBhID8gZS5wdXNoKHUpIDogZS5wdXNoKGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICByZXR1cm4gdS5jYWxsKGUsIHQpO1xuICAgIH0pIDogT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIG4sIGMpKTtcbiAgfVxuICBmdW5jdGlvbiBhcHBseU1lbWJlckRlY3MoZSwgdCkge1xuICAgIGZvciAodmFyIHIsIG4sIGEgPSBbXSwgaSA9IG5ldyBNYXAoKSwgcyA9IG5ldyBNYXAoKSwgbyA9IDA7IG8gPCB0Lmxlbmd0aDsgbysrKSB7XG4gICAgICB2YXIgYyA9IHRbb107XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShjKSkge1xuICAgICAgICB2YXIgbCxcbiAgICAgICAgICB1LFxuICAgICAgICAgIGYgPSBjWzFdLFxuICAgICAgICAgIHAgPSBjWzJdLFxuICAgICAgICAgIGQgPSBjLmxlbmd0aCA+IDMsXG4gICAgICAgICAgaCA9IGYgPj0gNTtcbiAgICAgICAgaWYgKGggPyAobCA9IGUsIDAgIT09IChmIC09IDUpICYmICh1ID0gbiA9IG4gfHwgW10pKSA6IChsID0gZS5wcm90b3R5cGUsIDAgIT09IGYgJiYgKHUgPSByID0gciB8fCBbXSkpLCAwICE9PSBmICYmICFkKSB7XG4gICAgICAgICAgdmFyIHYgPSBoID8gcyA6IGksXG4gICAgICAgICAgICBnID0gdi5nZXQocCkgfHwgMDtcbiAgICAgICAgICBpZiAoITAgPT09IGcgfHwgMyA9PT0gZyAmJiA0ICE9PSBmIHx8IDQgPT09IGcgJiYgMyAhPT0gZikgdGhyb3cgbmV3IEVycm9yKFwiQXR0ZW1wdGVkIHRvIGRlY29yYXRlIGEgcHVibGljIG1ldGhvZC9hY2Nlc3NvciB0aGF0IGhhcyB0aGUgc2FtZSBuYW1lIGFzIGEgcHJldmlvdXNseSBkZWNvcmF0ZWQgcHVibGljIG1ldGhvZC9hY2Nlc3Nvci4gVGhpcyBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBieSB0aGUgZGVjb3JhdG9ycyBwbHVnaW4uIFByb3BlcnR5IG5hbWUgd2FzOiBcIiArIHApO1xuICAgICAgICAgICFnICYmIGYgPiAyID8gdi5zZXQocCwgZikgOiB2LnNldChwLCAhMCk7XG4gICAgICAgIH1cbiAgICAgICAgYXBwbHlNZW1iZXJEZWMoYSwgbCwgYywgcCwgZiwgaCwgZCwgdSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwdXNoSW5pdGlhbGl6ZXJzKGEsIHIpLCBwdXNoSW5pdGlhbGl6ZXJzKGEsIG4pLCBhO1xuICB9XG4gIGZ1bmN0aW9uIHB1c2hJbml0aWFsaXplcnMoZSwgdCkge1xuICAgIHQgJiYgZS5wdXNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICBmb3IgKHZhciByID0gMDsgciA8IHQubGVuZ3RoOyByKyspIHRbcl0uY2FsbChlKTtcbiAgICAgIHJldHVybiBlO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBmdW5jdGlvbiAoZSwgdCwgcikge1xuICAgIHJldHVybiB7XG4gICAgICBlOiBhcHBseU1lbWJlckRlY3MoZSwgdCksXG4gICAgICBnZXQgYygpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgICAgaWYgKHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZm9yICh2YXIgciA9IFtdLCBuID0gZSwgYSA9IGUubmFtZSwgaSA9IHQubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgdmFyIHMgPSB7XG4gICAgICAgICAgICAgICAgdjogITFcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgbyA9IHRbaV0obiwge1xuICAgICAgICAgICAgICAgICAga2luZDogXCJjbGFzc1wiLFxuICAgICAgICAgICAgICAgICAgbmFtZTogYSxcbiAgICAgICAgICAgICAgICAgIGFkZEluaXRpYWxpemVyOiBjcmVhdGVBZGRJbml0aWFsaXplck1ldGhvZChyLCBzKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgIHMudiA9ICEwO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZvaWQgMCAhPT0gbyAmJiAoYXNzZXJ0VmFsaWRSZXR1cm5WYWx1ZSgxMCwgbyksIG4gPSBvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBbbiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IHIubGVuZ3RoOyBlKyspIHJbZV0uY2FsbChuKTtcbiAgICAgICAgICAgIH1dO1xuICAgICAgICAgIH1cbiAgICAgICAgfShlLCByKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xufVxuZnVuY3Rpb24gX2FwcGx5RGVjczIyMDNSKGUsIHQsIHIpIHtcbiAgcmV0dXJuIChfYXBwbHlEZWNzMjIwM1IgPSBhcHBseURlY3MyMjAzUkZhY3RvcnkoKSkoZSwgdCwgcik7XG59XG5mdW5jdGlvbiBhcHBseURlY3MyMzAxRmFjdG9yeSgpIHtcbiAgZnVuY3Rpb24gY3JlYXRlQWRkSW5pdGlhbGl6ZXJNZXRob2QoZSwgdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAocikge1xuICAgICAgIWZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgIGlmIChlLnYpIHRocm93IG5ldyBFcnJvcihcImF0dGVtcHRlZCB0byBjYWxsIFwiICsgdCArIFwiIGFmdGVyIGRlY29yYXRpb24gd2FzIGZpbmlzaGVkXCIpO1xuICAgICAgfSh0LCBcImFkZEluaXRpYWxpemVyXCIpLCBhc3NlcnRDYWxsYWJsZShyLCBcIkFuIGluaXRpYWxpemVyXCIpLCBlLnB1c2gocik7XG4gICAgfTtcbiAgfVxuICBmdW5jdGlvbiBhc3NlcnRJbnN0YW5jZUlmUHJpdmF0ZShlLCB0KSB7XG4gICAgaWYgKCFlKHQpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQXR0ZW1wdGVkIHRvIGFjY2VzcyBwcml2YXRlIGVsZW1lbnQgb24gbm9uLWluc3RhbmNlXCIpO1xuICB9XG4gIGZ1bmN0aW9uIG1lbWJlckRlYyhlLCB0LCByLCBuLCBhLCBpLCBzLCBvLCBjKSB7XG4gICAgdmFyIHU7XG4gICAgc3dpdGNoIChhKSB7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIHUgPSBcImFjY2Vzc29yXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyOlxuICAgICAgICB1ID0gXCJtZXRob2RcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDM6XG4gICAgICAgIHUgPSBcImdldHRlclwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgNDpcbiAgICAgICAgdSA9IFwic2V0dGVyXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdSA9IFwiZmllbGRcIjtcbiAgICB9XG4gICAgdmFyIGwsXG4gICAgICBmLFxuICAgICAgcCA9IHtcbiAgICAgICAga2luZDogdSxcbiAgICAgICAgbmFtZTogcyA/IFwiI1wiICsgdCA6IHQsXG4gICAgICAgIHN0YXRpYzogaSxcbiAgICAgICAgcHJpdmF0ZTogc1xuICAgICAgfSxcbiAgICAgIGQgPSB7XG4gICAgICAgIHY6ICExXG4gICAgICB9O1xuICAgIGlmICgwICE9PSBhICYmIChwLmFkZEluaXRpYWxpemVyID0gY3JlYXRlQWRkSW5pdGlhbGl6ZXJNZXRob2QobiwgZCkpLCBzIHx8IDAgIT09IGEgJiYgMiAhPT0gYSkge1xuICAgICAgaWYgKDIgPT09IGEpIGwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICByZXR1cm4gYXNzZXJ0SW5zdGFuY2VJZlByaXZhdGUoYywgZSksIHIudmFsdWU7XG4gICAgICB9O2Vsc2Uge1xuICAgICAgICB2YXIgaCA9IDAgPT09IGEgfHwgMSA9PT0gYTtcbiAgICAgICAgKGggfHwgMyA9PT0gYSkgJiYgKGwgPSBzID8gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICByZXR1cm4gYXNzZXJ0SW5zdGFuY2VJZlByaXZhdGUoYywgZSksIHIuZ2V0LmNhbGwoZSk7XG4gICAgICAgIH0gOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIHJldHVybiByLmdldC5jYWxsKGUpO1xuICAgICAgICB9KSwgKGggfHwgNCA9PT0gYSkgJiYgKGYgPSBzID8gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgICBhc3NlcnRJbnN0YW5jZUlmUHJpdmF0ZShjLCBlKSwgci5zZXQuY2FsbChlLCB0KTtcbiAgICAgICAgfSA6IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgICAgci5zZXQuY2FsbChlLCB0KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgcmV0dXJuIGVbdF07XG4gICAgfSwgMCA9PT0gYSAmJiAoZiA9IGZ1bmN0aW9uIChlLCByKSB7XG4gICAgICBlW3RdID0gcjtcbiAgICB9KTtcbiAgICB2YXIgdiA9IHMgPyBjLmJpbmQoKSA6IGZ1bmN0aW9uIChlKSB7XG4gICAgICByZXR1cm4gdCBpbiBlO1xuICAgIH07XG4gICAgcC5hY2Nlc3MgPSBsICYmIGYgPyB7XG4gICAgICBnZXQ6IGwsXG4gICAgICBzZXQ6IGYsXG4gICAgICBoYXM6IHZcbiAgICB9IDogbCA/IHtcbiAgICAgIGdldDogbCxcbiAgICAgIGhhczogdlxuICAgIH0gOiB7XG4gICAgICBzZXQ6IGYsXG4gICAgICBoYXM6IHZcbiAgICB9O1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gZShvLCBwKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgZC52ID0gITA7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGFzc2VydENhbGxhYmxlKGUsIHQpIHtcbiAgICBpZiAoXCJmdW5jdGlvblwiICE9IHR5cGVvZiBlKSB0aHJvdyBuZXcgVHlwZUVycm9yKHQgKyBcIiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gIH1cbiAgZnVuY3Rpb24gYXNzZXJ0VmFsaWRSZXR1cm5WYWx1ZShlLCB0KSB7XG4gICAgdmFyIHIgPSB0eXBlb2YgdDtcbiAgICBpZiAoMSA9PT0gZSkge1xuICAgICAgaWYgKFwib2JqZWN0XCIgIT09IHIgfHwgbnVsbCA9PT0gdCkgdGhyb3cgbmV3IFR5cGVFcnJvcihcImFjY2Vzc29yIGRlY29yYXRvcnMgbXVzdCByZXR1cm4gYW4gb2JqZWN0IHdpdGggZ2V0LCBzZXQsIG9yIGluaXQgcHJvcGVydGllcyBvciB2b2lkIDBcIik7XG4gICAgICB2b2lkIDAgIT09IHQuZ2V0ICYmIGFzc2VydENhbGxhYmxlKHQuZ2V0LCBcImFjY2Vzc29yLmdldFwiKSwgdm9pZCAwICE9PSB0LnNldCAmJiBhc3NlcnRDYWxsYWJsZSh0LnNldCwgXCJhY2Nlc3Nvci5zZXRcIiksIHZvaWQgMCAhPT0gdC5pbml0ICYmIGFzc2VydENhbGxhYmxlKHQuaW5pdCwgXCJhY2Nlc3Nvci5pbml0XCIpO1xuICAgIH0gZWxzZSBpZiAoXCJmdW5jdGlvblwiICE9PSByKSB7XG4gICAgICB2YXIgbjtcbiAgICAgIHRocm93IG4gPSAwID09PSBlID8gXCJmaWVsZFwiIDogMTAgPT09IGUgPyBcImNsYXNzXCIgOiBcIm1ldGhvZFwiLCBuZXcgVHlwZUVycm9yKG4gKyBcIiBkZWNvcmF0b3JzIG11c3QgcmV0dXJuIGEgZnVuY3Rpb24gb3Igdm9pZCAwXCIpO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBjdXJyeVRoaXMyKGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHQpIHtcbiAgICAgIGUodGhpcywgdCk7XG4gICAgfTtcbiAgfVxuICBmdW5jdGlvbiBhcHBseU1lbWJlckRlYyhlLCB0LCByLCBuLCBhLCBpLCBzLCBvLCBjKSB7XG4gICAgdmFyIHUsXG4gICAgICBsLFxuICAgICAgZixcbiAgICAgIHAsXG4gICAgICBkLFxuICAgICAgaCxcbiAgICAgIHYsXG4gICAgICBnID0gclswXTtcbiAgICBpZiAocyA/IHUgPSAwID09PSBhIHx8IDEgPT09IGEgPyB7XG4gICAgICBnZXQ6IChwID0gclszXSwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gcCh0aGlzKTtcbiAgICAgIH0pLFxuICAgICAgc2V0OiBjdXJyeVRoaXMyKHJbNF0pXG4gICAgfSA6IDMgPT09IGEgPyB7XG4gICAgICBnZXQ6IHJbM11cbiAgICB9IDogNCA9PT0gYSA/IHtcbiAgICAgIHNldDogclszXVxuICAgIH0gOiB7XG4gICAgICB2YWx1ZTogclszXVxuICAgIH0gOiAwICE9PSBhICYmICh1ID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LCBuKSksIDEgPT09IGEgPyBmID0ge1xuICAgICAgZ2V0OiB1LmdldCxcbiAgICAgIHNldDogdS5zZXRcbiAgICB9IDogMiA9PT0gYSA/IGYgPSB1LnZhbHVlIDogMyA9PT0gYSA/IGYgPSB1LmdldCA6IDQgPT09IGEgJiYgKGYgPSB1LnNldCksIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZykgdm9pZCAwICE9PSAoZCA9IG1lbWJlckRlYyhnLCBuLCB1LCBvLCBhLCBpLCBzLCBmLCBjKSkgJiYgKGFzc2VydFZhbGlkUmV0dXJuVmFsdWUoYSwgZCksIDAgPT09IGEgPyBsID0gZCA6IDEgPT09IGEgPyAobCA9IGQuaW5pdCwgaCA9IGQuZ2V0IHx8IGYuZ2V0LCB2ID0gZC5zZXQgfHwgZi5zZXQsIGYgPSB7XG4gICAgICBnZXQ6IGgsXG4gICAgICBzZXQ6IHZcbiAgICB9KSA6IGYgPSBkKTtlbHNlIGZvciAodmFyIHkgPSBnLmxlbmd0aCAtIDE7IHkgPj0gMDsgeS0tKSB7XG4gICAgICB2YXIgbTtcbiAgICAgIGlmICh2b2lkIDAgIT09IChkID0gbWVtYmVyRGVjKGdbeV0sIG4sIHUsIG8sIGEsIGksIHMsIGYsIGMpKSkgYXNzZXJ0VmFsaWRSZXR1cm5WYWx1ZShhLCBkKSwgMCA9PT0gYSA/IG0gPSBkIDogMSA9PT0gYSA/IChtID0gZC5pbml0LCBoID0gZC5nZXQgfHwgZi5nZXQsIHYgPSBkLnNldCB8fCBmLnNldCwgZiA9IHtcbiAgICAgICAgZ2V0OiBoLFxuICAgICAgICBzZXQ6IHZcbiAgICAgIH0pIDogZiA9IGQsIHZvaWQgMCAhPT0gbSAmJiAodm9pZCAwID09PSBsID8gbCA9IG0gOiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGwgPyBsID0gW2wsIG1dIDogbC5wdXNoKG0pKTtcbiAgICB9XG4gICAgaWYgKDAgPT09IGEgfHwgMSA9PT0gYSkge1xuICAgICAgaWYgKHZvaWQgMCA9PT0gbCkgbCA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgICAgIHJldHVybiB0O1xuICAgICAgfTtlbHNlIGlmIChcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIGwpIHtcbiAgICAgICAgdmFyIGIgPSBsO1xuICAgICAgICBsID0gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgICBmb3IgKHZhciByID0gdCwgbiA9IDA7IG4gPCBiLmxlbmd0aDsgbisrKSByID0gYltuXS5jYWxsKGUsIHIpO1xuICAgICAgICAgIHJldHVybiByO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIEkgPSBsO1xuICAgICAgICBsID0gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgICByZXR1cm4gSS5jYWxsKGUsIHQpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgZS5wdXNoKGwpO1xuICAgIH1cbiAgICAwICE9PSBhICYmICgxID09PSBhID8gKHUuZ2V0ID0gZi5nZXQsIHUuc2V0ID0gZi5zZXQpIDogMiA9PT0gYSA/IHUudmFsdWUgPSBmIDogMyA9PT0gYSA/IHUuZ2V0ID0gZiA6IDQgPT09IGEgJiYgKHUuc2V0ID0gZiksIHMgPyAxID09PSBhID8gKGUucHVzaChmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgcmV0dXJuIGYuZ2V0LmNhbGwoZSwgdCk7XG4gICAgfSksIGUucHVzaChmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgcmV0dXJuIGYuc2V0LmNhbGwoZSwgdCk7XG4gICAgfSkpIDogMiA9PT0gYSA/IGUucHVzaChmKSA6IGUucHVzaChmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgcmV0dXJuIGYuY2FsbChlLCB0KTtcbiAgICB9KSA6IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBuLCB1KSk7XG4gIH1cbiAgZnVuY3Rpb24gYXBwbHlNZW1iZXJEZWNzKGUsIHQsIHIpIHtcbiAgICBmb3IgKHZhciBuLCBhLCBpLCBzID0gW10sIG8gPSBuZXcgTWFwKCksIGMgPSBuZXcgTWFwKCksIHUgPSAwOyB1IDwgdC5sZW5ndGg7IHUrKykge1xuICAgICAgdmFyIGwgPSB0W3VdO1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkobCkpIHtcbiAgICAgICAgdmFyIGYsXG4gICAgICAgICAgcCxcbiAgICAgICAgICBkID0gbFsxXSxcbiAgICAgICAgICBoID0gbFsyXSxcbiAgICAgICAgICB2ID0gbC5sZW5ndGggPiAzLFxuICAgICAgICAgIGcgPSBkID49IDUsXG4gICAgICAgICAgeSA9IHI7XG4gICAgICAgIGlmIChnID8gKGYgPSBlLCAwICE9PSAoZCAtPSA1KSAmJiAocCA9IGEgPSBhIHx8IFtdKSwgdiAmJiAhaSAmJiAoaSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgcmV0dXJuIF9jaGVja0luUkhTKHQpID09PSBlO1xuICAgICAgICB9KSwgeSA9IGkpIDogKGYgPSBlLnByb3RvdHlwZSwgMCAhPT0gZCAmJiAocCA9IG4gPSBuIHx8IFtdKSksIDAgIT09IGQgJiYgIXYpIHtcbiAgICAgICAgICB2YXIgbSA9IGcgPyBjIDogbyxcbiAgICAgICAgICAgIGIgPSBtLmdldChoKSB8fCAwO1xuICAgICAgICAgIGlmICghMCA9PT0gYiB8fCAzID09PSBiICYmIDQgIT09IGQgfHwgNCA9PT0gYiAmJiAzICE9PSBkKSB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gZGVjb3JhdGUgYSBwdWJsaWMgbWV0aG9kL2FjY2Vzc29yIHRoYXQgaGFzIHRoZSBzYW1lIG5hbWUgYXMgYSBwcmV2aW91c2x5IGRlY29yYXRlZCBwdWJsaWMgbWV0aG9kL2FjY2Vzc29yLiBUaGlzIGlzIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVkIGJ5IHRoZSBkZWNvcmF0b3JzIHBsdWdpbi4gUHJvcGVydHkgbmFtZSB3YXM6IFwiICsgaCk7XG4gICAgICAgICAgIWIgJiYgZCA+IDIgPyBtLnNldChoLCBkKSA6IG0uc2V0KGgsICEwKTtcbiAgICAgICAgfVxuICAgICAgICBhcHBseU1lbWJlckRlYyhzLCBmLCBsLCBoLCBkLCBnLCB2LCBwLCB5KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHB1c2hJbml0aWFsaXplcnMocywgbiksIHB1c2hJbml0aWFsaXplcnMocywgYSksIHM7XG4gIH1cbiAgZnVuY3Rpb24gcHVzaEluaXRpYWxpemVycyhlLCB0KSB7XG4gICAgdCAmJiBlLnB1c2goZnVuY3Rpb24gKGUpIHtcbiAgICAgIGZvciAodmFyIHIgPSAwOyByIDwgdC5sZW5ndGg7IHIrKykgdFtyXS5jYWxsKGUpO1xuICAgICAgcmV0dXJuIGU7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIGZ1bmN0aW9uIChlLCB0LCByLCBuKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGU6IGFwcGx5TWVtYmVyRGVjcyhlLCB0LCBuKSxcbiAgICAgIGdldCBjKCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgICBpZiAodC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmb3IgKHZhciByID0gW10sIG4gPSBlLCBhID0gZS5uYW1lLCBpID0gdC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgICB2YXIgcyA9IHtcbiAgICAgICAgICAgICAgICB2OiAhMVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBvID0gdFtpXShuLCB7XG4gICAgICAgICAgICAgICAgICBraW5kOiBcImNsYXNzXCIsXG4gICAgICAgICAgICAgICAgICBuYW1lOiBhLFxuICAgICAgICAgICAgICAgICAgYWRkSW5pdGlhbGl6ZXI6IGNyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKHIsIHMpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgcy52ID0gITA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdm9pZCAwICE9PSBvICYmIChhc3NlcnRWYWxpZFJldHVyblZhbHVlKDEwLCBvKSwgbiA9IG8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFtuLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgci5sZW5ndGg7IGUrKykgcltlXS5jYWxsKG4pO1xuICAgICAgICAgICAgfV07XG4gICAgICAgICAgfVxuICAgICAgICB9KGUsIHIpO1xuICAgICAgfVxuICAgIH07XG4gIH07XG59XG5mdW5jdGlvbiBfYXBwbHlEZWNzMjMwMShlLCB0LCByLCBuKSB7XG4gIHJldHVybiAoX2FwcGx5RGVjczIzMDEgPSBhcHBseURlY3MyMzAxRmFjdG9yeSgpKShlLCB0LCByLCBuKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKGUsIHQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChyKSB7XG4gICAgYXNzZXJ0Tm90RmluaXNoZWQodCwgXCJhZGRJbml0aWFsaXplclwiKSwgYXNzZXJ0Q2FsbGFibGUociwgXCJBbiBpbml0aWFsaXplclwiKSwgZS5wdXNoKHIpO1xuICB9O1xufVxuZnVuY3Rpb24gYXNzZXJ0SW5zdGFuY2VJZlByaXZhdGUoZSwgdCkge1xuICBpZiAoIWUodCkpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBdHRlbXB0ZWQgdG8gYWNjZXNzIHByaXZhdGUgZWxlbWVudCBvbiBub24taW5zdGFuY2VcIik7XG59XG5mdW5jdGlvbiBtZW1iZXJEZWMoZSwgdCwgciwgbiwgYSwgaSwgcywgbywgYywgbCkge1xuICB2YXIgdTtcbiAgc3dpdGNoIChpKSB7XG4gICAgY2FzZSAxOlxuICAgICAgdSA9IFwiYWNjZXNzb3JcIjtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMjpcbiAgICAgIHUgPSBcIm1ldGhvZFwiO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAzOlxuICAgICAgdSA9IFwiZ2V0dGVyXCI7XG4gICAgICBicmVhaztcbiAgICBjYXNlIDQ6XG4gICAgICB1ID0gXCJzZXR0ZXJcIjtcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICB1ID0gXCJmaWVsZFwiO1xuICB9XG4gIHZhciBmLFxuICAgIGQsXG4gICAgcCA9IHtcbiAgICAgIGtpbmQ6IHUsXG4gICAgICBuYW1lOiBvID8gXCIjXCIgKyByIDogcixcbiAgICAgIHN0YXRpYzogcyxcbiAgICAgIHByaXZhdGU6IG9cbiAgICB9LFxuICAgIGggPSB7XG4gICAgICB2OiAhMVxuICAgIH07XG4gIGlmICgwICE9PSBpICYmIChwLmFkZEluaXRpYWxpemVyID0gY3JlYXRlQWRkSW5pdGlhbGl6ZXJNZXRob2QoYSwgaCkpLCBvIHx8IDAgIT09IGkgJiYgMiAhPT0gaSkge1xuICAgIGlmICgyID09PSBpKSBmID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHJldHVybiBhc3NlcnRJbnN0YW5jZUlmUHJpdmF0ZShsLCBlKSwgbi52YWx1ZTtcbiAgICB9O2Vsc2Uge1xuICAgICAgdmFyIHYgPSAwID09PSBpIHx8IDEgPT09IGk7XG4gICAgICAodiB8fCAzID09PSBpKSAmJiAoZiA9IG8gPyBmdW5jdGlvbiAoZSkge1xuICAgICAgICByZXR1cm4gYXNzZXJ0SW5zdGFuY2VJZlByaXZhdGUobCwgZSksIG4uZ2V0LmNhbGwoZSk7XG4gICAgICB9IDogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgcmV0dXJuIG4uZ2V0LmNhbGwoZSk7XG4gICAgICB9KSwgKHYgfHwgNCA9PT0gaSkgJiYgKGQgPSBvID8gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgYXNzZXJ0SW5zdGFuY2VJZlByaXZhdGUobCwgZSksIG4uc2V0LmNhbGwoZSwgdCk7XG4gICAgICB9IDogZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgbi5zZXQuY2FsbChlLCB0KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSBlbHNlIGYgPSBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBlW3JdO1xuICB9LCAwID09PSBpICYmIChkID0gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICBlW3JdID0gdDtcbiAgfSk7XG4gIHZhciB5ID0gbyA/IGwuYmluZCgpIDogZnVuY3Rpb24gKGUpIHtcbiAgICByZXR1cm4gciBpbiBlO1xuICB9O1xuICBwLmFjY2VzcyA9IGYgJiYgZCA/IHtcbiAgICBnZXQ6IGYsXG4gICAgc2V0OiBkLFxuICAgIGhhczogeVxuICB9IDogZiA/IHtcbiAgICBnZXQ6IGYsXG4gICAgaGFzOiB5XG4gIH0gOiB7XG4gICAgc2V0OiBkLFxuICAgIGhhczogeVxuICB9O1xuICB0cnkge1xuICAgIHJldHVybiBlLmNhbGwodCwgYywgcCk7XG4gIH0gZmluYWxseSB7XG4gICAgaC52ID0gITA7XG4gIH1cbn1cbmZ1bmN0aW9uIGFzc2VydE5vdEZpbmlzaGVkKGUsIHQpIHtcbiAgaWYgKGUudikgdGhyb3cgbmV3IEVycm9yKFwiYXR0ZW1wdGVkIHRvIGNhbGwgXCIgKyB0ICsgXCIgYWZ0ZXIgZGVjb3JhdGlvbiB3YXMgZmluaXNoZWRcIik7XG59XG5mdW5jdGlvbiBhc3NlcnRDYWxsYWJsZShlLCB0KSB7XG4gIGlmIChcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIGUpIHRocm93IG5ldyBUeXBlRXJyb3IodCArIFwiIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbn1cbmZ1bmN0aW9uIGFzc2VydFZhbGlkUmV0dXJuVmFsdWUoZSwgdCkge1xuICB2YXIgciA9IHR5cGVvZiB0O1xuICBpZiAoMSA9PT0gZSkge1xuICAgIGlmIChcIm9iamVjdFwiICE9PSByIHx8IG51bGwgPT09IHQpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhY2Nlc3NvciBkZWNvcmF0b3JzIG11c3QgcmV0dXJuIGFuIG9iamVjdCB3aXRoIGdldCwgc2V0LCBvciBpbml0IHByb3BlcnRpZXMgb3Igdm9pZCAwXCIpO1xuICAgIHZvaWQgMCAhPT0gdC5nZXQgJiYgYXNzZXJ0Q2FsbGFibGUodC5nZXQsIFwiYWNjZXNzb3IuZ2V0XCIpLCB2b2lkIDAgIT09IHQuc2V0ICYmIGFzc2VydENhbGxhYmxlKHQuc2V0LCBcImFjY2Vzc29yLnNldFwiKSwgdm9pZCAwICE9PSB0LmluaXQgJiYgYXNzZXJ0Q2FsbGFibGUodC5pbml0LCBcImFjY2Vzc29yLmluaXRcIik7XG4gIH0gZWxzZSBpZiAoXCJmdW5jdGlvblwiICE9PSByKSB7XG4gICAgdmFyIG47XG4gICAgdGhyb3cgbiA9IDAgPT09IGUgPyBcImZpZWxkXCIgOiA1ID09PSBlID8gXCJjbGFzc1wiIDogXCJtZXRob2RcIiwgbmV3IFR5cGVFcnJvcihuICsgXCIgZGVjb3JhdG9ycyBtdXN0IHJldHVybiBhIGZ1bmN0aW9uIG9yIHZvaWQgMFwiKTtcbiAgfVxufVxuZnVuY3Rpb24gY3VycnlUaGlzMShlKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGUodGhpcyk7XG4gIH07XG59XG5mdW5jdGlvbiBjdXJyeVRoaXMyKGUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0KSB7XG4gICAgZSh0aGlzLCB0KTtcbiAgfTtcbn1cbmZ1bmN0aW9uIGFwcGx5TWVtYmVyRGVjKGUsIHQsIHIsIG4sIGEsIGksIHMsIG8sIGMsIGwpIHtcbiAgdmFyIHUsXG4gICAgZixcbiAgICBkLFxuICAgIHAsXG4gICAgaCxcbiAgICB2LFxuICAgIHkgPSByWzBdO1xuICBuIHx8IEFycmF5LmlzQXJyYXkoeSkgfHwgKHkgPSBbeV0pLCBvID8gdSA9IDAgPT09IGkgfHwgMSA9PT0gaSA/IHtcbiAgICBnZXQ6IGN1cnJ5VGhpczEoclszXSksXG4gICAgc2V0OiBjdXJyeVRoaXMyKHJbNF0pXG4gIH0gOiAzID09PSBpID8ge1xuICAgIGdldDogclszXVxuICB9IDogNCA9PT0gaSA/IHtcbiAgICBzZXQ6IHJbM11cbiAgfSA6IHtcbiAgICB2YWx1ZTogclszXVxuICB9IDogMCAhPT0gaSAmJiAodSA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCwgYSkpLCAxID09PSBpID8gZCA9IHtcbiAgICBnZXQ6IHUuZ2V0LFxuICAgIHNldDogdS5zZXRcbiAgfSA6IDIgPT09IGkgPyBkID0gdS52YWx1ZSA6IDMgPT09IGkgPyBkID0gdS5nZXQgOiA0ID09PSBpICYmIChkID0gdS5zZXQpO1xuICBmb3IgKHZhciBnID0gbiA/IDIgOiAxLCBtID0geS5sZW5ndGggLSAxOyBtID49IDA7IG0gLT0gZykge1xuICAgIHZhciBiO1xuICAgIGlmICh2b2lkIDAgIT09IChwID0gbWVtYmVyRGVjKHlbbV0sIG4gPyB5W20gLSAxXSA6IHZvaWQgMCwgYSwgdSwgYywgaSwgcywgbywgZCwgbCkpKSBhc3NlcnRWYWxpZFJldHVyblZhbHVlKGksIHApLCAwID09PSBpID8gYiA9IHAgOiAxID09PSBpID8gKGIgPSBwLmluaXQsIGggPSBwLmdldCB8fCBkLmdldCwgdiA9IHAuc2V0IHx8IGQuc2V0LCBkID0ge1xuICAgICAgZ2V0OiBoLFxuICAgICAgc2V0OiB2XG4gICAgfSkgOiBkID0gcCwgdm9pZCAwICE9PSBiICYmICh2b2lkIDAgPT09IGYgPyBmID0gYiA6IFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZiA/IGYgPSBbZiwgYl0gOiBmLnB1c2goYikpO1xuICB9XG4gIGlmICgwID09PSBpIHx8IDEgPT09IGkpIHtcbiAgICBpZiAodm9pZCAwID09PSBmKSBmID0gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgIHJldHVybiB0O1xuICAgIH07ZWxzZSBpZiAoXCJmdW5jdGlvblwiICE9IHR5cGVvZiBmKSB7XG4gICAgICB2YXIgSSA9IGY7XG4gICAgICBmID0gZnVuY3Rpb24gKGUsIHQpIHtcbiAgICAgICAgZm9yICh2YXIgciA9IHQsIG4gPSBJLmxlbmd0aCAtIDE7IG4gPj0gMDsgbi0tKSByID0gSVtuXS5jYWxsKGUsIHIpO1xuICAgICAgICByZXR1cm4gcjtcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciB3ID0gZjtcbiAgICAgIGYgPSBmdW5jdGlvbiAoZSwgdCkge1xuICAgICAgICByZXR1cm4gdy5jYWxsKGUsIHQpO1xuICAgICAgfTtcbiAgICB9XG4gICAgZS5wdXNoKGYpO1xuICB9XG4gIDAgIT09IGkgJiYgKDEgPT09IGkgPyAodS5nZXQgPSBkLmdldCwgdS5zZXQgPSBkLnNldCkgOiAyID09PSBpID8gdS52YWx1ZSA9IGQgOiAzID09PSBpID8gdS5nZXQgPSBkIDogNCA9PT0gaSAmJiAodS5zZXQgPSBkKSwgbyA/IDEgPT09IGkgPyAoZS5wdXNoKGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgcmV0dXJuIGQuZ2V0LmNhbGwoZSwgdCk7XG4gIH0pLCBlLnB1c2goZnVuY3Rpb24gKGUsIHQpIHtcbiAgICByZXR1cm4gZC5zZXQuY2FsbChlLCB0KTtcbiAgfSkpIDogMiA9PT0gaSA/IGUucHVzaChkKSA6IGUucHVzaChmdW5jdGlvbiAoZSwgdCkge1xuICAgIHJldHVybiBkLmNhbGwoZSwgdCk7XG4gIH0pIDogT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIGEsIHUpKTtcbn1cbmZ1bmN0aW9uIGFwcGx5TWVtYmVyRGVjcyhlLCB0LCByKSB7XG4gIGZvciAodmFyIG4sIGEsIGksIHMgPSBbXSwgbyA9IG5ldyBNYXAoKSwgYyA9IG5ldyBNYXAoKSwgbCA9IDA7IGwgPCB0Lmxlbmd0aDsgbCsrKSB7XG4gICAgdmFyIHUgPSB0W2xdO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHUpKSB7XG4gICAgICB2YXIgZixcbiAgICAgICAgZCxcbiAgICAgICAgcCA9IHVbMV0sXG4gICAgICAgIGggPSB1WzJdLFxuICAgICAgICB2ID0gdS5sZW5ndGggPiAzLFxuICAgICAgICB5ID0gMTYgJiBwLFxuICAgICAgICBnID0gISEoOCAmIHApLFxuICAgICAgICBtID0gcjtcbiAgICAgIGlmIChwICY9IDcsIGcgPyAoZiA9IGUsIDAgIT09IHAgJiYgKGQgPSBhID0gYSB8fCBbXSksIHYgJiYgIWkgJiYgKGkgPSBmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gX2NoZWNrSW5SSFModCkgPT09IGU7XG4gICAgICB9KSwgbSA9IGkpIDogKGYgPSBlLnByb3RvdHlwZSwgMCAhPT0gcCAmJiAoZCA9IG4gPSBuIHx8IFtdKSksIDAgIT09IHAgJiYgIXYpIHtcbiAgICAgICAgdmFyIGIgPSBnID8gYyA6IG8sXG4gICAgICAgICAgSSA9IGIuZ2V0KGgpIHx8IDA7XG4gICAgICAgIGlmICghMCA9PT0gSSB8fCAzID09PSBJICYmIDQgIT09IHAgfHwgNCA9PT0gSSAmJiAzICE9PSBwKSB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gZGVjb3JhdGUgYSBwdWJsaWMgbWV0aG9kL2FjY2Vzc29yIHRoYXQgaGFzIHRoZSBzYW1lIG5hbWUgYXMgYSBwcmV2aW91c2x5IGRlY29yYXRlZCBwdWJsaWMgbWV0aG9kL2FjY2Vzc29yLiBUaGlzIGlzIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVkIGJ5IHRoZSBkZWNvcmF0b3JzIHBsdWdpbi4gUHJvcGVydHkgbmFtZSB3YXM6IFwiICsgaCk7XG4gICAgICAgIGIuc2V0KGgsICEoIUkgJiYgcCA+IDIpIHx8IHApO1xuICAgICAgfVxuICAgICAgYXBwbHlNZW1iZXJEZWMocywgZiwgdSwgeSwgaCwgcCwgZywgdiwgZCwgbSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBwdXNoSW5pdGlhbGl6ZXJzKHMsIG4pLCBwdXNoSW5pdGlhbGl6ZXJzKHMsIGEpLCBzO1xufVxuZnVuY3Rpb24gcHVzaEluaXRpYWxpemVycyhlLCB0KSB7XG4gIHQgJiYgZS5wdXNoKGZ1bmN0aW9uIChlKSB7XG4gICAgZm9yICh2YXIgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB0W3JdLmNhbGwoZSk7XG4gICAgcmV0dXJuIGU7XG4gIH0pO1xufVxuZnVuY3Rpb24gYXBwbHlDbGFzc0RlY3MoZSwgdCwgcikge1xuICBpZiAodC5sZW5ndGgpIHtcbiAgICBmb3IgKHZhciBuID0gW10sIGEgPSBlLCBpID0gZS5uYW1lLCBzID0gciA/IDIgOiAxLCBvID0gdC5sZW5ndGggLSAxOyBvID49IDA7IG8gLT0gcykge1xuICAgICAgdmFyIGMgPSB7XG4gICAgICAgIHY6ICExXG4gICAgICB9O1xuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIGwgPSB0W29dLmNhbGwociA/IHRbbyAtIDFdIDogdm9pZCAwLCBhLCB7XG4gICAgICAgICAga2luZDogXCJjbGFzc1wiLFxuICAgICAgICAgIG5hbWU6IGksXG4gICAgICAgICAgYWRkSW5pdGlhbGl6ZXI6IGNyZWF0ZUFkZEluaXRpYWxpemVyTWV0aG9kKG4sIGMpXG4gICAgICAgIH0pO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgYy52ID0gITA7XG4gICAgICB9XG4gICAgICB2b2lkIDAgIT09IGwgJiYgKGFzc2VydFZhbGlkUmV0dXJuVmFsdWUoNSwgbCksIGEgPSBsKTtcbiAgICB9XG4gICAgcmV0dXJuIFthLCBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciBlID0gMDsgZSA8IG4ubGVuZ3RoOyBlKyspIG5bZV0uY2FsbChhKTtcbiAgICB9XTtcbiAgfVxufVxuZnVuY3Rpb24gX2FwcGx5RGVjczIzMDUoZSwgdCwgciwgbiwgYSkge1xuICByZXR1cm4ge1xuICAgIGU6IGFwcGx5TWVtYmVyRGVjcyhlLCB0LCBhKSxcbiAgICBnZXQgYygpIHtcbiAgICAgIHJldHVybiBhcHBseUNsYXNzRGVjcyhlLCByLCBuKTtcbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiBfYXN5bmNHZW5lcmF0b3JEZWxlZ2F0ZSh0KSB7XG4gIHZhciBlID0ge30sXG4gICAgbiA9ICExO1xuICBmdW5jdGlvbiBwdW1wKGUsIHIpIHtcbiAgICByZXR1cm4gbiA9ICEwLCByID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKG4pIHtcbiAgICAgIG4odFtlXShyKSk7XG4gICAgfSksIHtcbiAgICAgIGRvbmU6ICExLFxuICAgICAgdmFsdWU6IG5ldyBfT3ZlcmxvYWRZaWVsZChyLCAxKVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIGVbXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgU3ltYm9sICYmIFN5bWJvbC5pdGVyYXRvciB8fCBcIkBAaXRlcmF0b3JcIl0gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sIGUubmV4dCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgcmV0dXJuIG4gPyAobiA9ICExLCB0KSA6IHB1bXAoXCJuZXh0XCIsIHQpO1xuICB9LCBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHQudGhyb3cgJiYgKGUudGhyb3cgPSBmdW5jdGlvbiAodCkge1xuICAgIGlmIChuKSB0aHJvdyBuID0gITEsIHQ7XG4gICAgcmV0dXJuIHB1bXAoXCJ0aHJvd1wiLCB0KTtcbiAgfSksIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgdC5yZXR1cm4gJiYgKGUucmV0dXJuID0gZnVuY3Rpb24gKHQpIHtcbiAgICByZXR1cm4gbiA/IChuID0gITEsIHQpIDogcHVtcChcInJldHVyblwiLCB0KTtcbiAgfSksIGU7XG59XG5mdW5jdGlvbiBfYXN5bmNJdGVyYXRvcihyKSB7XG4gIHZhciBuLFxuICAgIHQsXG4gICAgbyxcbiAgICBlID0gMjtcbiAgZm9yIChcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBTeW1ib2wgJiYgKHQgPSBTeW1ib2wuYXN5bmNJdGVyYXRvciwgbyA9IFN5bWJvbC5pdGVyYXRvcik7IGUtLTspIHtcbiAgICBpZiAodCAmJiBudWxsICE9IChuID0gclt0XSkpIHJldHVybiBuLmNhbGwocik7XG4gICAgaWYgKG8gJiYgbnVsbCAhPSAobiA9IHJbb10pKSByZXR1cm4gbmV3IEFzeW5jRnJvbVN5bmNJdGVyYXRvcihuLmNhbGwocikpO1xuICAgIHQgPSBcIkBAYXN5bmNJdGVyYXRvclwiLCBvID0gXCJAQGl0ZXJhdG9yXCI7XG4gIH1cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIk9iamVjdCBpcyBub3QgYXN5bmMgaXRlcmFibGVcIik7XG59XG5mdW5jdGlvbiBBc3luY0Zyb21TeW5jSXRlcmF0b3Iocikge1xuICBmdW5jdGlvbiBBc3luY0Zyb21TeW5jSXRlcmF0b3JDb250aW51YXRpb24ocikge1xuICAgIGlmIChPYmplY3QocikgIT09IHIpIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgVHlwZUVycm9yKHIgKyBcIiBpcyBub3QgYW4gb2JqZWN0LlwiKSk7XG4gICAgdmFyIG4gPSByLmRvbmU7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyLnZhbHVlKS50aGVuKGZ1bmN0aW9uIChyKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogcixcbiAgICAgICAgZG9uZTogblxuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gQXN5bmNGcm9tU3luY0l0ZXJhdG9yID0gZnVuY3Rpb24gKHIpIHtcbiAgICB0aGlzLnMgPSByLCB0aGlzLm4gPSByLm5leHQ7XG4gIH0sIEFzeW5jRnJvbVN5bmNJdGVyYXRvci5wcm90b3R5cGUgPSB7XG4gICAgczogbnVsbCxcbiAgICBuOiBudWxsLFxuICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBBc3luY0Zyb21TeW5jSXRlcmF0b3JDb250aW51YXRpb24odGhpcy5uLmFwcGx5KHRoaXMucywgYXJndW1lbnRzKSk7XG4gICAgfSxcbiAgICByZXR1cm46IGZ1bmN0aW9uIChyKSB7XG4gICAgICB2YXIgbiA9IHRoaXMucy5yZXR1cm47XG4gICAgICByZXR1cm4gdm9pZCAwID09PSBuID8gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgdmFsdWU6IHIsXG4gICAgICAgIGRvbmU6ICEwXG4gICAgICB9KSA6IEFzeW5jRnJvbVN5bmNJdGVyYXRvckNvbnRpbnVhdGlvbihuLmFwcGx5KHRoaXMucywgYXJndW1lbnRzKSk7XG4gICAgfSxcbiAgICB0aHJvdzogZnVuY3Rpb24gKHIpIHtcbiAgICAgIHZhciBuID0gdGhpcy5zLnJldHVybjtcbiAgICAgIHJldHVybiB2b2lkIDAgPT09IG4gPyBQcm9taXNlLnJlamVjdChyKSA6IEFzeW5jRnJvbVN5bmNJdGVyYXRvckNvbnRpbnVhdGlvbihuLmFwcGx5KHRoaXMucywgYXJndW1lbnRzKSk7XG4gICAgfVxuICB9LCBuZXcgQXN5bmNGcm9tU3luY0l0ZXJhdG9yKHIpO1xufVxuZnVuY3Rpb24gX2F3YWl0QXN5bmNHZW5lcmF0b3IoZSkge1xuICByZXR1cm4gbmV3IF9PdmVybG9hZFlpZWxkKGUsIDApO1xufVxuZnVuY3Rpb24gX2NoZWNrSW5SSFMoZSkge1xuICBpZiAoT2JqZWN0KGUpICE9PSBlKSB0aHJvdyBUeXBlRXJyb3IoXCJyaWdodC1oYW5kIHNpZGUgb2YgJ2luJyBzaG91bGQgYmUgYW4gb2JqZWN0LCBnb3QgXCIgKyAobnVsbCAhPT0gZSA/IHR5cGVvZiBlIDogXCJudWxsXCIpKTtcbiAgcmV0dXJuIGU7XG59XG5mdW5jdGlvbiBfZGVmaW5lQWNjZXNzb3IoZSwgciwgbiwgdCkge1xuICB2YXIgYyA9IHtcbiAgICBjb25maWd1cmFibGU6ICEwLFxuICAgIGVudW1lcmFibGU6ICEwXG4gIH07XG4gIHJldHVybiBjW2VdID0gdCwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHIsIG4sIGMpO1xufVxuZnVuY3Rpb24gZGlzcG9zZV9TdXBwcmVzc2VkRXJyb3IociwgZSkge1xuICByZXR1cm4gXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgU3VwcHJlc3NlZEVycm9yID8gZGlzcG9zZV9TdXBwcmVzc2VkRXJyb3IgPSBTdXBwcmVzc2VkRXJyb3IgOiAoZGlzcG9zZV9TdXBwcmVzc2VkRXJyb3IgPSBmdW5jdGlvbiAociwgZSkge1xuICAgIHRoaXMuc3VwcHJlc3NlZCA9IHIsIHRoaXMuZXJyb3IgPSBlLCB0aGlzLnN0YWNrID0gbmV3IEVycm9yKCkuc3RhY2s7XG4gIH0sIGRpc3Bvc2VfU3VwcHJlc3NlZEVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlLCB7XG4gICAgY29uc3RydWN0b3I6IHtcbiAgICAgIHZhbHVlOiBkaXNwb3NlX1N1cHByZXNzZWRFcnJvcixcbiAgICAgIHdyaXRhYmxlOiAhMCxcbiAgICAgIGNvbmZpZ3VyYWJsZTogITBcbiAgICB9XG4gIH0pKSwgbmV3IGRpc3Bvc2VfU3VwcHJlc3NlZEVycm9yKHIsIGUpO1xufVxuZnVuY3Rpb24gX2Rpc3Bvc2UociwgZSwgcykge1xuICBmdW5jdGlvbiBuZXh0KCkge1xuICAgIGZvciAoOyByLmxlbmd0aCA+IDA7KSB0cnkge1xuICAgICAgdmFyIG8gPSByLnBvcCgpLFxuICAgICAgICBwID0gby5kLmNhbGwoby52KTtcbiAgICAgIGlmIChvLmEpIHJldHVybiBQcm9taXNlLnJlc29sdmUocCkudGhlbihuZXh0LCBlcnIpO1xuICAgIH0gY2F0Y2ggKHIpIHtcbiAgICAgIHJldHVybiBlcnIocik7XG4gICAgfVxuICAgIGlmIChzKSB0aHJvdyBlO1xuICB9XG4gIGZ1bmN0aW9uIGVycihyKSB7XG4gICAgcmV0dXJuIGUgPSBzID8gbmV3IGRpc3Bvc2VfU3VwcHJlc3NlZEVycm9yKHIsIGUpIDogciwgcyA9ICEwLCBuZXh0KCk7XG4gIH1cbiAgcmV0dXJuIG5leHQoKTtcbn1cbmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXlMaW1pdChyLCBsKSB7XG4gIHZhciB0ID0gbnVsbCA9PSByID8gbnVsbCA6IFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIFN5bWJvbCAmJiByW1N5bWJvbC5pdGVyYXRvcl0gfHwgcltcIkBAaXRlcmF0b3JcIl07XG4gIGlmIChudWxsICE9IHQpIHtcbiAgICB2YXIgZSxcbiAgICAgIG4sXG4gICAgICBpLFxuICAgICAgdSxcbiAgICAgIGEgPSBbXSxcbiAgICAgIGYgPSAhMCxcbiAgICAgIG8gPSAhMTtcbiAgICB0cnkge1xuICAgICAgaWYgKGkgPSAodCA9IHQuY2FsbChyKSkubmV4dCwgMCA9PT0gbCkge1xuICAgICAgICBpZiAoT2JqZWN0KHQpICE9PSB0KSByZXR1cm47XG4gICAgICAgIGYgPSAhMTtcbiAgICAgIH0gZWxzZSBmb3IgKDsgIShmID0gKGUgPSBpLmNhbGwodCkpLmRvbmUpICYmIChhLnB1c2goZS52YWx1ZSksIGEubGVuZ3RoICE9PSBsKTsgZiA9ICEwKTtcbiAgICB9IGNhdGNoIChyKSB7XG4gICAgICBvID0gITAsIG4gPSByO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoIWYgJiYgbnVsbCAhPSB0LnJldHVybiAmJiAodSA9IHQucmV0dXJuKCksIE9iamVjdCh1KSAhPT0gdSkpIHJldHVybjtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGlmIChvKSB0aHJvdyBuO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYTtcbiAgfVxufVxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0TG9vc2UoZSwgcikge1xuICB2YXIgdCA9IGUgJiYgKFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIFN5bWJvbCAmJiBlW1N5bWJvbC5pdGVyYXRvcl0gfHwgZVtcIkBAaXRlcmF0b3JcIl0pO1xuICBpZiAobnVsbCAhPSB0KSB7XG4gICAgdmFyIG8sXG4gICAgICBsID0gW107XG4gICAgZm9yICh0ID0gdC5jYWxsKGUpOyBlLmxlbmd0aCA8IHIgJiYgIShvID0gdC5uZXh0KCkpLmRvbmU7KSBsLnB1c2goby52YWx1ZSk7XG4gICAgcmV0dXJuIGw7XG4gIH1cbn1cbnZhciBSRUFDVF9FTEVNRU5UX1RZUEU7XG5mdW5jdGlvbiBfanN4KGUsIHIsIEUsIGwpIHtcbiAgUkVBQ1RfRUxFTUVOVF9UWVBFIHx8IChSRUFDVF9FTEVNRU5UX1RZUEUgPSBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCAmJiBTeW1ib2wuZm9yICYmIFN5bWJvbC5mb3IoXCJyZWFjdC5lbGVtZW50XCIpIHx8IDYwMTAzKTtcbiAgdmFyIG8gPSBlICYmIGUuZGVmYXVsdFByb3BzLFxuICAgIG4gPSBhcmd1bWVudHMubGVuZ3RoIC0gMztcbiAgaWYgKHIgfHwgMCA9PT0gbiB8fCAociA9IHtcbiAgICBjaGlsZHJlbjogdm9pZCAwXG4gIH0pLCAxID09PSBuKSByLmNoaWxkcmVuID0gbDtlbHNlIGlmIChuID4gMSkge1xuICAgIGZvciAodmFyIHQgPSBuZXcgQXJyYXkobiksIGYgPSAwOyBmIDwgbjsgZisrKSB0W2ZdID0gYXJndW1lbnRzW2YgKyAzXTtcbiAgICByLmNoaWxkcmVuID0gdDtcbiAgfVxuICBpZiAociAmJiBvKSBmb3IgKHZhciBpIGluIG8pIHZvaWQgMCA9PT0gcltpXSAmJiAocltpXSA9IG9baV0pO2Vsc2UgciB8fCAociA9IG8gfHwge30pO1xuICByZXR1cm4ge1xuICAgICQkdHlwZW9mOiBSRUFDVF9FTEVNRU5UX1RZUEUsXG4gICAgdHlwZTogZSxcbiAgICBrZXk6IHZvaWQgMCA9PT0gRSA/IG51bGwgOiBcIlwiICsgRSxcbiAgICByZWY6IG51bGwsXG4gICAgcHJvcHM6IHIsXG4gICAgX293bmVyOiBudWxsXG4gIH07XG59XG5mdW5jdGlvbiBvd25LZXlzKGUsIHIpIHtcbiAgdmFyIHQgPSBPYmplY3Qua2V5cyhlKTtcbiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcbiAgICB2YXIgbyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7XG4gICAgciAmJiAobyA9IG8uZmlsdGVyKGZ1bmN0aW9uIChyKSB7XG4gICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLCByKS5lbnVtZXJhYmxlO1xuICAgIH0pKSwgdC5wdXNoLmFwcGx5KHQsIG8pO1xuICB9XG4gIHJldHVybiB0O1xufVxuZnVuY3Rpb24gX29iamVjdFNwcmVhZDIoZSkge1xuICBmb3IgKHZhciByID0gMTsgciA8IGFyZ3VtZW50cy5sZW5ndGg7IHIrKykge1xuICAgIHZhciB0ID0gbnVsbCAhPSBhcmd1bWVudHNbcl0gPyBhcmd1bWVudHNbcl0gOiB7fTtcbiAgICByICUgMiA/IG93bktleXMoT2JqZWN0KHQpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAocikge1xuICAgICAgX2RlZmluZVByb3BlcnR5KGUsIHIsIHRbcl0pO1xuICAgIH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyh0KSkgOiBvd25LZXlzKE9iamVjdCh0KSkuZm9yRWFjaChmdW5jdGlvbiAocikge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIHIsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCwgcikpO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBlO1xufVxuZnVuY3Rpb24gX3JlZ2VuZXJhdG9yUnVudGltZSgpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7IC8qISByZWdlbmVyYXRvci1ydW50aW1lIC0tIENvcHlyaWdodCAoYykgMjAxNC1wcmVzZW50LCBGYWNlYm9vaywgSW5jLiAtLSBsaWNlbnNlIChNSVQpOiBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVnZW5lcmF0b3IvYmxvYi9tYWluL0xJQ0VOU0UgKi9cbiAgX3JlZ2VuZXJhdG9yUnVudGltZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZTtcbiAgfTtcbiAgdmFyIHQsXG4gICAgZSA9IHt9LFxuICAgIHIgPSBPYmplY3QucHJvdG90eXBlLFxuICAgIG4gPSByLmhhc093blByb3BlcnR5LFxuICAgIG8gPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgfHwgZnVuY3Rpb24gKHQsIGUsIHIpIHtcbiAgICAgIHRbZV0gPSByLnZhbHVlO1xuICAgIH0sXG4gICAgaSA9IFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgU3ltYm9sID8gU3ltYm9sIDoge30sXG4gICAgYSA9IGkuaXRlcmF0b3IgfHwgXCJAQGl0ZXJhdG9yXCIsXG4gICAgYyA9IGkuYXN5bmNJdGVyYXRvciB8fCBcIkBAYXN5bmNJdGVyYXRvclwiLFxuICAgIHUgPSBpLnRvU3RyaW5nVGFnIHx8IFwiQEB0b1N0cmluZ1RhZ1wiO1xuICBmdW5jdGlvbiBkZWZpbmUodCwgZSwgcikge1xuICAgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgZSwge1xuICAgICAgdmFsdWU6IHIsXG4gICAgICBlbnVtZXJhYmxlOiAhMCxcbiAgICAgIGNvbmZpZ3VyYWJsZTogITAsXG4gICAgICB3cml0YWJsZTogITBcbiAgICB9KSwgdFtlXTtcbiAgfVxuICB0cnkge1xuICAgIGRlZmluZSh7fSwgXCJcIik7XG4gIH0gY2F0Y2ggKHQpIHtcbiAgICBkZWZpbmUgPSBmdW5jdGlvbiAodCwgZSwgcikge1xuICAgICAgcmV0dXJuIHRbZV0gPSByO1xuICAgIH07XG4gIH1cbiAgZnVuY3Rpb24gd3JhcCh0LCBlLCByLCBuKSB7XG4gICAgdmFyIGkgPSBlICYmIGUucHJvdG90eXBlIGluc3RhbmNlb2YgR2VuZXJhdG9yID8gZSA6IEdlbmVyYXRvcixcbiAgICAgIGEgPSBPYmplY3QuY3JlYXRlKGkucHJvdG90eXBlKSxcbiAgICAgIGMgPSBuZXcgQ29udGV4dChuIHx8IFtdKTtcbiAgICByZXR1cm4gbyhhLCBcIl9pbnZva2VcIiwge1xuICAgICAgdmFsdWU6IG1ha2VJbnZva2VNZXRob2QodCwgciwgYylcbiAgICB9KSwgYTtcbiAgfVxuICBmdW5jdGlvbiB0cnlDYXRjaCh0LCBlLCByKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IFwibm9ybWFsXCIsXG4gICAgICAgIGFyZzogdC5jYWxsKGUsIHIpXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IFwidGhyb3dcIixcbiAgICAgICAgYXJnOiB0XG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBlLndyYXAgPSB3cmFwO1xuICB2YXIgaCA9IFwic3VzcGVuZGVkU3RhcnRcIixcbiAgICBsID0gXCJzdXNwZW5kZWRZaWVsZFwiLFxuICAgIGYgPSBcImV4ZWN1dGluZ1wiLFxuICAgIHMgPSBcImNvbXBsZXRlZFwiLFxuICAgIHkgPSB7fTtcbiAgZnVuY3Rpb24gR2VuZXJhdG9yKCkge31cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb24oKSB7fVxuICBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSgpIHt9XG4gIHZhciBwID0ge307XG4gIGRlZmluZShwLCBhLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0pO1xuICB2YXIgZCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZixcbiAgICB2ID0gZCAmJiBkKGQodmFsdWVzKFtdKSkpO1xuICB2ICYmIHYgIT09IHIgJiYgbi5jYWxsKHYsIGEpICYmIChwID0gdik7XG4gIHZhciBnID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUucHJvdG90eXBlID0gR2VuZXJhdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUocCk7XG4gIGZ1bmN0aW9uIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyh0KSB7XG4gICAgW1wibmV4dFwiLCBcInRocm93XCIsIFwicmV0dXJuXCJdLmZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICAgIGRlZmluZSh0LCBlLCBmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW52b2tlKGUsIHQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gQXN5bmNJdGVyYXRvcih0LCBlKSB7XG4gICAgZnVuY3Rpb24gaW52b2tlKHIsIG8sIGksIGEpIHtcbiAgICAgIHZhciBjID0gdHJ5Q2F0Y2godFtyXSwgdCwgbyk7XG4gICAgICBpZiAoXCJ0aHJvd1wiICE9PSBjLnR5cGUpIHtcbiAgICAgICAgdmFyIHUgPSBjLmFyZyxcbiAgICAgICAgICBoID0gdS52YWx1ZTtcbiAgICAgICAgcmV0dXJuIGggJiYgXCJvYmplY3RcIiA9PSB0eXBlb2YgaCAmJiBuLmNhbGwoaCwgXCJfX2F3YWl0XCIpID8gZS5yZXNvbHZlKGguX19hd2FpdCkudGhlbihmdW5jdGlvbiAodCkge1xuICAgICAgICAgIGludm9rZShcIm5leHRcIiwgdCwgaSwgYSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgaW52b2tlKFwidGhyb3dcIiwgdCwgaSwgYSk7XG4gICAgICAgIH0pIDogZS5yZXNvbHZlKGgpLnRoZW4oZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICB1LnZhbHVlID0gdCwgaSh1KTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICByZXR1cm4gaW52b2tlKFwidGhyb3dcIiwgdCwgaSwgYSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgYShjLmFyZyk7XG4gICAgfVxuICAgIHZhciByO1xuICAgIG8odGhpcywgXCJfaW52b2tlXCIsIHtcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiAodCwgbikge1xuICAgICAgICBmdW5jdGlvbiBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZygpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IGUoZnVuY3Rpb24gKGUsIHIpIHtcbiAgICAgICAgICAgIGludm9rZSh0LCBuLCBlLCByKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gciA9IHIgPyByLnRoZW4oY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcsIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKSA6IGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gbWFrZUludm9rZU1ldGhvZChlLCByLCBuKSB7XG4gICAgdmFyIG8gPSBoO1xuICAgIHJldHVybiBmdW5jdGlvbiAoaSwgYSkge1xuICAgICAgaWYgKG8gPT09IGYpIHRocm93IG5ldyBFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IHJ1bm5pbmdcIik7XG4gICAgICBpZiAobyA9PT0gcykge1xuICAgICAgICBpZiAoXCJ0aHJvd1wiID09PSBpKSB0aHJvdyBhO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHZhbHVlOiB0LFxuICAgICAgICAgIGRvbmU6ICEwXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBmb3IgKG4ubWV0aG9kID0gaSwgbi5hcmcgPSBhOzspIHtcbiAgICAgICAgdmFyIGMgPSBuLmRlbGVnYXRlO1xuICAgICAgICBpZiAoYykge1xuICAgICAgICAgIHZhciB1ID0gbWF5YmVJbnZva2VEZWxlZ2F0ZShjLCBuKTtcbiAgICAgICAgICBpZiAodSkge1xuICAgICAgICAgICAgaWYgKHUgPT09IHkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgcmV0dXJuIHU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChcIm5leHRcIiA9PT0gbi5tZXRob2QpIG4uc2VudCA9IG4uX3NlbnQgPSBuLmFyZztlbHNlIGlmIChcInRocm93XCIgPT09IG4ubWV0aG9kKSB7XG4gICAgICAgICAgaWYgKG8gPT09IGgpIHRocm93IG8gPSBzLCBuLmFyZztcbiAgICAgICAgICBuLmRpc3BhdGNoRXhjZXB0aW9uKG4uYXJnKTtcbiAgICAgICAgfSBlbHNlIFwicmV0dXJuXCIgPT09IG4ubWV0aG9kICYmIG4uYWJydXB0KFwicmV0dXJuXCIsIG4uYXJnKTtcbiAgICAgICAgbyA9IGY7XG4gICAgICAgIHZhciBwID0gdHJ5Q2F0Y2goZSwgciwgbik7XG4gICAgICAgIGlmIChcIm5vcm1hbFwiID09PSBwLnR5cGUpIHtcbiAgICAgICAgICBpZiAobyA9IG4uZG9uZSA/IHMgOiBsLCBwLmFyZyA9PT0geSkgY29udGludWU7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiBwLmFyZyxcbiAgICAgICAgICAgIGRvbmU6IG4uZG9uZVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXCJ0aHJvd1wiID09PSBwLnR5cGUgJiYgKG8gPSBzLCBuLm1ldGhvZCA9IFwidGhyb3dcIiwgbi5hcmcgPSBwLmFyZyk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICBmdW5jdGlvbiBtYXliZUludm9rZURlbGVnYXRlKGUsIHIpIHtcbiAgICB2YXIgbiA9IHIubWV0aG9kLFxuICAgICAgbyA9IGUuaXRlcmF0b3Jbbl07XG4gICAgaWYgKG8gPT09IHQpIHJldHVybiByLmRlbGVnYXRlID0gbnVsbCwgXCJ0aHJvd1wiID09PSBuICYmIGUuaXRlcmF0b3IucmV0dXJuICYmIChyLm1ldGhvZCA9IFwicmV0dXJuXCIsIHIuYXJnID0gdCwgbWF5YmVJbnZva2VEZWxlZ2F0ZShlLCByKSwgXCJ0aHJvd1wiID09PSByLm1ldGhvZCkgfHwgXCJyZXR1cm5cIiAhPT0gbiAmJiAoci5tZXRob2QgPSBcInRocm93XCIsIHIuYXJnID0gbmV3IFR5cGVFcnJvcihcIlRoZSBpdGVyYXRvciBkb2VzIG5vdCBwcm92aWRlIGEgJ1wiICsgbiArIFwiJyBtZXRob2RcIikpLCB5O1xuICAgIHZhciBpID0gdHJ5Q2F0Y2gobywgZS5pdGVyYXRvciwgci5hcmcpO1xuICAgIGlmIChcInRocm93XCIgPT09IGkudHlwZSkgcmV0dXJuIHIubWV0aG9kID0gXCJ0aHJvd1wiLCByLmFyZyA9IGkuYXJnLCByLmRlbGVnYXRlID0gbnVsbCwgeTtcbiAgICB2YXIgYSA9IGkuYXJnO1xuICAgIHJldHVybiBhID8gYS5kb25lID8gKHJbZS5yZXN1bHROYW1lXSA9IGEudmFsdWUsIHIubmV4dCA9IGUubmV4dExvYywgXCJyZXR1cm5cIiAhPT0gci5tZXRob2QgJiYgKHIubWV0aG9kID0gXCJuZXh0XCIsIHIuYXJnID0gdCksIHIuZGVsZWdhdGUgPSBudWxsLCB5KSA6IGEgOiAoci5tZXRob2QgPSBcInRocm93XCIsIHIuYXJnID0gbmV3IFR5cGVFcnJvcihcIml0ZXJhdG9yIHJlc3VsdCBpcyBub3QgYW4gb2JqZWN0XCIpLCByLmRlbGVnYXRlID0gbnVsbCwgeSk7XG4gIH1cbiAgZnVuY3Rpb24gcHVzaFRyeUVudHJ5KHQpIHtcbiAgICB2YXIgZSA9IHtcbiAgICAgIHRyeUxvYzogdFswXVxuICAgIH07XG4gICAgMSBpbiB0ICYmIChlLmNhdGNoTG9jID0gdFsxXSksIDIgaW4gdCAmJiAoZS5maW5hbGx5TG9jID0gdFsyXSwgZS5hZnRlckxvYyA9IHRbM10pLCB0aGlzLnRyeUVudHJpZXMucHVzaChlKTtcbiAgfVxuICBmdW5jdGlvbiByZXNldFRyeUVudHJ5KHQpIHtcbiAgICB2YXIgZSA9IHQuY29tcGxldGlvbiB8fCB7fTtcbiAgICBlLnR5cGUgPSBcIm5vcm1hbFwiLCBkZWxldGUgZS5hcmcsIHQuY29tcGxldGlvbiA9IGU7XG4gIH1cbiAgZnVuY3Rpb24gQ29udGV4dCh0KSB7XG4gICAgdGhpcy50cnlFbnRyaWVzID0gW3tcbiAgICAgIHRyeUxvYzogXCJyb290XCJcbiAgICB9XSwgdC5mb3JFYWNoKHB1c2hUcnlFbnRyeSwgdGhpcyksIHRoaXMucmVzZXQoITApO1xuICB9XG4gIGZ1bmN0aW9uIHZhbHVlcyhlKSB7XG4gICAgaWYgKGUgfHwgXCJcIiA9PT0gZSkge1xuICAgICAgdmFyIHIgPSBlW2FdO1xuICAgICAgaWYgKHIpIHJldHVybiByLmNhbGwoZSk7XG4gICAgICBpZiAoXCJmdW5jdGlvblwiID09IHR5cGVvZiBlLm5leHQpIHJldHVybiBlO1xuICAgICAgaWYgKCFpc05hTihlLmxlbmd0aCkpIHtcbiAgICAgICAgdmFyIG8gPSAtMSxcbiAgICAgICAgICBpID0gZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgICAgICAgIGZvciAoOyArK28gPCBlLmxlbmd0aDspIGlmIChuLmNhbGwoZSwgbykpIHJldHVybiBuZXh0LnZhbHVlID0gZVtvXSwgbmV4dC5kb25lID0gITEsIG5leHQ7XG4gICAgICAgICAgICByZXR1cm4gbmV4dC52YWx1ZSA9IHQsIG5leHQuZG9uZSA9ICEwLCBuZXh0O1xuICAgICAgICAgIH07XG4gICAgICAgIHJldHVybiBpLm5leHQgPSBpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHR5cGVvZiBlICsgXCIgaXMgbm90IGl0ZXJhYmxlXCIpO1xuICB9XG4gIHJldHVybiBHZW5lcmF0b3JGdW5jdGlvbi5wcm90b3R5cGUgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgbyhnLCBcImNvbnN0cnVjdG9yXCIsIHtcbiAgICB2YWx1ZTogR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsXG4gICAgY29uZmlndXJhYmxlOiAhMFxuICB9KSwgbyhHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgXCJjb25zdHJ1Y3RvclwiLCB7XG4gICAgdmFsdWU6IEdlbmVyYXRvckZ1bmN0aW9uLFxuICAgIGNvbmZpZ3VyYWJsZTogITBcbiAgfSksIEdlbmVyYXRvckZ1bmN0aW9uLmRpc3BsYXlOYW1lID0gZGVmaW5lKEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLCB1LCBcIkdlbmVyYXRvckZ1bmN0aW9uXCIpLCBlLmlzR2VuZXJhdG9yRnVuY3Rpb24gPSBmdW5jdGlvbiAodCkge1xuICAgIHZhciBlID0gXCJmdW5jdGlvblwiID09IHR5cGVvZiB0ICYmIHQuY29uc3RydWN0b3I7XG4gICAgcmV0dXJuICEhZSAmJiAoZSA9PT0gR2VuZXJhdG9yRnVuY3Rpb24gfHwgXCJHZW5lcmF0b3JGdW5jdGlvblwiID09PSAoZS5kaXNwbGF5TmFtZSB8fCBlLm5hbWUpKTtcbiAgfSwgZS5tYXJrID0gZnVuY3Rpb24gKHQpIHtcbiAgICByZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHQsIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKSA6ICh0Ll9fcHJvdG9fXyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLCBkZWZpbmUodCwgdSwgXCJHZW5lcmF0b3JGdW5jdGlvblwiKSksIHQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShnKSwgdDtcbiAgfSwgZS5hd3JhcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIF9fYXdhaXQ6IHRcbiAgICB9O1xuICB9LCBkZWZpbmVJdGVyYXRvck1ldGhvZHMoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUpLCBkZWZpbmUoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUsIGMsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfSksIGUuQXN5bmNJdGVyYXRvciA9IEFzeW5jSXRlcmF0b3IsIGUuYXN5bmMgPSBmdW5jdGlvbiAodCwgciwgbiwgbywgaSkge1xuICAgIHZvaWQgMCA9PT0gaSAmJiAoaSA9IFByb21pc2UpO1xuICAgIHZhciBhID0gbmV3IEFzeW5jSXRlcmF0b3Iod3JhcCh0LCByLCBuLCBvKSwgaSk7XG4gICAgcmV0dXJuIGUuaXNHZW5lcmF0b3JGdW5jdGlvbihyKSA/IGEgOiBhLm5leHQoKS50aGVuKGZ1bmN0aW9uICh0KSB7XG4gICAgICByZXR1cm4gdC5kb25lID8gdC52YWx1ZSA6IGEubmV4dCgpO1xuICAgIH0pO1xuICB9LCBkZWZpbmVJdGVyYXRvck1ldGhvZHMoZyksIGRlZmluZShnLCB1LCBcIkdlbmVyYXRvclwiKSwgZGVmaW5lKGcsIGEsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfSksIGRlZmluZShnLCBcInRvU3RyaW5nXCIsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gXCJbb2JqZWN0IEdlbmVyYXRvcl1cIjtcbiAgfSksIGUua2V5cyA9IGZ1bmN0aW9uICh0KSB7XG4gICAgdmFyIGUgPSBPYmplY3QodCksXG4gICAgICByID0gW107XG4gICAgZm9yICh2YXIgbiBpbiBlKSByLnB1c2gobik7XG4gICAgcmV0dXJuIHIucmV2ZXJzZSgpLCBmdW5jdGlvbiBuZXh0KCkge1xuICAgICAgZm9yICg7IHIubGVuZ3RoOykge1xuICAgICAgICB2YXIgdCA9IHIucG9wKCk7XG4gICAgICAgIGlmICh0IGluIGUpIHJldHVybiBuZXh0LnZhbHVlID0gdCwgbmV4dC5kb25lID0gITEsIG5leHQ7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV4dC5kb25lID0gITAsIG5leHQ7XG4gICAgfTtcbiAgfSwgZS52YWx1ZXMgPSB2YWx1ZXMsIENvbnRleHQucHJvdG90eXBlID0ge1xuICAgIGNvbnN0cnVjdG9yOiBDb250ZXh0LFxuICAgIHJlc2V0OiBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKHRoaXMucHJldiA9IDAsIHRoaXMubmV4dCA9IDAsIHRoaXMuc2VudCA9IHRoaXMuX3NlbnQgPSB0LCB0aGlzLmRvbmUgPSAhMSwgdGhpcy5kZWxlZ2F0ZSA9IG51bGwsIHRoaXMubWV0aG9kID0gXCJuZXh0XCIsIHRoaXMuYXJnID0gdCwgdGhpcy50cnlFbnRyaWVzLmZvckVhY2gocmVzZXRUcnlFbnRyeSksICFlKSBmb3IgKHZhciByIGluIHRoaXMpIFwidFwiID09PSByLmNoYXJBdCgwKSAmJiBuLmNhbGwodGhpcywgcikgJiYgIWlzTmFOKCtyLnNsaWNlKDEpKSAmJiAodGhpc1tyXSA9IHQpO1xuICAgIH0sXG4gICAgc3RvcDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5kb25lID0gITA7XG4gICAgICB2YXIgdCA9IHRoaXMudHJ5RW50cmllc1swXS5jb21wbGV0aW9uO1xuICAgICAgaWYgKFwidGhyb3dcIiA9PT0gdC50eXBlKSB0aHJvdyB0LmFyZztcbiAgICAgIHJldHVybiB0aGlzLnJ2YWw7XG4gICAgfSxcbiAgICBkaXNwYXRjaEV4Y2VwdGlvbjogZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmICh0aGlzLmRvbmUpIHRocm93IGU7XG4gICAgICB2YXIgciA9IHRoaXM7XG4gICAgICBmdW5jdGlvbiBoYW5kbGUobiwgbykge1xuICAgICAgICByZXR1cm4gYS50eXBlID0gXCJ0aHJvd1wiLCBhLmFyZyA9IGUsIHIubmV4dCA9IG4sIG8gJiYgKHIubWV0aG9kID0gXCJuZXh0XCIsIHIuYXJnID0gdCksICEhbztcbiAgICAgIH1cbiAgICAgIGZvciAodmFyIG8gPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgbyA+PSAwOyAtLW8pIHtcbiAgICAgICAgdmFyIGkgPSB0aGlzLnRyeUVudHJpZXNbb10sXG4gICAgICAgICAgYSA9IGkuY29tcGxldGlvbjtcbiAgICAgICAgaWYgKFwicm9vdFwiID09PSBpLnRyeUxvYykgcmV0dXJuIGhhbmRsZShcImVuZFwiKTtcbiAgICAgICAgaWYgKGkudHJ5TG9jIDw9IHRoaXMucHJldikge1xuICAgICAgICAgIHZhciBjID0gbi5jYWxsKGksIFwiY2F0Y2hMb2NcIiksXG4gICAgICAgICAgICB1ID0gbi5jYWxsKGksIFwiZmluYWxseUxvY1wiKTtcbiAgICAgICAgICBpZiAoYyAmJiB1KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgaS5jYXRjaExvYykgcmV0dXJuIGhhbmRsZShpLmNhdGNoTG9jLCAhMCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgaS5maW5hbGx5TG9jKSByZXR1cm4gaGFuZGxlKGkuZmluYWxseUxvYyk7XG4gICAgICAgICAgfSBlbHNlIGlmIChjKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgaS5jYXRjaExvYykgcmV0dXJuIGhhbmRsZShpLmNhdGNoTG9jLCAhMCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICghdSkgdGhyb3cgbmV3IEVycm9yKFwidHJ5IHN0YXRlbWVudCB3aXRob3V0IGNhdGNoIG9yIGZpbmFsbHlcIik7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgaS5maW5hbGx5TG9jKSByZXR1cm4gaGFuZGxlKGkuZmluYWxseUxvYyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBhYnJ1cHQ6IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICBmb3IgKHZhciByID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IHIgPj0gMDsgLS1yKSB7XG4gICAgICAgIHZhciBvID0gdGhpcy50cnlFbnRyaWVzW3JdO1xuICAgICAgICBpZiAoby50cnlMb2MgPD0gdGhpcy5wcmV2ICYmIG4uY2FsbChvLCBcImZpbmFsbHlMb2NcIikgJiYgdGhpcy5wcmV2IDwgby5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgdmFyIGkgPSBvO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpICYmIChcImJyZWFrXCIgPT09IHQgfHwgXCJjb250aW51ZVwiID09PSB0KSAmJiBpLnRyeUxvYyA8PSBlICYmIGUgPD0gaS5maW5hbGx5TG9jICYmIChpID0gbnVsbCk7XG4gICAgICB2YXIgYSA9IGkgPyBpLmNvbXBsZXRpb24gOiB7fTtcbiAgICAgIHJldHVybiBhLnR5cGUgPSB0LCBhLmFyZyA9IGUsIGkgPyAodGhpcy5tZXRob2QgPSBcIm5leHRcIiwgdGhpcy5uZXh0ID0gaS5maW5hbGx5TG9jLCB5KSA6IHRoaXMuY29tcGxldGUoYSk7XG4gICAgfSxcbiAgICBjb21wbGV0ZTogZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgIGlmIChcInRocm93XCIgPT09IHQudHlwZSkgdGhyb3cgdC5hcmc7XG4gICAgICByZXR1cm4gXCJicmVha1wiID09PSB0LnR5cGUgfHwgXCJjb250aW51ZVwiID09PSB0LnR5cGUgPyB0aGlzLm5leHQgPSB0LmFyZyA6IFwicmV0dXJuXCIgPT09IHQudHlwZSA/ICh0aGlzLnJ2YWwgPSB0aGlzLmFyZyA9IHQuYXJnLCB0aGlzLm1ldGhvZCA9IFwicmV0dXJuXCIsIHRoaXMubmV4dCA9IFwiZW5kXCIpIDogXCJub3JtYWxcIiA9PT0gdC50eXBlICYmIGUgJiYgKHRoaXMubmV4dCA9IGUpLCB5O1xuICAgIH0sXG4gICAgZmluaXNoOiBmdW5jdGlvbiAodCkge1xuICAgICAgZm9yICh2YXIgZSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBlID49IDA7IC0tZSkge1xuICAgICAgICB2YXIgciA9IHRoaXMudHJ5RW50cmllc1tlXTtcbiAgICAgICAgaWYgKHIuZmluYWxseUxvYyA9PT0gdCkgcmV0dXJuIHRoaXMuY29tcGxldGUoci5jb21wbGV0aW9uLCByLmFmdGVyTG9jKSwgcmVzZXRUcnlFbnRyeShyKSwgeTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGNhdGNoOiBmdW5jdGlvbiAodCkge1xuICAgICAgZm9yICh2YXIgZSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBlID49IDA7IC0tZSkge1xuICAgICAgICB2YXIgciA9IHRoaXMudHJ5RW50cmllc1tlXTtcbiAgICAgICAgaWYgKHIudHJ5TG9jID09PSB0KSB7XG4gICAgICAgICAgdmFyIG4gPSByLmNvbXBsZXRpb247XG4gICAgICAgICAgaWYgKFwidGhyb3dcIiA9PT0gbi50eXBlKSB7XG4gICAgICAgICAgICB2YXIgbyA9IG4uYXJnO1xuICAgICAgICAgICAgcmVzZXRUcnlFbnRyeShyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG87XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBFcnJvcihcImlsbGVnYWwgY2F0Y2ggYXR0ZW1wdFwiKTtcbiAgICB9LFxuICAgIGRlbGVnYXRlWWllbGQ6IGZ1bmN0aW9uIChlLCByLCBuKSB7XG4gICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZSA9IHtcbiAgICAgICAgaXRlcmF0b3I6IHZhbHVlcyhlKSxcbiAgICAgICAgcmVzdWx0TmFtZTogcixcbiAgICAgICAgbmV4dExvYzogblxuICAgICAgfSwgXCJuZXh0XCIgPT09IHRoaXMubWV0aG9kICYmICh0aGlzLmFyZyA9IHQpLCB5O1xuICAgIH1cbiAgfSwgZTtcbn1cbmZ1bmN0aW9uIF90eXBlb2Yobykge1xuICBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7XG5cbiAgcmV0dXJuIF90eXBlb2YgPSBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCAmJiBcInN5bWJvbFwiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbiAobykge1xuICAgIHJldHVybiB0eXBlb2YgbztcbiAgfSA6IGZ1bmN0aW9uIChvKSB7XG4gICAgcmV0dXJuIG8gJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBTeW1ib2wgJiYgby5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG8gIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG87XG4gIH0sIF90eXBlb2Yobyk7XG59XG5mdW5jdGlvbiBfdXNpbmcobywgZSwgbikge1xuICBpZiAobnVsbCA9PSBlKSByZXR1cm4gZTtcbiAgaWYgKFwib2JqZWN0XCIgIT0gdHlwZW9mIGUpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJ1c2luZyBkZWNsYXJhdGlvbnMgY2FuIG9ubHkgYmUgdXNlZCB3aXRoIG9iamVjdHMsIG51bGwsIG9yIHVuZGVmaW5lZC5cIik7XG4gIGlmIChuKSB2YXIgciA9IGVbU3ltYm9sLmFzeW5jRGlzcG9zZSB8fCBTeW1ib2wuZm9yKFwiU3ltYm9sLmFzeW5jRGlzcG9zZVwiKV07XG4gIGlmIChudWxsID09IHIgJiYgKHIgPSBlW1N5bWJvbC5kaXNwb3NlIHx8IFN5bWJvbC5mb3IoXCJTeW1ib2wuZGlzcG9zZVwiKV0pLCBcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIHIpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcm9wZXJ0eSBbU3ltYm9sLmRpc3Bvc2VdIGlzIG5vdCBhIGZ1bmN0aW9uLlwiKTtcbiAgcmV0dXJuIG8ucHVzaCh7XG4gICAgdjogZSxcbiAgICBkOiByLFxuICAgIGE6IG5cbiAgfSksIGU7XG59XG5mdW5jdGlvbiBfd3JhcFJlZ0V4cCgpIHtcbiAgX3dyYXBSZWdFeHAgPSBmdW5jdGlvbiAoZSwgcikge1xuICAgIHJldHVybiBuZXcgQmFiZWxSZWdFeHAoZSwgdm9pZCAwLCByKTtcbiAgfTtcbiAgdmFyIGUgPSBSZWdFeHAucHJvdG90eXBlLFxuICAgIHIgPSBuZXcgV2Vha01hcCgpO1xuICBmdW5jdGlvbiBCYWJlbFJlZ0V4cChlLCB0LCBwKSB7XG4gICAgdmFyIG8gPSBuZXcgUmVnRXhwKGUsIHQpO1xuICAgIHJldHVybiByLnNldChvLCBwIHx8IHIuZ2V0KGUpKSwgX3NldFByb3RvdHlwZU9mKG8sIEJhYmVsUmVnRXhwLnByb3RvdHlwZSk7XG4gIH1cbiAgZnVuY3Rpb24gYnVpbGRHcm91cHMoZSwgdCkge1xuICAgIHZhciBwID0gci5nZXQodCk7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHApLnJlZHVjZShmdW5jdGlvbiAociwgdCkge1xuICAgICAgdmFyIG8gPSBwW3RdO1xuICAgICAgaWYgKFwibnVtYmVyXCIgPT0gdHlwZW9mIG8pIHJbdF0gPSBlW29dO2Vsc2Uge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgdm9pZCAwID09PSBlW29baV1dICYmIGkgKyAxIDwgby5sZW5ndGg7KSBpKys7XG4gICAgICAgIHJbdF0gPSBlW29baV1dO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHI7XG4gICAgfSwgT2JqZWN0LmNyZWF0ZShudWxsKSk7XG4gIH1cbiAgcmV0dXJuIF9pbmhlcml0cyhCYWJlbFJlZ0V4cCwgUmVnRXhwKSwgQmFiZWxSZWdFeHAucHJvdG90eXBlLmV4ZWMgPSBmdW5jdGlvbiAocikge1xuICAgIHZhciB0ID0gZS5leGVjLmNhbGwodGhpcywgcik7XG4gICAgaWYgKHQpIHtcbiAgICAgIHQuZ3JvdXBzID0gYnVpbGRHcm91cHModCwgdGhpcyk7XG4gICAgICB2YXIgcCA9IHQuaW5kaWNlcztcbiAgICAgIHAgJiYgKHAuZ3JvdXBzID0gYnVpbGRHcm91cHMocCwgdGhpcykpO1xuICAgIH1cbiAgICByZXR1cm4gdDtcbiAgfSwgQmFiZWxSZWdFeHAucHJvdG90eXBlW1N5bWJvbC5yZXBsYWNlXSA9IGZ1bmN0aW9uICh0LCBwKSB7XG4gICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHApIHtcbiAgICAgIHZhciBvID0gci5nZXQodGhpcyk7XG4gICAgICByZXR1cm4gZVtTeW1ib2wucmVwbGFjZV0uY2FsbCh0aGlzLCB0LCBwLnJlcGxhY2UoL1xcJDwoW14+XSspPi9nLCBmdW5jdGlvbiAoZSwgcikge1xuICAgICAgICB2YXIgdCA9IG9bcl07XG4gICAgICAgIHJldHVybiBcIiRcIiArIChBcnJheS5pc0FycmF5KHQpID8gdC5qb2luKFwiJFwiKSA6IHQpO1xuICAgICAgfSkpO1xuICAgIH1cbiAgICBpZiAoXCJmdW5jdGlvblwiID09IHR5cGVvZiBwKSB7XG4gICAgICB2YXIgaSA9IHRoaXM7XG4gICAgICByZXR1cm4gZVtTeW1ib2wucmVwbGFjZV0uY2FsbCh0aGlzLCB0LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlID0gYXJndW1lbnRzO1xuICAgICAgICByZXR1cm4gXCJvYmplY3RcIiAhPSB0eXBlb2YgZVtlLmxlbmd0aCAtIDFdICYmIChlID0gW10uc2xpY2UuY2FsbChlKSkucHVzaChidWlsZEdyb3VwcyhlLCBpKSksIHAuYXBwbHkodGhpcywgZSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGVbU3ltYm9sLnJlcGxhY2VdLmNhbGwodGhpcywgdCwgcCk7XG4gIH0sIF93cmFwUmVnRXhwLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBfQXdhaXRWYWx1ZSh2YWx1ZSkge1xuICB0aGlzLndyYXBwZWQgPSB2YWx1ZTtcbn1cbmZ1bmN0aW9uIF93cmFwQXN5bmNHZW5lcmF0b3IoZm4pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IF9Bc3luY0dlbmVyYXRvcihmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgfTtcbn1cbmZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHtcbiAgdHJ5IHtcbiAgICB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7XG4gICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZWplY3QoZXJyb3IpO1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoaW5mby5kb25lKSB7XG4gICAgcmVzb2x2ZSh2YWx1ZSk7XG4gIH0gZWxzZSB7XG4gICAgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKF9uZXh0LCBfdGhyb3cpO1xuICB9XG59XG5mdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikge1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcyxcbiAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTtcbiAgICAgIGZ1bmN0aW9uIF9uZXh0KHZhbHVlKSB7XG4gICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgXCJuZXh0XCIsIHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIF90aHJvdyhlcnIpIHtcbiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBcInRocm93XCIsIGVycik7XG4gICAgICB9XG4gICAgICBfbmV4dCh1bmRlZmluZWQpO1xuICAgIH0pO1xuICB9O1xufVxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3Rvcikge1xuICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7XG4gIH1cbn1cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07XG4gICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlO1xuICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTtcbiAgICBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIF90b1Byb3BlcnR5S2V5KGRlc2NyaXB0b3Iua2V5KSwgZGVzY3JpcHRvcik7XG4gIH1cbn1cbmZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHtcbiAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7XG4gIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnN0cnVjdG9yLCBcInByb3RvdHlwZVwiLCB7XG4gICAgd3JpdGFibGU6IGZhbHNlXG4gIH0pO1xuICByZXR1cm4gQ29uc3RydWN0b3I7XG59XG5mdW5jdGlvbiBfZGVmaW5lRW51bWVyYWJsZVByb3BlcnRpZXMob2JqLCBkZXNjcykge1xuICBmb3IgKHZhciBrZXkgaW4gZGVzY3MpIHtcbiAgICB2YXIgZGVzYyA9IGRlc2NzW2tleV07XG4gICAgZGVzYy5jb25maWd1cmFibGUgPSBkZXNjLmVudW1lcmFibGUgPSB0cnVlO1xuICAgIGlmIChcInZhbHVlXCIgaW4gZGVzYykgZGVzYy53cml0YWJsZSA9IHRydWU7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCBkZXNjKTtcbiAgfVxuICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykge1xuICAgIHZhciBvYmplY3RTeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhkZXNjcyk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvYmplY3RTeW1ib2xzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgc3ltID0gb2JqZWN0U3ltYm9sc1tpXTtcbiAgICAgIHZhciBkZXNjID0gZGVzY3Nbc3ltXTtcbiAgICAgIGRlc2MuY29uZmlndXJhYmxlID0gZGVzYy5lbnVtZXJhYmxlID0gdHJ1ZTtcbiAgICAgIGlmIChcInZhbHVlXCIgaW4gZGVzYykgZGVzYy53cml0YWJsZSA9IHRydWU7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBzeW0sIGRlc2MpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gb2JqO1xufVxuZnVuY3Rpb24gX2RlZmF1bHRzKG9iaiwgZGVmYXVsdHMpIHtcbiAgdmFyIGtleXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhkZWZhdWx0cyk7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBrZXkgPSBrZXlzW2ldO1xuICAgIHZhciB2YWx1ZSA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZGVmYXVsdHMsIGtleSk7XG4gICAgaWYgKHZhbHVlICYmIHZhbHVlLmNvbmZpZ3VyYWJsZSAmJiBvYmpba2V5XSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHtcbiAga2V5ID0gX3RvUHJvcGVydHlLZXkoa2V5KTtcbiAgaWYgKGtleSBpbiBvYmopIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIG9ialtrZXldID0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cbmZ1bmN0aW9uIF9leHRlbmRzKCkge1xuICBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gPyBPYmplY3QuYXNzaWduLmJpbmQoKSA6IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHtcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHtcbiAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG4gIH07XG4gIHJldHVybiBfZXh0ZW5kcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHtcbiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBPYmplY3QoYXJndW1lbnRzW2ldKSA6IHt9O1xuICAgIHZhciBvd25LZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTtcbiAgICBpZiAodHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIG93bktleXMucHVzaC5hcHBseShvd25LZXlzLCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHNvdXJjZSkuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBzeW0pLmVudW1lcmFibGU7XG4gICAgICB9KSk7XG4gICAgfVxuICAgIG93bktleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gdGFyZ2V0O1xufVxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7XG4gIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb25cIik7XG4gIH1cbiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7XG4gICAgY29uc3RydWN0b3I6IHtcbiAgICAgIHZhbHVlOiBzdWJDbGFzcyxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfVxuICB9KTtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHN1YkNsYXNzLCBcInByb3RvdHlwZVwiLCB7XG4gICAgd3JpdGFibGU6IGZhbHNlXG4gIH0pO1xuICBpZiAoc3VwZXJDbGFzcykgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTtcbn1cbmZ1bmN0aW9uIF9pbmhlcml0c0xvb3NlKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7XG4gIHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcy5wcm90b3R5cGUpO1xuICBzdWJDbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBzdWJDbGFzcztcbiAgX3NldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTtcbn1cbmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7XG4gIF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZi5iaW5kKCkgOiBmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2Yobykge1xuICAgIHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7XG4gIH07XG4gIHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7XG59XG5mdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkge1xuICBfc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHtcbiAgICBvLl9fcHJvdG9fXyA9IHA7XG4gICAgcmV0dXJuIG87XG4gIH07XG4gIHJldHVybiBfc2V0UHJvdG90eXBlT2YobywgcCk7XG59XG5mdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkge1xuICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwidW5kZWZpbmVkXCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7XG4gIGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7XG4gIGlmICh0eXBlb2YgUHJveHkgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIHRydWU7XG4gIHRyeSB7XG4gICAgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5mdW5jdGlvbiBfY29uc3RydWN0KFBhcmVudCwgYXJncywgQ2xhc3MpIHtcbiAgaWYgKF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSkge1xuICAgIF9jb25zdHJ1Y3QgPSBSZWZsZWN0LmNvbnN0cnVjdC5iaW5kKCk7XG4gIH0gZWxzZSB7XG4gICAgX2NvbnN0cnVjdCA9IGZ1bmN0aW9uIF9jb25zdHJ1Y3QoUGFyZW50LCBhcmdzLCBDbGFzcykge1xuICAgICAgdmFyIGEgPSBbbnVsbF07XG4gICAgICBhLnB1c2guYXBwbHkoYSwgYXJncyk7XG4gICAgICB2YXIgQ29uc3RydWN0b3IgPSBGdW5jdGlvbi5iaW5kLmFwcGx5KFBhcmVudCwgYSk7XG4gICAgICB2YXIgaW5zdGFuY2UgPSBuZXcgQ29uc3RydWN0b3IoKTtcbiAgICAgIGlmIChDbGFzcykgX3NldFByb3RvdHlwZU9mKGluc3RhbmNlLCBDbGFzcy5wcm90b3R5cGUpO1xuICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIF9jb25zdHJ1Y3QuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbn1cbmZ1bmN0aW9uIF9pc05hdGl2ZUZ1bmN0aW9uKGZuKSB7XG4gIHJldHVybiBGdW5jdGlvbi50b1N0cmluZy5jYWxsKGZuKS5pbmRleE9mKFwiW25hdGl2ZSBjb2RlXVwiKSAhPT0gLTE7XG59XG5mdW5jdGlvbiBfd3JhcE5hdGl2ZVN1cGVyKENsYXNzKSB7XG4gIHZhciBfY2FjaGUgPSB0eXBlb2YgTWFwID09PSBcImZ1bmN0aW9uXCIgPyBuZXcgTWFwKCkgOiB1bmRlZmluZWQ7XG4gIF93cmFwTmF0aXZlU3VwZXIgPSBmdW5jdGlvbiBfd3JhcE5hdGl2ZVN1cGVyKENsYXNzKSB7XG4gICAgaWYgKENsYXNzID09PSBudWxsIHx8ICFfaXNOYXRpdmVGdW5jdGlvbihDbGFzcykpIHJldHVybiBDbGFzcztcbiAgICBpZiAodHlwZW9mIENsYXNzICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBfY2FjaGUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGlmIChfY2FjaGUuaGFzKENsYXNzKSkgcmV0dXJuIF9jYWNoZS5nZXQoQ2xhc3MpO1xuICAgICAgX2NhY2hlLnNldChDbGFzcywgV3JhcHBlcik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIFdyYXBwZXIoKSB7XG4gICAgICByZXR1cm4gX2NvbnN0cnVjdChDbGFzcywgYXJndW1lbnRzLCBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3IpO1xuICAgIH1cbiAgICBXcmFwcGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQ2xhc3MucHJvdG90eXBlLCB7XG4gICAgICBjb25zdHJ1Y3Rvcjoge1xuICAgICAgICB2YWx1ZTogV3JhcHBlcixcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gX3NldFByb3RvdHlwZU9mKFdyYXBwZXIsIENsYXNzKTtcbiAgfTtcbiAgcmV0dXJuIF93cmFwTmF0aXZlU3VwZXIoQ2xhc3MpO1xufVxuZnVuY3Rpb24gX2luc3RhbmNlb2YobGVmdCwgcmlnaHQpIHtcbiAgaWYgKHJpZ2h0ICE9IG51bGwgJiYgdHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiByaWdodFtTeW1ib2wuaGFzSW5zdGFuY2VdKSB7XG4gICAgcmV0dXJuICEhcmlnaHRbU3ltYm9sLmhhc0luc3RhbmNlXShsZWZ0KTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbGVmdCBpbnN0YW5jZW9mIHJpZ2h0O1xuICB9XG59XG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikge1xuICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDoge1xuICAgIGRlZmF1bHQ6IG9ialxuICB9O1xufVxuZnVuY3Rpb24gX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlKG5vZGVJbnRlcm9wKSB7XG4gIGlmICh0eXBlb2YgV2Vha01hcCAhPT0gXCJmdW5jdGlvblwiKSByZXR1cm4gbnVsbDtcbiAgdmFyIGNhY2hlQmFiZWxJbnRlcm9wID0gbmV3IFdlYWtNYXAoKTtcbiAgdmFyIGNhY2hlTm9kZUludGVyb3AgPSBuZXcgV2Vha01hcCgpO1xuICByZXR1cm4gKF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSA9IGZ1bmN0aW9uIChub2RlSW50ZXJvcCkge1xuICAgIHJldHVybiBub2RlSW50ZXJvcCA/IGNhY2hlTm9kZUludGVyb3AgOiBjYWNoZUJhYmVsSW50ZXJvcDtcbiAgfSkobm9kZUludGVyb3ApO1xufVxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqLCBub2RlSW50ZXJvcCkge1xuICBpZiAoIW5vZGVJbnRlcm9wICYmIG9iaiAmJiBvYmouX19lc01vZHVsZSkge1xuICAgIHJldHVybiBvYmo7XG4gIH1cbiAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqICE9PSBcIm9iamVjdFwiICYmIHR5cGVvZiBvYmogIT09IFwiZnVuY3Rpb25cIikge1xuICAgIHJldHVybiB7XG4gICAgICBkZWZhdWx0OiBvYmpcbiAgICB9O1xuICB9XG4gIHZhciBjYWNoZSA9IF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZShub2RlSW50ZXJvcCk7XG4gIGlmIChjYWNoZSAmJiBjYWNoZS5oYXMob2JqKSkge1xuICAgIHJldHVybiBjYWNoZS5nZXQob2JqKTtcbiAgfVxuICB2YXIgbmV3T2JqID0ge307XG4gIHZhciBoYXNQcm9wZXJ0eURlc2NyaXB0b3IgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcbiAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgIGlmIChrZXkgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcbiAgICAgIHZhciBkZXNjID0gaGFzUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiBudWxsO1xuICAgICAgaWYgKGRlc2MgJiYgKGRlc2MuZ2V0IHx8IGRlc2Muc2V0KSkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqLCBrZXksIGRlc2MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgbmV3T2JqLmRlZmF1bHQgPSBvYmo7XG4gIGlmIChjYWNoZSkge1xuICAgIGNhY2hlLnNldChvYmosIG5ld09iaik7XG4gIH1cbiAgcmV0dXJuIG5ld09iajtcbn1cbmZ1bmN0aW9uIF9uZXdBcnJvd0NoZWNrKGlubmVyVGhpcywgYm91bmRUaGlzKSB7XG4gIGlmIChpbm5lclRoaXMgIT09IGJvdW5kVGhpcykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgaW5zdGFudGlhdGUgYW4gYXJyb3cgZnVuY3Rpb25cIik7XG4gIH1cbn1cbmZ1bmN0aW9uIF9vYmplY3REZXN0cnVjdHVyaW5nRW1wdHkob2JqKSB7XG4gIGlmIChvYmogPT0gbnVsbCkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBkZXN0cnVjdHVyZSBcIiArIG9iaik7XG59XG5mdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKSB7XG4gIGlmIChzb3VyY2UgPT0gbnVsbCkgcmV0dXJuIHt9O1xuICB2YXIgdGFyZ2V0ID0ge307XG4gIHZhciBzb3VyY2VLZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTtcbiAgdmFyIGtleSwgaTtcbiAgZm9yIChpID0gMDsgaSA8IHNvdXJjZUtleXMubGVuZ3RoOyBpKyspIHtcbiAgICBrZXkgPSBzb3VyY2VLZXlzW2ldO1xuICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7XG4gICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgfVxuICByZXR1cm4gdGFyZ2V0O1xufVxuZnVuY3Rpb24gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKHNvdXJjZSwgZXhjbHVkZWQpIHtcbiAgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307XG4gIHZhciB0YXJnZXQgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKTtcbiAgdmFyIGtleSwgaTtcbiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcbiAgICB2YXIgc291cmNlU3ltYm9sS2V5cyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoc291cmNlKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgc291cmNlU3ltYm9sS2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAga2V5ID0gc291cmNlU3ltYm9sS2V5c1tpXTtcbiAgICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7XG4gICAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChzb3VyY2UsIGtleSkpIGNvbnRpbnVlO1xuICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRhcmdldDtcbn1cbmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikge1xuICBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7XG4gICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpO1xuICB9XG4gIHJldHVybiBzZWxmO1xufVxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkge1xuICBpZiAoY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikpIHtcbiAgICByZXR1cm4gY2FsbDtcbiAgfSBlbHNlIGlmIChjYWxsICE9PSB2b2lkIDApIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRGVyaXZlZCBjb25zdHJ1Y3RvcnMgbWF5IG9ubHkgcmV0dXJuIG9iamVjdCBvciB1bmRlZmluZWRcIik7XG4gIH1cbiAgcmV0dXJuIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZik7XG59XG5mdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkge1xuICB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTtcbiAgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkge1xuICAgIHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSxcbiAgICAgIHJlc3VsdDtcbiAgICBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkge1xuICAgICAgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjtcbiAgICAgIHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpO1xuICB9O1xufVxuZnVuY3Rpb24gX3N1cGVyUHJvcEJhc2Uob2JqZWN0LCBwcm9wZXJ0eSkge1xuICB3aGlsZSAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KSkge1xuICAgIG9iamVjdCA9IF9nZXRQcm90b3R5cGVPZihvYmplY3QpO1xuICAgIGlmIChvYmplY3QgPT09IG51bGwpIGJyZWFrO1xuICB9XG4gIHJldHVybiBvYmplY3Q7XG59XG5mdW5jdGlvbiBfZ2V0KCkge1xuICBpZiAodHlwZW9mIFJlZmxlY3QgIT09IFwidW5kZWZpbmVkXCIgJiYgUmVmbGVjdC5nZXQpIHtcbiAgICBfZ2V0ID0gUmVmbGVjdC5nZXQuYmluZCgpO1xuICB9IGVsc2Uge1xuICAgIF9nZXQgPSBmdW5jdGlvbiBfZ2V0KHRhcmdldCwgcHJvcGVydHksIHJlY2VpdmVyKSB7XG4gICAgICB2YXIgYmFzZSA9IF9zdXBlclByb3BCYXNlKHRhcmdldCwgcHJvcGVydHkpO1xuICAgICAgaWYgKCFiYXNlKSByZXR1cm47XG4gICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYmFzZSwgcHJvcGVydHkpO1xuICAgICAgaWYgKGRlc2MuZ2V0KSB7XG4gICAgICAgIHJldHVybiBkZXNjLmdldC5jYWxsKGFyZ3VtZW50cy5sZW5ndGggPCAzID8gdGFyZ2V0IDogcmVjZWl2ZXIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRlc2MudmFsdWU7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gX2dldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuZnVuY3Rpb24gc2V0KHRhcmdldCwgcHJvcGVydHksIHZhbHVlLCByZWNlaXZlcikge1xuICBpZiAodHlwZW9mIFJlZmxlY3QgIT09IFwidW5kZWZpbmVkXCIgJiYgUmVmbGVjdC5zZXQpIHtcbiAgICBzZXQgPSBSZWZsZWN0LnNldDtcbiAgfSBlbHNlIHtcbiAgICBzZXQgPSBmdW5jdGlvbiBzZXQodGFyZ2V0LCBwcm9wZXJ0eSwgdmFsdWUsIHJlY2VpdmVyKSB7XG4gICAgICB2YXIgYmFzZSA9IF9zdXBlclByb3BCYXNlKHRhcmdldCwgcHJvcGVydHkpO1xuICAgICAgdmFyIGRlc2M7XG4gICAgICBpZiAoYmFzZSkge1xuICAgICAgICBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihiYXNlLCBwcm9wZXJ0eSk7XG4gICAgICAgIGlmIChkZXNjLnNldCkge1xuICAgICAgICAgIGRlc2Muc2V0LmNhbGwocmVjZWl2ZXIsIHZhbHVlKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmICghZGVzYy53cml0YWJsZSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocmVjZWl2ZXIsIHByb3BlcnR5KTtcbiAgICAgIGlmIChkZXNjKSB7XG4gICAgICAgIGlmICghZGVzYy53cml0YWJsZSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBkZXNjLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZWNlaXZlciwgcHJvcGVydHksIGRlc2MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2RlZmluZVByb3BlcnR5KHJlY2VpdmVyLCBwcm9wZXJ0eSwgdmFsdWUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gc2V0KHRhcmdldCwgcHJvcGVydHksIHZhbHVlLCByZWNlaXZlcik7XG59XG5mdW5jdGlvbiBfc2V0KHRhcmdldCwgcHJvcGVydHksIHZhbHVlLCByZWNlaXZlciwgaXNTdHJpY3QpIHtcbiAgdmFyIHMgPSBzZXQodGFyZ2V0LCBwcm9wZXJ0eSwgdmFsdWUsIHJlY2VpdmVyIHx8IHRhcmdldCk7XG4gIGlmICghcyAmJiBpc1N0cmljdCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2ZhaWxlZCB0byBzZXQgcHJvcGVydHknKTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsKHN0cmluZ3MsIHJhdykge1xuICBpZiAoIXJhdykge1xuICAgIHJhdyA9IHN0cmluZ3Muc2xpY2UoMCk7XG4gIH1cbiAgcmV0dXJuIE9iamVjdC5mcmVlemUoT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoc3RyaW5ncywge1xuICAgIHJhdzoge1xuICAgICAgdmFsdWU6IE9iamVjdC5mcmVlemUocmF3KVxuICAgIH1cbiAgfSkpO1xufVxuZnVuY3Rpb24gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKHN0cmluZ3MsIHJhdykge1xuICBpZiAoIXJhdykge1xuICAgIHJhdyA9IHN0cmluZ3Muc2xpY2UoMCk7XG4gIH1cbiAgc3RyaW5ncy5yYXcgPSByYXc7XG4gIHJldHVybiBzdHJpbmdzO1xufVxuZnVuY3Rpb24gX3JlYWRPbmx5RXJyb3IobmFtZSkge1xuICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiXFxcIlwiICsgbmFtZSArIFwiXFxcIiBpcyByZWFkLW9ubHlcIik7XG59XG5mdW5jdGlvbiBfd3JpdGVPbmx5RXJyb3IobmFtZSkge1xuICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiXFxcIlwiICsgbmFtZSArIFwiXFxcIiBpcyB3cml0ZS1vbmx5XCIpO1xufVxuZnVuY3Rpb24gX2NsYXNzTmFtZVREWkVycm9yKG5hbWUpIHtcbiAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwiQ2xhc3MgXFxcIlwiICsgbmFtZSArIFwiXFxcIiBjYW5ub3QgYmUgcmVmZXJlbmNlZCBpbiBjb21wdXRlZCBwcm9wZXJ0eSBrZXlzLlwiKTtcbn1cbmZ1bmN0aW9uIF90ZW1wb3JhbFVuZGVmaW5lZCgpIHt9XG5mdW5jdGlvbiBfdGR6KG5hbWUpIHtcbiAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKG5hbWUgKyBcIiBpcyBub3QgZGVmaW5lZCAtIHRlbXBvcmFsIGRlYWQgem9uZVwiKTtcbn1cbmZ1bmN0aW9uIF90ZW1wb3JhbFJlZih2YWwsIG5hbWUpIHtcbiAgcmV0dXJuIHZhbCA9PT0gX3RlbXBvcmFsVW5kZWZpbmVkID8gX3RkeihuYW1lKSA6IHZhbDtcbn1cbmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkge1xuICByZXR1cm4gX2FycmF5V2l0aEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpO1xufVxuZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXlMb29zZShhcnIsIGkpIHtcbiAgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdExvb3NlKGFyciwgaSkgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFyciwgaSkgfHwgX25vbkl0ZXJhYmxlUmVzdCgpO1xufVxuZnVuY3Rpb24gX3RvQXJyYXkoYXJyKSB7XG4gIHJldHVybiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlUmVzdCgpO1xufVxuZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikge1xuICByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpO1xufVxuZnVuY3Rpb24gX2FycmF5V2l0aG91dEhvbGVzKGFycikge1xuICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkoYXJyKTtcbn1cbmZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjtcbn1cbmZ1bmN0aW9uIF9tYXliZUFycmF5TGlrZShuZXh0LCBhcnIsIGkpIHtcbiAgaWYgKGFyciAmJiAhQXJyYXkuaXNBcnJheShhcnIpICYmIHR5cGVvZiBhcnIubGVuZ3RoID09PSBcIm51bWJlclwiKSB7XG4gICAgdmFyIGxlbiA9IGFyci5sZW5ndGg7XG4gICAgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFyciwgaSAhPT0gdm9pZCAwICYmIGkgPCBsZW4gPyBpIDogbGVuKTtcbiAgfVxuICByZXR1cm4gbmV4dChhcnIsIGkpO1xufVxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7XG4gIGlmICh0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGl0ZXJbU3ltYm9sLml0ZXJhdG9yXSAhPSBudWxsIHx8IGl0ZXJbXCJAQGl0ZXJhdG9yXCJdICE9IG51bGwpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpO1xufVxuZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikge1xuICBpZiAoIW8pIHJldHVybjtcbiAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTtcbiAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpO1xuICBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lO1xuICBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShvKTtcbiAgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pO1xufVxuZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHtcbiAgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7XG4gIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgYXJyMltpXSA9IGFycltpXTtcbiAgcmV0dXJuIGFycjI7XG59XG5mdW5jdGlvbiBfbm9uSXRlcmFibGVTcHJlYWQoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpO1xufVxuZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTtcbn1cbmZ1bmN0aW9uIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG8sIGFsbG93QXJyYXlMaWtlKSB7XG4gIHZhciBpdCA9IHR5cGVvZiBTeW1ib2wgIT09IFwidW5kZWZpbmVkXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdIHx8IG9bXCJAQGl0ZXJhdG9yXCJdO1xuICBpZiAoIWl0KSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkobykgfHwgKGl0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8pKSB8fCBhbGxvd0FycmF5TGlrZSAmJiBvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgaWYgKGl0KSBvID0gaXQ7XG4gICAgICB2YXIgaSA9IDA7XG4gICAgICB2YXIgRiA9IGZ1bmN0aW9uICgpIHt9O1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgczogRixcbiAgICAgICAgbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmIChpID49IG8ubGVuZ3RoKSByZXR1cm4ge1xuICAgICAgICAgICAgZG9uZTogdHJ1ZVxuICAgICAgICAgIH07XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRvbmU6IGZhbHNlLFxuICAgICAgICAgICAgdmFsdWU6IG9baSsrXVxuICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIGU6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgfSxcbiAgICAgICAgZjogRlxuICAgICAgfTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBpdGVyYXRlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpO1xuICB9XG4gIHZhciBub3JtYWxDb21wbGV0aW9uID0gdHJ1ZSxcbiAgICBkaWRFcnIgPSBmYWxzZSxcbiAgICBlcnI7XG4gIHJldHVybiB7XG4gICAgczogZnVuY3Rpb24gKCkge1xuICAgICAgaXQgPSBpdC5jYWxsKG8pO1xuICAgIH0sXG4gICAgbjogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHN0ZXAgPSBpdC5uZXh0KCk7XG4gICAgICBub3JtYWxDb21wbGV0aW9uID0gc3RlcC5kb25lO1xuICAgICAgcmV0dXJuIHN0ZXA7XG4gICAgfSxcbiAgICBlOiBmdW5jdGlvbiAoZSkge1xuICAgICAgZGlkRXJyID0gdHJ1ZTtcbiAgICAgIGVyciA9IGU7XG4gICAgfSxcbiAgICBmOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoIW5vcm1hbENvbXBsZXRpb24gJiYgaXQucmV0dXJuICE9IG51bGwpIGl0LnJldHVybigpO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKGRpZEVycikgdGhyb3cgZXJyO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cbmZ1bmN0aW9uIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyTG9vc2UobywgYWxsb3dBcnJheUxpa2UpIHtcbiAgdmFyIGl0ID0gdHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0gfHwgb1tcIkBAaXRlcmF0b3JcIl07XG4gIGlmIChpdCkgcmV0dXJuIChpdCA9IGl0LmNhbGwobykpLm5leHQuYmluZChpdCk7XG4gIGlmIChBcnJheS5pc0FycmF5KG8pIHx8IChpdCA9IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvKSkgfHwgYWxsb3dBcnJheUxpa2UgJiYgbyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHtcbiAgICBpZiAoaXQpIG8gPSBpdDtcbiAgICB2YXIgaSA9IDA7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChpID49IG8ubGVuZ3RoKSByZXR1cm4ge1xuICAgICAgICBkb25lOiB0cnVlXG4gICAgICB9O1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZG9uZTogZmFsc2UsXG4gICAgICAgIHZhbHVlOiBvW2krK11cbiAgICAgIH07XG4gICAgfTtcbiAgfVxuICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGl0ZXJhdGUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxcbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC5cIik7XG59XG5mdW5jdGlvbiBfc2tpcEZpcnN0R2VuZXJhdG9yTmV4dChmbikge1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpdCA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgaXQubmV4dCgpO1xuICAgIHJldHVybiBpdDtcbiAgfTtcbn1cbmZ1bmN0aW9uIF90b1ByaW1pdGl2ZShpbnB1dCwgaGludCkge1xuICBpZiAodHlwZW9mIGlucHV0ICE9PSBcIm9iamVjdFwiIHx8IGlucHV0ID09PSBudWxsKSByZXR1cm4gaW5wdXQ7XG4gIHZhciBwcmltID0gaW5wdXRbU3ltYm9sLnRvUHJpbWl0aXZlXTtcbiAgaWYgKHByaW0gIT09IHVuZGVmaW5lZCkge1xuICAgIHZhciByZXMgPSBwcmltLmNhbGwoaW5wdXQsIGhpbnQgfHwgXCJkZWZhdWx0XCIpO1xuICAgIGlmICh0eXBlb2YgcmVzICE9PSBcIm9iamVjdFwiKSByZXR1cm4gcmVzO1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLlwiKTtcbiAgfVxuICByZXR1cm4gKGhpbnQgPT09IFwic3RyaW5nXCIgPyBTdHJpbmcgOiBOdW1iZXIpKGlucHV0KTtcbn1cbmZ1bmN0aW9uIF90b1Byb3BlcnR5S2V5KGFyZykge1xuICB2YXIga2V5ID0gX3RvUHJpbWl0aXZlKGFyZywgXCJzdHJpbmdcIik7XG4gIHJldHVybiB0eXBlb2Yga2V5ID09PSBcInN5bWJvbFwiID8ga2V5IDogU3RyaW5nKGtleSk7XG59XG5mdW5jdGlvbiBfaW5pdGlhbGl6ZXJXYXJuaW5nSGVscGVyKGRlc2NyaXB0b3IsIGNvbnRleHQpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdEZWNvcmF0aW5nIGNsYXNzIHByb3BlcnR5IGZhaWxlZC4gUGxlYXNlIGVuc3VyZSB0aGF0ICcgKyAndHJhbnNmb3JtLWNsYXNzLXByb3BlcnRpZXMgaXMgZW5hYmxlZCBhbmQgcnVucyBhZnRlciB0aGUgZGVjb3JhdG9ycyB0cmFuc2Zvcm0uJyk7XG59XG5mdW5jdGlvbiBfaW5pdGlhbGl6ZXJEZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5LCBkZXNjcmlwdG9yLCBjb250ZXh0KSB7XG4gIGlmICghZGVzY3JpcHRvcikgcmV0dXJuO1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eSwge1xuICAgIGVudW1lcmFibGU6IGRlc2NyaXB0b3IuZW51bWVyYWJsZSxcbiAgICBjb25maWd1cmFibGU6IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlLFxuICAgIHdyaXRhYmxlOiBkZXNjcmlwdG9yLndyaXRhYmxlLFxuICAgIHZhbHVlOiBkZXNjcmlwdG9yLmluaXRpYWxpemVyID8gZGVzY3JpcHRvci5pbml0aWFsaXplci5jYWxsKGNvbnRleHQpIDogdm9pZCAwXG4gIH0pO1xufVxuZnVuY3Rpb24gX2FwcGx5RGVjb3JhdGVkRGVzY3JpcHRvcih0YXJnZXQsIHByb3BlcnR5LCBkZWNvcmF0b3JzLCBkZXNjcmlwdG9yLCBjb250ZXh0KSB7XG4gIHZhciBkZXNjID0ge307XG4gIE9iamVjdC5rZXlzKGRlc2NyaXB0b3IpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIGRlc2Nba2V5XSA9IGRlc2NyaXB0b3Jba2V5XTtcbiAgfSk7XG4gIGRlc2MuZW51bWVyYWJsZSA9ICEhZGVzYy5lbnVtZXJhYmxlO1xuICBkZXNjLmNvbmZpZ3VyYWJsZSA9ICEhZGVzYy5jb25maWd1cmFibGU7XG4gIGlmICgndmFsdWUnIGluIGRlc2MgfHwgZGVzYy5pbml0aWFsaXplcikge1xuICAgIGRlc2Mud3JpdGFibGUgPSB0cnVlO1xuICB9XG4gIGRlc2MgPSBkZWNvcmF0b3JzLnNsaWNlKCkucmV2ZXJzZSgpLnJlZHVjZShmdW5jdGlvbiAoZGVzYywgZGVjb3JhdG9yKSB7XG4gICAgcmV0dXJuIGRlY29yYXRvcih0YXJnZXQsIHByb3BlcnR5LCBkZXNjKSB8fCBkZXNjO1xuICB9LCBkZXNjKTtcbiAgaWYgKGNvbnRleHQgJiYgZGVzYy5pbml0aWFsaXplciAhPT0gdm9pZCAwKSB7XG4gICAgZGVzYy52YWx1ZSA9IGRlc2MuaW5pdGlhbGl6ZXIgPyBkZXNjLmluaXRpYWxpemVyLmNhbGwoY29udGV4dCkgOiB2b2lkIDA7XG4gICAgZGVzYy5pbml0aWFsaXplciA9IHVuZGVmaW5lZDtcbiAgfVxuICBpZiAoZGVzYy5pbml0aWFsaXplciA9PT0gdm9pZCAwKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgcHJvcGVydHksIGRlc2MpO1xuICAgIGRlc2MgPSBudWxsO1xuICB9XG4gIHJldHVybiBkZXNjO1xufVxudmFyIGlkID0gMDtcbmZ1bmN0aW9uIF9jbGFzc1ByaXZhdGVGaWVsZExvb3NlS2V5KG5hbWUpIHtcbiAgcmV0dXJuIFwiX19wcml2YXRlX1wiICsgaWQrKyArIFwiX1wiICsgbmFtZTtcbn1cbmZ1bmN0aW9uIF9jbGFzc1ByaXZhdGVGaWVsZExvb3NlQmFzZShyZWNlaXZlciwgcHJpdmF0ZUtleSkge1xuICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChyZWNlaXZlciwgcHJpdmF0ZUtleSkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYXR0ZW1wdGVkIHRvIHVzZSBwcml2YXRlIGZpZWxkIG9uIG5vbi1pbnN0YW5jZVwiKTtcbiAgfVxuICByZXR1cm4gcmVjZWl2ZXI7XG59XG5mdW5jdGlvbiBfY2xhc3NQcml2YXRlRmllbGRHZXQocmVjZWl2ZXIsIHByaXZhdGVNYXApIHtcbiAgdmFyIGRlc2NyaXB0b3IgPSBfY2xhc3NFeHRyYWN0RmllbGREZXNjcmlwdG9yKHJlY2VpdmVyLCBwcml2YXRlTWFwLCBcImdldFwiKTtcbiAgcmV0dXJuIF9jbGFzc0FwcGx5RGVzY3JpcHRvckdldChyZWNlaXZlciwgZGVzY3JpcHRvcik7XG59XG5mdW5jdGlvbiBfY2xhc3NQcml2YXRlRmllbGRTZXQocmVjZWl2ZXIsIHByaXZhdGVNYXAsIHZhbHVlKSB7XG4gIHZhciBkZXNjcmlwdG9yID0gX2NsYXNzRXh0cmFjdEZpZWxkRGVzY3JpcHRvcihyZWNlaXZlciwgcHJpdmF0ZU1hcCwgXCJzZXRcIik7XG4gIF9jbGFzc0FwcGx5RGVzY3JpcHRvclNldChyZWNlaXZlciwgZGVzY3JpcHRvciwgdmFsdWUpO1xuICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiBfY2xhc3NQcml2YXRlRmllbGREZXN0cnVjdHVyZVNldChyZWNlaXZlciwgcHJpdmF0ZU1hcCkge1xuICB2YXIgZGVzY3JpcHRvciA9IF9jbGFzc0V4dHJhY3RGaWVsZERlc2NyaXB0b3IocmVjZWl2ZXIsIHByaXZhdGVNYXAsIFwic2V0XCIpO1xuICByZXR1cm4gX2NsYXNzQXBwbHlEZXNjcmlwdG9yRGVzdHJ1Y3R1cmVTZXQocmVjZWl2ZXIsIGRlc2NyaXB0b3IpO1xufVxuZnVuY3Rpb24gX2NsYXNzRXh0cmFjdEZpZWxkRGVzY3JpcHRvcihyZWNlaXZlciwgcHJpdmF0ZU1hcCwgYWN0aW9uKSB7XG4gIGlmICghcHJpdmF0ZU1hcC5oYXMocmVjZWl2ZXIpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImF0dGVtcHRlZCB0byBcIiArIGFjdGlvbiArIFwiIHByaXZhdGUgZmllbGQgb24gbm9uLWluc3RhbmNlXCIpO1xuICB9XG4gIHJldHVybiBwcml2YXRlTWFwLmdldChyZWNlaXZlcik7XG59XG5mdW5jdGlvbiBfY2xhc3NTdGF0aWNQcml2YXRlRmllbGRTcGVjR2V0KHJlY2VpdmVyLCBjbGFzc0NvbnN0cnVjdG9yLCBkZXNjcmlwdG9yKSB7XG4gIF9jbGFzc0NoZWNrUHJpdmF0ZVN0YXRpY0FjY2VzcyhyZWNlaXZlciwgY2xhc3NDb25zdHJ1Y3Rvcik7XG4gIF9jbGFzc0NoZWNrUHJpdmF0ZVN0YXRpY0ZpZWxkRGVzY3JpcHRvcihkZXNjcmlwdG9yLCBcImdldFwiKTtcbiAgcmV0dXJuIF9jbGFzc0FwcGx5RGVzY3JpcHRvckdldChyZWNlaXZlciwgZGVzY3JpcHRvcik7XG59XG5mdW5jdGlvbiBfY2xhc3NTdGF0aWNQcml2YXRlRmllbGRTcGVjU2V0KHJlY2VpdmVyLCBjbGFzc0NvbnN0cnVjdG9yLCBkZXNjcmlwdG9yLCB2YWx1ZSkge1xuICBfY2xhc3NDaGVja1ByaXZhdGVTdGF0aWNBY2Nlc3MocmVjZWl2ZXIsIGNsYXNzQ29uc3RydWN0b3IpO1xuICBfY2xhc3NDaGVja1ByaXZhdGVTdGF0aWNGaWVsZERlc2NyaXB0b3IoZGVzY3JpcHRvciwgXCJzZXRcIik7XG4gIF9jbGFzc0FwcGx5RGVzY3JpcHRvclNldChyZWNlaXZlciwgZGVzY3JpcHRvciwgdmFsdWUpO1xuICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiBfY2xhc3NTdGF0aWNQcml2YXRlTWV0aG9kR2V0KHJlY2VpdmVyLCBjbGFzc0NvbnN0cnVjdG9yLCBtZXRob2QpIHtcbiAgX2NsYXNzQ2hlY2tQcml2YXRlU3RhdGljQWNjZXNzKHJlY2VpdmVyLCBjbGFzc0NvbnN0cnVjdG9yKTtcbiAgcmV0dXJuIG1ldGhvZDtcbn1cbmZ1bmN0aW9uIF9jbGFzc1N0YXRpY1ByaXZhdGVNZXRob2RTZXQoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhdHRlbXB0ZWQgdG8gc2V0IHJlYWQgb25seSBzdGF0aWMgcHJpdmF0ZSBmaWVsZFwiKTtcbn1cbmZ1bmN0aW9uIF9jbGFzc0FwcGx5RGVzY3JpcHRvckdldChyZWNlaXZlciwgZGVzY3JpcHRvcikge1xuICBpZiAoZGVzY3JpcHRvci5nZXQpIHtcbiAgICByZXR1cm4gZGVzY3JpcHRvci5nZXQuY2FsbChyZWNlaXZlcik7XG4gIH1cbiAgcmV0dXJuIGRlc2NyaXB0b3IudmFsdWU7XG59XG5mdW5jdGlvbiBfY2xhc3NBcHBseURlc2NyaXB0b3JTZXQocmVjZWl2ZXIsIGRlc2NyaXB0b3IsIHZhbHVlKSB7XG4gIGlmIChkZXNjcmlwdG9yLnNldCkge1xuICAgIGRlc2NyaXB0b3Iuc2V0LmNhbGwocmVjZWl2ZXIsIHZhbHVlKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAoIWRlc2NyaXB0b3Iud3JpdGFibGUpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhdHRlbXB0ZWQgdG8gc2V0IHJlYWQgb25seSBwcml2YXRlIGZpZWxkXCIpO1xuICAgIH1cbiAgICBkZXNjcmlwdG9yLnZhbHVlID0gdmFsdWU7XG4gIH1cbn1cbmZ1bmN0aW9uIF9jbGFzc0FwcGx5RGVzY3JpcHRvckRlc3RydWN0dXJlU2V0KHJlY2VpdmVyLCBkZXNjcmlwdG9yKSB7XG4gIGlmIChkZXNjcmlwdG9yLnNldCkge1xuICAgIGlmICghKFwiX19kZXN0ck9ialwiIGluIGRlc2NyaXB0b3IpKSB7XG4gICAgICBkZXNjcmlwdG9yLl9fZGVzdHJPYmogPSB7XG4gICAgICAgIHNldCB2YWx1ZSh2KSB7XG4gICAgICAgICAgZGVzY3JpcHRvci5zZXQuY2FsbChyZWNlaXZlciwgdik7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBkZXNjcmlwdG9yLl9fZGVzdHJPYmo7XG4gIH0gZWxzZSB7XG4gICAgaWYgKCFkZXNjcmlwdG9yLndyaXRhYmxlKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiYXR0ZW1wdGVkIHRvIHNldCByZWFkIG9ubHkgcHJpdmF0ZSBmaWVsZFwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGRlc2NyaXB0b3I7XG4gIH1cbn1cbmZ1bmN0aW9uIF9jbGFzc1N0YXRpY1ByaXZhdGVGaWVsZERlc3RydWN0dXJlU2V0KHJlY2VpdmVyLCBjbGFzc0NvbnN0cnVjdG9yLCBkZXNjcmlwdG9yKSB7XG4gIF9jbGFzc0NoZWNrUHJpdmF0ZVN0YXRpY0FjY2VzcyhyZWNlaXZlciwgY2xhc3NDb25zdHJ1Y3Rvcik7XG4gIF9jbGFzc0NoZWNrUHJpdmF0ZVN0YXRpY0ZpZWxkRGVzY3JpcHRvcihkZXNjcmlwdG9yLCBcInNldFwiKTtcbiAgcmV0dXJuIF9jbGFzc0FwcGx5RGVzY3JpcHRvckRlc3RydWN0dXJlU2V0KHJlY2VpdmVyLCBkZXNjcmlwdG9yKTtcbn1cbmZ1bmN0aW9uIF9jbGFzc0NoZWNrUHJpdmF0ZVN0YXRpY0FjY2VzcyhyZWNlaXZlciwgY2xhc3NDb25zdHJ1Y3Rvcikge1xuICBpZiAocmVjZWl2ZXIgIT09IGNsYXNzQ29uc3RydWN0b3IpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBzdGF0aWMgYWNjZXNzIG9mIHdyb25nIHByb3ZlbmFuY2VcIik7XG4gIH1cbn1cbmZ1bmN0aW9uIF9jbGFzc0NoZWNrUHJpdmF0ZVN0YXRpY0ZpZWxkRGVzY3JpcHRvcihkZXNjcmlwdG9yLCBhY3Rpb24pIHtcbiAgaWYgKGRlc2NyaXB0b3IgPT09IHVuZGVmaW5lZCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhdHRlbXB0ZWQgdG8gXCIgKyBhY3Rpb24gKyBcIiBwcml2YXRlIHN0YXRpYyBmaWVsZCBiZWZvcmUgaXRzIGRlY2xhcmF0aW9uXCIpO1xuICB9XG59XG5mdW5jdGlvbiBfZGVjb3JhdGUoZGVjb3JhdG9ycywgZmFjdG9yeSwgc3VwZXJDbGFzcywgbWl4aW5zKSB7XG4gIHZhciBhcGkgPSBfZ2V0RGVjb3JhdG9yc0FwaSgpO1xuICBpZiAobWl4aW5zKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtaXhpbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGFwaSA9IG1peGluc1tpXShhcGkpO1xuICAgIH1cbiAgfVxuICB2YXIgciA9IGZhY3RvcnkoZnVuY3Rpb24gaW5pdGlhbGl6ZShPKSB7XG4gICAgYXBpLmluaXRpYWxpemVJbnN0YW5jZUVsZW1lbnRzKE8sIGRlY29yYXRlZC5lbGVtZW50cyk7XG4gIH0sIHN1cGVyQ2xhc3MpO1xuICB2YXIgZGVjb3JhdGVkID0gYXBpLmRlY29yYXRlQ2xhc3MoX2NvYWxlc2NlQ2xhc3NFbGVtZW50cyhyLmQubWFwKF9jcmVhdGVFbGVtZW50RGVzY3JpcHRvcikpLCBkZWNvcmF0b3JzKTtcbiAgYXBpLmluaXRpYWxpemVDbGFzc0VsZW1lbnRzKHIuRiwgZGVjb3JhdGVkLmVsZW1lbnRzKTtcbiAgcmV0dXJuIGFwaS5ydW5DbGFzc0ZpbmlzaGVycyhyLkYsIGRlY29yYXRlZC5maW5pc2hlcnMpO1xufVxuZnVuY3Rpb24gX2dldERlY29yYXRvcnNBcGkoKSB7XG4gIF9nZXREZWNvcmF0b3JzQXBpID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBhcGk7XG4gIH07XG4gIHZhciBhcGkgPSB7XG4gICAgZWxlbWVudHNEZWZpbml0aW9uT3JkZXI6IFtbXCJtZXRob2RcIl0sIFtcImZpZWxkXCJdXSxcbiAgICBpbml0aWFsaXplSW5zdGFuY2VFbGVtZW50czogZnVuY3Rpb24gKE8sIGVsZW1lbnRzKSB7XG4gICAgICBbXCJtZXRob2RcIiwgXCJmaWVsZFwiXS5mb3JFYWNoKGZ1bmN0aW9uIChraW5kKSB7XG4gICAgICAgIGVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICBpZiAoZWxlbWVudC5raW5kID09PSBraW5kICYmIGVsZW1lbnQucGxhY2VtZW50ID09PSBcIm93blwiKSB7XG4gICAgICAgICAgICB0aGlzLmRlZmluZUNsYXNzRWxlbWVudChPLCBlbGVtZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMpO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcbiAgICBpbml0aWFsaXplQ2xhc3NFbGVtZW50czogZnVuY3Rpb24gKEYsIGVsZW1lbnRzKSB7XG4gICAgICB2YXIgcHJvdG8gPSBGLnByb3RvdHlwZTtcbiAgICAgIFtcIm1ldGhvZFwiLCBcImZpZWxkXCJdLmZvckVhY2goZnVuY3Rpb24gKGtpbmQpIHtcbiAgICAgICAgZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgIHZhciBwbGFjZW1lbnQgPSBlbGVtZW50LnBsYWNlbWVudDtcbiAgICAgICAgICBpZiAoZWxlbWVudC5raW5kID09PSBraW5kICYmIChwbGFjZW1lbnQgPT09IFwic3RhdGljXCIgfHwgcGxhY2VtZW50ID09PSBcInByb3RvdHlwZVwiKSkge1xuICAgICAgICAgICAgdmFyIHJlY2VpdmVyID0gcGxhY2VtZW50ID09PSBcInN0YXRpY1wiID8gRiA6IHByb3RvO1xuICAgICAgICAgICAgdGhpcy5kZWZpbmVDbGFzc0VsZW1lbnQocmVjZWl2ZXIsIGVsZW1lbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgdGhpcyk7XG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuICAgIGRlZmluZUNsYXNzRWxlbWVudDogZnVuY3Rpb24gKHJlY2VpdmVyLCBlbGVtZW50KSB7XG4gICAgICB2YXIgZGVzY3JpcHRvciA9IGVsZW1lbnQuZGVzY3JpcHRvcjtcbiAgICAgIGlmIChlbGVtZW50LmtpbmQgPT09IFwiZmllbGRcIikge1xuICAgICAgICB2YXIgaW5pdGlhbGl6ZXIgPSBlbGVtZW50LmluaXRpYWxpemVyO1xuICAgICAgICBkZXNjcmlwdG9yID0ge1xuICAgICAgICAgIGVudW1lcmFibGU6IGRlc2NyaXB0b3IuZW51bWVyYWJsZSxcbiAgICAgICAgICB3cml0YWJsZTogZGVzY3JpcHRvci53cml0YWJsZSxcbiAgICAgICAgICBjb25maWd1cmFibGU6IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlLFxuICAgICAgICAgIHZhbHVlOiBpbml0aWFsaXplciA9PT0gdm9pZCAwID8gdm9pZCAwIDogaW5pdGlhbGl6ZXIuY2FsbChyZWNlaXZlcilcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZWNlaXZlciwgZWxlbWVudC5rZXksIGRlc2NyaXB0b3IpO1xuICAgIH0sXG4gICAgZGVjb3JhdGVDbGFzczogZnVuY3Rpb24gKGVsZW1lbnRzLCBkZWNvcmF0b3JzKSB7XG4gICAgICB2YXIgbmV3RWxlbWVudHMgPSBbXTtcbiAgICAgIHZhciBmaW5pc2hlcnMgPSBbXTtcbiAgICAgIHZhciBwbGFjZW1lbnRzID0ge1xuICAgICAgICBzdGF0aWM6IFtdLFxuICAgICAgICBwcm90b3R5cGU6IFtdLFxuICAgICAgICBvd246IFtdXG4gICAgICB9O1xuICAgICAgZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICB0aGlzLmFkZEVsZW1lbnRQbGFjZW1lbnQoZWxlbWVudCwgcGxhY2VtZW50cyk7XG4gICAgICB9LCB0aGlzKTtcbiAgICAgIGVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKCFfaGFzRGVjb3JhdG9ycyhlbGVtZW50KSkgcmV0dXJuIG5ld0VsZW1lbnRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgIHZhciBlbGVtZW50RmluaXNoZXJzRXh0cmFzID0gdGhpcy5kZWNvcmF0ZUVsZW1lbnQoZWxlbWVudCwgcGxhY2VtZW50cyk7XG4gICAgICAgIG5ld0VsZW1lbnRzLnB1c2goZWxlbWVudEZpbmlzaGVyc0V4dHJhcy5lbGVtZW50KTtcbiAgICAgICAgbmV3RWxlbWVudHMucHVzaC5hcHBseShuZXdFbGVtZW50cywgZWxlbWVudEZpbmlzaGVyc0V4dHJhcy5leHRyYXMpO1xuICAgICAgICBmaW5pc2hlcnMucHVzaC5hcHBseShmaW5pc2hlcnMsIGVsZW1lbnRGaW5pc2hlcnNFeHRyYXMuZmluaXNoZXJzKTtcbiAgICAgIH0sIHRoaXMpO1xuICAgICAgaWYgKCFkZWNvcmF0b3JzKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZWxlbWVudHM6IG5ld0VsZW1lbnRzLFxuICAgICAgICAgIGZpbmlzaGVyczogZmluaXNoZXJzXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICB2YXIgcmVzdWx0ID0gdGhpcy5kZWNvcmF0ZUNvbnN0cnVjdG9yKG5ld0VsZW1lbnRzLCBkZWNvcmF0b3JzKTtcbiAgICAgIGZpbmlzaGVycy5wdXNoLmFwcGx5KGZpbmlzaGVycywgcmVzdWx0LmZpbmlzaGVycyk7XG4gICAgICByZXN1bHQuZmluaXNoZXJzID0gZmluaXNoZXJzO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuICAgIGFkZEVsZW1lbnRQbGFjZW1lbnQ6IGZ1bmN0aW9uIChlbGVtZW50LCBwbGFjZW1lbnRzLCBzaWxlbnQpIHtcbiAgICAgIHZhciBrZXlzID0gcGxhY2VtZW50c1tlbGVtZW50LnBsYWNlbWVudF07XG4gICAgICBpZiAoIXNpbGVudCAmJiBrZXlzLmluZGV4T2YoZWxlbWVudC5rZXkpICE9PSAtMSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRHVwbGljYXRlZCBlbGVtZW50IChcIiArIGVsZW1lbnQua2V5ICsgXCIpXCIpO1xuICAgICAgfVxuICAgICAga2V5cy5wdXNoKGVsZW1lbnQua2V5KTtcbiAgICB9LFxuICAgIGRlY29yYXRlRWxlbWVudDogZnVuY3Rpb24gKGVsZW1lbnQsIHBsYWNlbWVudHMpIHtcbiAgICAgIHZhciBleHRyYXMgPSBbXTtcbiAgICAgIHZhciBmaW5pc2hlcnMgPSBbXTtcbiAgICAgIGZvciAodmFyIGRlY29yYXRvcnMgPSBlbGVtZW50LmRlY29yYXRvcnMsIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIHZhciBrZXlzID0gcGxhY2VtZW50c1tlbGVtZW50LnBsYWNlbWVudF07XG4gICAgICAgIGtleXMuc3BsaWNlKGtleXMuaW5kZXhPZihlbGVtZW50LmtleSksIDEpO1xuICAgICAgICB2YXIgZWxlbWVudE9iamVjdCA9IHRoaXMuZnJvbUVsZW1lbnREZXNjcmlwdG9yKGVsZW1lbnQpO1xuICAgICAgICB2YXIgZWxlbWVudEZpbmlzaGVyRXh0cmFzID0gdGhpcy50b0VsZW1lbnRGaW5pc2hlckV4dHJhcygoMCwgZGVjb3JhdG9yc1tpXSkoZWxlbWVudE9iamVjdCkgfHwgZWxlbWVudE9iamVjdCk7XG4gICAgICAgIGVsZW1lbnQgPSBlbGVtZW50RmluaXNoZXJFeHRyYXMuZWxlbWVudDtcbiAgICAgICAgdGhpcy5hZGRFbGVtZW50UGxhY2VtZW50KGVsZW1lbnQsIHBsYWNlbWVudHMpO1xuICAgICAgICBpZiAoZWxlbWVudEZpbmlzaGVyRXh0cmFzLmZpbmlzaGVyKSB7XG4gICAgICAgICAgZmluaXNoZXJzLnB1c2goZWxlbWVudEZpbmlzaGVyRXh0cmFzLmZpbmlzaGVyKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3RXh0cmFzID0gZWxlbWVudEZpbmlzaGVyRXh0cmFzLmV4dHJhcztcbiAgICAgICAgaWYgKG5ld0V4dHJhcykge1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbmV3RXh0cmFzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICB0aGlzLmFkZEVsZW1lbnRQbGFjZW1lbnQobmV3RXh0cmFzW2pdLCBwbGFjZW1lbnRzKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZXh0cmFzLnB1c2guYXBwbHkoZXh0cmFzLCBuZXdFeHRyYXMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxuICAgICAgICBmaW5pc2hlcnM6IGZpbmlzaGVycyxcbiAgICAgICAgZXh0cmFzOiBleHRyYXNcbiAgICAgIH07XG4gICAgfSxcbiAgICBkZWNvcmF0ZUNvbnN0cnVjdG9yOiBmdW5jdGlvbiAoZWxlbWVudHMsIGRlY29yYXRvcnMpIHtcbiAgICAgIHZhciBmaW5pc2hlcnMgPSBbXTtcbiAgICAgIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIHZhciBvYmogPSB0aGlzLmZyb21DbGFzc0Rlc2NyaXB0b3IoZWxlbWVudHMpO1xuICAgICAgICB2YXIgZWxlbWVudHNBbmRGaW5pc2hlciA9IHRoaXMudG9DbGFzc0Rlc2NyaXB0b3IoKDAsIGRlY29yYXRvcnNbaV0pKG9iaikgfHwgb2JqKTtcbiAgICAgICAgaWYgKGVsZW1lbnRzQW5kRmluaXNoZXIuZmluaXNoZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGZpbmlzaGVycy5wdXNoKGVsZW1lbnRzQW5kRmluaXNoZXIuZmluaXNoZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlbGVtZW50c0FuZEZpbmlzaGVyLmVsZW1lbnRzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBlbGVtZW50cyA9IGVsZW1lbnRzQW5kRmluaXNoZXIuZWxlbWVudHM7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBlbGVtZW50cy5sZW5ndGggLSAxOyBqKyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSBqICsgMTsgayA8IGVsZW1lbnRzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgIGlmIChlbGVtZW50c1tqXS5rZXkgPT09IGVsZW1lbnRzW2tdLmtleSAmJiBlbGVtZW50c1tqXS5wbGFjZW1lbnQgPT09IGVsZW1lbnRzW2tdLnBsYWNlbWVudCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJEdXBsaWNhdGVkIGVsZW1lbnQgKFwiICsgZWxlbWVudHNbal0ua2V5ICsgXCIpXCIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBlbGVtZW50czogZWxlbWVudHMsXG4gICAgICAgIGZpbmlzaGVyczogZmluaXNoZXJzXG4gICAgICB9O1xuICAgIH0sXG4gICAgZnJvbUVsZW1lbnREZXNjcmlwdG9yOiBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAga2luZDogZWxlbWVudC5raW5kLFxuICAgICAgICBrZXk6IGVsZW1lbnQua2V5LFxuICAgICAgICBwbGFjZW1lbnQ6IGVsZW1lbnQucGxhY2VtZW50LFxuICAgICAgICBkZXNjcmlwdG9yOiBlbGVtZW50LmRlc2NyaXB0b3JcbiAgICAgIH07XG4gICAgICB2YXIgZGVzYyA9IHtcbiAgICAgICAgdmFsdWU6IFwiRGVzY3JpcHRvclwiLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH07XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBTeW1ib2wudG9TdHJpbmdUYWcsIGRlc2MpO1xuICAgICAgaWYgKGVsZW1lbnQua2luZCA9PT0gXCJmaWVsZFwiKSBvYmouaW5pdGlhbGl6ZXIgPSBlbGVtZW50LmluaXRpYWxpemVyO1xuICAgICAgcmV0dXJuIG9iajtcbiAgICB9LFxuICAgIHRvRWxlbWVudERlc2NyaXB0b3JzOiBmdW5jdGlvbiAoZWxlbWVudE9iamVjdHMpIHtcbiAgICAgIGlmIChlbGVtZW50T2JqZWN0cyA9PT0gdW5kZWZpbmVkKSByZXR1cm47XG4gICAgICByZXR1cm4gX3RvQXJyYXkoZWxlbWVudE9iamVjdHMpLm1hcChmdW5jdGlvbiAoZWxlbWVudE9iamVjdCkge1xuICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXMudG9FbGVtZW50RGVzY3JpcHRvcihlbGVtZW50T2JqZWN0KTtcbiAgICAgICAgdGhpcy5kaXNhbGxvd1Byb3BlcnR5KGVsZW1lbnRPYmplY3QsIFwiZmluaXNoZXJcIiwgXCJBbiBlbGVtZW50IGRlc2NyaXB0b3JcIik7XG4gICAgICAgIHRoaXMuZGlzYWxsb3dQcm9wZXJ0eShlbGVtZW50T2JqZWN0LCBcImV4dHJhc1wiLCBcIkFuIGVsZW1lbnQgZGVzY3JpcHRvclwiKTtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuICAgIHRvRWxlbWVudERlc2NyaXB0b3I6IGZ1bmN0aW9uIChlbGVtZW50T2JqZWN0KSB7XG4gICAgICB2YXIga2luZCA9IFN0cmluZyhlbGVtZW50T2JqZWN0LmtpbmQpO1xuICAgICAgaWYgKGtpbmQgIT09IFwibWV0aG9kXCIgJiYga2luZCAhPT0gXCJmaWVsZFwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FuIGVsZW1lbnQgZGVzY3JpcHRvclxcJ3MgLmtpbmQgcHJvcGVydHkgbXVzdCBiZSBlaXRoZXIgXCJtZXRob2RcIiBvcicgKyAnIFwiZmllbGRcIiwgYnV0IGEgZGVjb3JhdG9yIGNyZWF0ZWQgYW4gZWxlbWVudCBkZXNjcmlwdG9yIHdpdGgnICsgJyAua2luZCBcIicgKyBraW5kICsgJ1wiJyk7XG4gICAgICB9XG4gICAgICB2YXIga2V5ID0gX3RvUHJvcGVydHlLZXkoZWxlbWVudE9iamVjdC5rZXkpO1xuICAgICAgdmFyIHBsYWNlbWVudCA9IFN0cmluZyhlbGVtZW50T2JqZWN0LnBsYWNlbWVudCk7XG4gICAgICBpZiAocGxhY2VtZW50ICE9PSBcInN0YXRpY1wiICYmIHBsYWNlbWVudCAhPT0gXCJwcm90b3R5cGVcIiAmJiBwbGFjZW1lbnQgIT09IFwib3duXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQW4gZWxlbWVudCBkZXNjcmlwdG9yXFwncyAucGxhY2VtZW50IHByb3BlcnR5IG11c3QgYmUgb25lIG9mIFwic3RhdGljXCIsJyArICcgXCJwcm90b3R5cGVcIiBvciBcIm93blwiLCBidXQgYSBkZWNvcmF0b3IgY3JlYXRlZCBhbiBlbGVtZW50IGRlc2NyaXB0b3InICsgJyB3aXRoIC5wbGFjZW1lbnQgXCInICsgcGxhY2VtZW50ICsgJ1wiJyk7XG4gICAgICB9XG4gICAgICB2YXIgZGVzY3JpcHRvciA9IGVsZW1lbnRPYmplY3QuZGVzY3JpcHRvcjtcbiAgICAgIHRoaXMuZGlzYWxsb3dQcm9wZXJ0eShlbGVtZW50T2JqZWN0LCBcImVsZW1lbnRzXCIsIFwiQW4gZWxlbWVudCBkZXNjcmlwdG9yXCIpO1xuICAgICAgdmFyIGVsZW1lbnQgPSB7XG4gICAgICAgIGtpbmQ6IGtpbmQsXG4gICAgICAgIGtleToga2V5LFxuICAgICAgICBwbGFjZW1lbnQ6IHBsYWNlbWVudCxcbiAgICAgICAgZGVzY3JpcHRvcjogT2JqZWN0LmFzc2lnbih7fSwgZGVzY3JpcHRvcilcbiAgICAgIH07XG4gICAgICBpZiAoa2luZCAhPT0gXCJmaWVsZFwiKSB7XG4gICAgICAgIHRoaXMuZGlzYWxsb3dQcm9wZXJ0eShlbGVtZW50T2JqZWN0LCBcImluaXRpYWxpemVyXCIsIFwiQSBtZXRob2QgZGVzY3JpcHRvclwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZGlzYWxsb3dQcm9wZXJ0eShkZXNjcmlwdG9yLCBcImdldFwiLCBcIlRoZSBwcm9wZXJ0eSBkZXNjcmlwdG9yIG9mIGEgZmllbGQgZGVzY3JpcHRvclwiKTtcbiAgICAgICAgdGhpcy5kaXNhbGxvd1Byb3BlcnR5KGRlc2NyaXB0b3IsIFwic2V0XCIsIFwiVGhlIHByb3BlcnR5IGRlc2NyaXB0b3Igb2YgYSBmaWVsZCBkZXNjcmlwdG9yXCIpO1xuICAgICAgICB0aGlzLmRpc2FsbG93UHJvcGVydHkoZGVzY3JpcHRvciwgXCJ2YWx1ZVwiLCBcIlRoZSBwcm9wZXJ0eSBkZXNjcmlwdG9yIG9mIGEgZmllbGQgZGVzY3JpcHRvclwiKTtcbiAgICAgICAgZWxlbWVudC5pbml0aWFsaXplciA9IGVsZW1lbnRPYmplY3QuaW5pdGlhbGl6ZXI7XG4gICAgICB9XG4gICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9LFxuICAgIHRvRWxlbWVudEZpbmlzaGVyRXh0cmFzOiBmdW5jdGlvbiAoZWxlbWVudE9iamVjdCkge1xuICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLnRvRWxlbWVudERlc2NyaXB0b3IoZWxlbWVudE9iamVjdCk7XG4gICAgICB2YXIgZmluaXNoZXIgPSBfb3B0aW9uYWxDYWxsYWJsZVByb3BlcnR5KGVsZW1lbnRPYmplY3QsIFwiZmluaXNoZXJcIik7XG4gICAgICB2YXIgZXh0cmFzID0gdGhpcy50b0VsZW1lbnREZXNjcmlwdG9ycyhlbGVtZW50T2JqZWN0LmV4dHJhcyk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxuICAgICAgICBmaW5pc2hlcjogZmluaXNoZXIsXG4gICAgICAgIGV4dHJhczogZXh0cmFzXG4gICAgICB9O1xuICAgIH0sXG4gICAgZnJvbUNsYXNzRGVzY3JpcHRvcjogZnVuY3Rpb24gKGVsZW1lbnRzKSB7XG4gICAgICB2YXIgb2JqID0ge1xuICAgICAgICBraW5kOiBcImNsYXNzXCIsXG4gICAgICAgIGVsZW1lbnRzOiBlbGVtZW50cy5tYXAodGhpcy5mcm9tRWxlbWVudERlc2NyaXB0b3IsIHRoaXMpXG4gICAgICB9O1xuICAgICAgdmFyIGRlc2MgPSB7XG4gICAgICAgIHZhbHVlOiBcIkRlc2NyaXB0b3JcIixcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9O1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwgU3ltYm9sLnRvU3RyaW5nVGFnLCBkZXNjKTtcbiAgICAgIHJldHVybiBvYmo7XG4gICAgfSxcbiAgICB0b0NsYXNzRGVzY3JpcHRvcjogZnVuY3Rpb24gKG9iaikge1xuICAgICAgdmFyIGtpbmQgPSBTdHJpbmcob2JqLmtpbmQpO1xuICAgICAgaWYgKGtpbmQgIT09IFwiY2xhc3NcIikge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBIGNsYXNzIGRlc2NyaXB0b3JcXCdzIC5raW5kIHByb3BlcnR5IG11c3QgYmUgXCJjbGFzc1wiLCBidXQgYSBkZWNvcmF0b3InICsgJyBjcmVhdGVkIGEgY2xhc3MgZGVzY3JpcHRvciB3aXRoIC5raW5kIFwiJyArIGtpbmQgKyAnXCInKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZGlzYWxsb3dQcm9wZXJ0eShvYmosIFwia2V5XCIsIFwiQSBjbGFzcyBkZXNjcmlwdG9yXCIpO1xuICAgICAgdGhpcy5kaXNhbGxvd1Byb3BlcnR5KG9iaiwgXCJwbGFjZW1lbnRcIiwgXCJBIGNsYXNzIGRlc2NyaXB0b3JcIik7XG4gICAgICB0aGlzLmRpc2FsbG93UHJvcGVydHkob2JqLCBcImRlc2NyaXB0b3JcIiwgXCJBIGNsYXNzIGRlc2NyaXB0b3JcIik7XG4gICAgICB0aGlzLmRpc2FsbG93UHJvcGVydHkob2JqLCBcImluaXRpYWxpemVyXCIsIFwiQSBjbGFzcyBkZXNjcmlwdG9yXCIpO1xuICAgICAgdGhpcy5kaXNhbGxvd1Byb3BlcnR5KG9iaiwgXCJleHRyYXNcIiwgXCJBIGNsYXNzIGRlc2NyaXB0b3JcIik7XG4gICAgICB2YXIgZmluaXNoZXIgPSBfb3B0aW9uYWxDYWxsYWJsZVByb3BlcnR5KG9iaiwgXCJmaW5pc2hlclwiKTtcbiAgICAgIHZhciBlbGVtZW50cyA9IHRoaXMudG9FbGVtZW50RGVzY3JpcHRvcnMob2JqLmVsZW1lbnRzKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGVsZW1lbnRzOiBlbGVtZW50cyxcbiAgICAgICAgZmluaXNoZXI6IGZpbmlzaGVyXG4gICAgICB9O1xuICAgIH0sXG4gICAgcnVuQ2xhc3NGaW5pc2hlcnM6IGZ1bmN0aW9uIChjb25zdHJ1Y3RvciwgZmluaXNoZXJzKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbmlzaGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgbmV3Q29uc3RydWN0b3IgPSAoMCwgZmluaXNoZXJzW2ldKShjb25zdHJ1Y3Rvcik7XG4gICAgICAgIGlmIChuZXdDb25zdHJ1Y3RvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBuZXdDb25zdHJ1Y3RvciAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRmluaXNoZXJzIG11c3QgcmV0dXJuIGEgY29uc3RydWN0b3IuXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdHJ1Y3RvciA9IG5ld0NvbnN0cnVjdG9yO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gY29uc3RydWN0b3I7XG4gICAgfSxcbiAgICBkaXNhbGxvd1Byb3BlcnR5OiBmdW5jdGlvbiAob2JqLCBuYW1lLCBvYmplY3RUeXBlKSB7XG4gICAgICBpZiAob2JqW25hbWVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihvYmplY3RUeXBlICsgXCIgY2FuJ3QgaGF2ZSBhIC5cIiArIG5hbWUgKyBcIiBwcm9wZXJ0eS5cIik7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICByZXR1cm4gYXBpO1xufVxuZnVuY3Rpb24gX2NyZWF0ZUVsZW1lbnREZXNjcmlwdG9yKGRlZikge1xuICB2YXIga2V5ID0gX3RvUHJvcGVydHlLZXkoZGVmLmtleSk7XG4gIHZhciBkZXNjcmlwdG9yO1xuICBpZiAoZGVmLmtpbmQgPT09IFwibWV0aG9kXCIpIHtcbiAgICBkZXNjcmlwdG9yID0ge1xuICAgICAgdmFsdWU6IGRlZi52YWx1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2VcbiAgICB9O1xuICB9IGVsc2UgaWYgKGRlZi5raW5kID09PSBcImdldFwiKSB7XG4gICAgZGVzY3JpcHRvciA9IHtcbiAgICAgIGdldDogZGVmLnZhbHVlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2VcbiAgICB9O1xuICB9IGVsc2UgaWYgKGRlZi5raW5kID09PSBcInNldFwiKSB7XG4gICAgZGVzY3JpcHRvciA9IHtcbiAgICAgIHNldDogZGVmLnZhbHVlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2VcbiAgICB9O1xuICB9IGVsc2UgaWYgKGRlZi5raW5kID09PSBcImZpZWxkXCIpIHtcbiAgICBkZXNjcmlwdG9yID0ge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICBlbnVtZXJhYmxlOiB0cnVlXG4gICAgfTtcbiAgfVxuICB2YXIgZWxlbWVudCA9IHtcbiAgICBraW5kOiBkZWYua2luZCA9PT0gXCJmaWVsZFwiID8gXCJmaWVsZFwiIDogXCJtZXRob2RcIixcbiAgICBrZXk6IGtleSxcbiAgICBwbGFjZW1lbnQ6IGRlZi5zdGF0aWMgPyBcInN0YXRpY1wiIDogZGVmLmtpbmQgPT09IFwiZmllbGRcIiA/IFwib3duXCIgOiBcInByb3RvdHlwZVwiLFxuICAgIGRlc2NyaXB0b3I6IGRlc2NyaXB0b3JcbiAgfTtcbiAgaWYgKGRlZi5kZWNvcmF0b3JzKSBlbGVtZW50LmRlY29yYXRvcnMgPSBkZWYuZGVjb3JhdG9ycztcbiAgaWYgKGRlZi5raW5kID09PSBcImZpZWxkXCIpIGVsZW1lbnQuaW5pdGlhbGl6ZXIgPSBkZWYudmFsdWU7XG4gIHJldHVybiBlbGVtZW50O1xufVxuZnVuY3Rpb24gX2NvYWxlc2NlR2V0dGVyU2V0dGVyKGVsZW1lbnQsIG90aGVyKSB7XG4gIGlmIChlbGVtZW50LmRlc2NyaXB0b3IuZ2V0ICE9PSB1bmRlZmluZWQpIHtcbiAgICBvdGhlci5kZXNjcmlwdG9yLmdldCA9IGVsZW1lbnQuZGVzY3JpcHRvci5nZXQ7XG4gIH0gZWxzZSB7XG4gICAgb3RoZXIuZGVzY3JpcHRvci5zZXQgPSBlbGVtZW50LmRlc2NyaXB0b3Iuc2V0O1xuICB9XG59XG5mdW5jdGlvbiBfY29hbGVzY2VDbGFzc0VsZW1lbnRzKGVsZW1lbnRzKSB7XG4gIHZhciBuZXdFbGVtZW50cyA9IFtdO1xuICB2YXIgaXNTYW1lRWxlbWVudCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHJldHVybiBvdGhlci5raW5kID09PSBcIm1ldGhvZFwiICYmIG90aGVyLmtleSA9PT0gZWxlbWVudC5rZXkgJiYgb3RoZXIucGxhY2VtZW50ID09PSBlbGVtZW50LnBsYWNlbWVudDtcbiAgfTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBlbGVtZW50ID0gZWxlbWVudHNbaV07XG4gICAgdmFyIG90aGVyO1xuICAgIGlmIChlbGVtZW50LmtpbmQgPT09IFwibWV0aG9kXCIgJiYgKG90aGVyID0gbmV3RWxlbWVudHMuZmluZChpc1NhbWVFbGVtZW50KSkpIHtcbiAgICAgIGlmIChfaXNEYXRhRGVzY3JpcHRvcihlbGVtZW50LmRlc2NyaXB0b3IpIHx8IF9pc0RhdGFEZXNjcmlwdG9yKG90aGVyLmRlc2NyaXB0b3IpKSB7XG4gICAgICAgIGlmIChfaGFzRGVjb3JhdG9ycyhlbGVtZW50KSB8fCBfaGFzRGVjb3JhdG9ycyhvdGhlcikpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJEdXBsaWNhdGVkIG1ldGhvZHMgKFwiICsgZWxlbWVudC5rZXkgKyBcIikgY2FuJ3QgYmUgZGVjb3JhdGVkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBvdGhlci5kZXNjcmlwdG9yID0gZWxlbWVudC5kZXNjcmlwdG9yO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKF9oYXNEZWNvcmF0b3JzKGVsZW1lbnQpKSB7XG4gICAgICAgICAgaWYgKF9oYXNEZWNvcmF0b3JzKG90aGVyKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwiRGVjb3JhdG9ycyBjYW4ndCBiZSBwbGFjZWQgb24gZGlmZmVyZW50IGFjY2Vzc29ycyB3aXRoIGZvciBcIiArIFwidGhlIHNhbWUgcHJvcGVydHkgKFwiICsgZWxlbWVudC5rZXkgKyBcIikuXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBvdGhlci5kZWNvcmF0b3JzID0gZWxlbWVudC5kZWNvcmF0b3JzO1xuICAgICAgICB9XG4gICAgICAgIF9jb2FsZXNjZUdldHRlclNldHRlcihlbGVtZW50LCBvdGhlcik7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIG5ld0VsZW1lbnRzLnB1c2goZWxlbWVudCk7XG4gICAgfVxuICB9XG4gIHJldHVybiBuZXdFbGVtZW50cztcbn1cbmZ1bmN0aW9uIF9oYXNEZWNvcmF0b3JzKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGVsZW1lbnQuZGVjb3JhdG9ycyAmJiBlbGVtZW50LmRlY29yYXRvcnMubGVuZ3RoO1xufVxuZnVuY3Rpb24gX2lzRGF0YURlc2NyaXB0b3IoZGVzYykge1xuICByZXR1cm4gZGVzYyAhPT0gdW5kZWZpbmVkICYmICEoZGVzYy52YWx1ZSA9PT0gdW5kZWZpbmVkICYmIGRlc2Mud3JpdGFibGUgPT09IHVuZGVmaW5lZCk7XG59XG5mdW5jdGlvbiBfb3B0aW9uYWxDYWxsYWJsZVByb3BlcnR5KG9iaiwgbmFtZSkge1xuICB2YXIgdmFsdWUgPSBvYmpbbmFtZV07XG4gIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiB2YWx1ZSAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkV4cGVjdGVkICdcIiArIG5hbWUgKyBcIicgdG8gYmUgYSBmdW5jdGlvblwiKTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiBfY2xhc3NQcml2YXRlTWV0aG9kR2V0KHJlY2VpdmVyLCBwcml2YXRlU2V0LCBmbikge1xuICBpZiAoIXByaXZhdGVTZXQuaGFzKHJlY2VpdmVyKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJhdHRlbXB0ZWQgdG8gZ2V0IHByaXZhdGUgZmllbGQgb24gbm9uLWluc3RhbmNlXCIpO1xuICB9XG4gIHJldHVybiBmbjtcbn1cbmZ1bmN0aW9uIF9jaGVja1ByaXZhdGVSZWRlY2xhcmF0aW9uKG9iaiwgcHJpdmF0ZUNvbGxlY3Rpb24pIHtcbiAgaWYgKHByaXZhdGVDb2xsZWN0aW9uLmhhcyhvYmopKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBpbml0aWFsaXplIHRoZSBzYW1lIHByaXZhdGUgZWxlbWVudHMgdHdpY2Ugb24gYW4gb2JqZWN0XCIpO1xuICB9XG59XG5mdW5jdGlvbiBfY2xhc3NQcml2YXRlRmllbGRJbml0U3BlYyhvYmosIHByaXZhdGVNYXAsIHZhbHVlKSB7XG4gIF9jaGVja1ByaXZhdGVSZWRlY2xhcmF0aW9uKG9iaiwgcHJpdmF0ZU1hcCk7XG4gIHByaXZhdGVNYXAuc2V0KG9iaiwgdmFsdWUpO1xufVxuZnVuY3Rpb24gX2NsYXNzUHJpdmF0ZU1ldGhvZEluaXRTcGVjKG9iaiwgcHJpdmF0ZVNldCkge1xuICBfY2hlY2tQcml2YXRlUmVkZWNsYXJhdGlvbihvYmosIHByaXZhdGVTZXQpO1xuICBwcml2YXRlU2V0LmFkZChvYmopO1xufVxuZnVuY3Rpb24gX2NsYXNzUHJpdmF0ZU1ldGhvZFNldCgpIHtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImF0dGVtcHRlZCB0byByZWFzc2lnbiBwcml2YXRlIG1ldGhvZFwiKTtcbn1cbmZ1bmN0aW9uIF9pZGVudGl0eSh4KSB7XG4gIHJldHVybiB4O1xufSJdfQ==